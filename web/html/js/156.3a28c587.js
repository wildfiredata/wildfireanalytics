"use strict";(self["webpackChunkwildfire"]=self["webpackChunkwildfire"]||[]).push([[156],{10156:function(e,t,s){s.r(t),s.d(t,{default:function(){return g}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"root"},[t("div",{staticClass:"title"},[e._v(e._s(e.$t("message.项目列表")))]),t("div",{staticClass:"buttons"},[t("el-button",{on:{click:function(t){e.dialogVisible=!0}}},[e._v(e._s(e.$t("message.创建项目")))])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"max-height":"650",border:""}},[t("el-table-column",{attrs:{prop:"app_id",label:e.$t("message.项目ID"),width:"180"}}),t("el-table-column",{attrs:{prop:"name",label:e.$t("message.项目名字"),width:"180"}}),t("el-table-column",{attrs:{prop:"timezone",label:e.$t("message.分析时区")}}),t("el-table-column",{attrs:{prop:"date",label:e.$t("message.创建日期"),width:"180"}}),t("el-table-column",{attrs:{label:e.$t("message.操作")},scopedSlots:e._u([{key:"default",fn:function({row:s}){return[t("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.deleteRecord(s)}}},[e._v(e._s(e.$t("message.删除")))])]}}])})],1),t("el-dialog",{attrs:{title:e.$t("message.新建项目"),"append-to-body":!0,"close-on-click-modal":!1,visible:e.dialogVisible,width:"50%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:e.$t("message.项目名字"),prop:"name"}},[t("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),t("el-form-item",{attrs:{label:e.$t("message.项目ID"),prop:"app_id"}},[t("el-input",{model:{value:e.ruleForm.app_id,callback:function(t){e.$set(e.ruleForm,"app_id",t)},expression:"ruleForm.app_id"}})],1),t("el-form-item",{attrs:{label:e.$t("message.默认分析时区"),prop:"zone"}},[t("el-select",{attrs:{placeholder:e.$t("message.请选择默认分析时区")},model:{value:e.ruleForm.zone,callback:function(t){e.$set(e.ruleForm,"zone",t)},expression:"ruleForm.zone"}},e._l(e.zones,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("b-message",{staticClass:"mt10",attrs:{type:"is-warning","has-icon":""}},[e._v(" "+e._s(e.$t("message.在新上传的追踪数据时，未带时区的时间字符串，将以此时区进行入库"))+" ")])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitCreateProject("ruleForm")}}},[e._v(e._s(e.$t("message.创建")))]),t("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v(e._s(e.$t("message.重置")))])],1)],1)],1)],1)},l=[],i=(s(57658),s(794)),o=s(94029),r=s(97499),n=s.n(r),m=s(36797),u=s.n(m),d={components:{},data(){const e=(e,t,s)=>i.Z.utils.IsEmptyStr(t)||n().isAlphanumeric(t)&&t.length<=16?s():void s(new Error(this.$t("message.项目ID只能为数字或字母，限制长度为16")));return{tableData:[],dialogVisible:!1,zones:[],ruleForm:{name:"",zone:8},rules:{name:[{required:!0,message:this.$t("message.请输入项目名称"),trigger:"blur"},{min:3,max:12,message:this.$t("message.长度在 2 到 10 个字符"),trigger:"blur"}],zone:[{required:!0,message:this.$t("message.请选择分析时区"),trigger:"change"}],app_id:[{required:!1,message:this.$t("message.项目ID只能为数字或字母，限制长度为16"),trigger:"blur"},{validator:e,trigger:"blur"}]}}},mounted(){this.loadZones(),this.loadApps()},methods:{loadApps(){this.tableData=[],o.Z["new"]().list().then(function(e){console.log(e);for(var t=0;t<e.data.length;t++)this.tableData.push({name:e.data[t].name,app_id:e.data[t].app_id,timezone:i.Z.def.TimeZone.getZhLabel(e.data[t].timezone),date:u()(1e3*e.data[t].create_time).format("YYYY-MM-DD")})}.bind(this)).catch((function(e){console.log(e)}))},deleteRecord(e){this.$confirm(this.$t("message.此操作将永久删除该项目x是否继续?",{name:e.name}),this.$t("message.信息"),{confirmButtonText:this.$t("message.确定"),cancelButtonText:this.$t("message.取消"),type:"warning"}).then((()=>{o.Z["new"]().delete({id:e.app_id}).then(function(e){i.Z.utils.Ignore(e),i.Z.utils.Success(this,this.$t("message.删除成功")),this.loadApps()}.bind(this)).catch((function(e){i.Z.utils.Err(this,e)}))})).catch((()=>{}))},loadZones(){this.zones.push({label:i.Z.def.TimeZone.getZhLabel(i.Z.def.TimeZone.Utcp8),value:i.Z.def.TimeZone.Utcp8});var e=-12;while(e<13)8!==e&&this.zones.push({label:i.Z.def.TimeZone.getZhLabel(e),value:e}),e+=1},handleClose(){this.dialogVisible=!1},submitCreateProject(e){this.dialogVisible=!1,this.$refs[e].validate((e=>{if(!e)return console.log("error submit!!"),!1;o.Z["new"]().add({name:this.ruleForm.name,timezone:this.ruleForm.zone,app_id:this.ruleForm.app_id}).then(function(e){i.Z.utils.Ignore(e),this.loadApps()}.bind(this)).catch((function(e){console.log(e)})),this.$event.emit(i.Z.def.EventNames.ProjectListUpdate,1)}))},resetForm(e){this.dialogVisible=!1,this.$refs[e].resetFields()}}},c=d,p=s(1001),h=(0,p.Z)(c,a,l,!1,null,"59850218",null),g=h.exports}}]);