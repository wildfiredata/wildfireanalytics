"use strict";(self["webpackChunkwildfire"]=self["webpackChunkwildfire"]||[]).push([[2957],{82957:function(e,t,l){l.r(t),l.d(t,{default:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"root"},[t("div",{staticClass:"top_toolbar h40"},[t("div",[t("span",{staticClass:"title h40 ml10"},[e._v(e._s(e.$t("message.一般事件")))])]),t("div",{staticClass:"top_toolbar_erea"})]),t("el-table",{staticClass:"root",staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-key":"id","min-height":"250",border:""}},[t("el-table-column",{attrs:{sortable:"",prop:"name",label:e.eventColsVisible["name"].title},scopedSlots:e._u([{key:"default",fn:function({row:l}){return[t("span",[e._v(e._s(l.name))])]}}])}),t("el-table-column",{attrs:{sortable:"",prop:"label",label:e.eventColsVisible["label"].title}}),t("el-table-column",{attrs:{sortable:"",prop:"event_group",label:e.eventColsVisible["event_group"].title}}),t("el-table-column",{attrs:{sortable:"",prop:"event_hide",label:e.eventColsVisible["event_hide"].title}}),t("el-table-column",{attrs:{sortable:"",prop:"desc",label:e.eventColsVisible["desc"].title}}),t("el-table-column",{attrs:{label:e.$t("message.操作"),width:"180"},scopedSlots:e._u([{key:"default",fn:function({row:l}){return[t("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.displayDetail(l)}}},[e._v(" "+e._s(e.$t("message.显示详情"))+" ")])]}}])})],1),t("el-drawer",{attrs:{title:e.$t("message.事件详情"),"close-on-press-escape":"",visible:e.drawer,direction:e.direction,size:800},on:{"update:visible":function(t){e.drawer=t}}},[t("el-descriptions",{staticClass:"padding20",attrs:{column:1}},[t("el-descriptions-item",{attrs:{label:e.eventColsVisible["name"].title}},[e._v(e._s(e.rowDetail.name))]),t("el-descriptions-item",{attrs:{label:e.eventColsVisible["label"].title}},[e.editingRow?e._e():t("span",[e._v(e._s(e.rowDetail.label))]),e.editingRow?e._e():t("i",{staticClass:"el-icon-edit marginleft20",on:{click:function(t){return e.editEventLabel(e.rowDetail)}}}),e.editingRow?t("el-input",{attrs:{size:"mini"},model:{value:e.editingLabel,callback:function(t){e.editingLabel=t},expression:"editingLabel"}}):e._e(),e.editingRow?t("el-button",{staticClass:"marginleft20",attrs:{type:"text",size:"mini"},nativeOn:{click:function(t){return t.preventDefault(),e.updateEventLabel(e.row)}}},[e._v(e._s(e.$t("message.确定")))]):e._e()],1),t("el-descriptions-item",{attrs:{label:e.eventColsVisible["event_group"].title}},[e._v(e._s(e.rowDetail.data_type))]),t("el-descriptions-item",{attrs:{label:e.eventColsVisible["event_hide"].title}},[e._v(e._s(e.rowDetail.prop_type))])],1),t("el-table",{staticClass:"padding20",staticStyle:{width:"100%"},attrs:{data:e.rowDetail.fields,"row-key":"name",border:""}},[t("el-table-column",{attrs:{sortable:"",prop:"name",label:e.propColsVisible["name"].title}}),t("el-table-column",{attrs:{sortable:"",prop:"prop_label",label:e.propColsVisible["prop_label"].title}}),t("el-table-column",{attrs:{sortable:"",prop:"data_type",label:e.propColsVisible["data_type"].title}}),t("el-table-column",{attrs:{sortable:"",prop:"prop_type",label:e.propColsVisible["prop_type"].title}}),t("el-table-column",{attrs:{sortable:"",prop:"desc",label:e.propColsVisible["desc"].title}})],1)],1)],1)},a=[],s=(l(57658),l(794)),n=l(47056),o=l(63822),r={components:{},data(){return{drawer:!1,direction:"rtl",tableData:[],eventColsVisible:{event_group:{title:this.$t("message.事件分组"),display:!0},name:{title:this.$t("message.事件埋点名字"),display:!0},label:{title:this.$t("message.事件别名"),display:!0},event_hide:{title:this.$t("message.事件隐藏"),display:!0},desc:{title:this.$t("message.备注"),display:!0}},propColsVisible:{name:{title:this.$t("message.属性埋点名字"),display:!0},prop_label:{title:this.$t("message.属性别名"),display:!0},data_type:{title:this.$t("message.数据类型"),display:!0},prop_type:{title:this.$t("message.属性类型"),display:!0},id:{title:this.$t("message.ID"),display:!0},hide:{title:this.$t("message.隐藏"),display:!0},desc:{title:this.$t("message.备注"),display:!0}},rowDetail:{},editingRow:!1,editingLabel:""}},mounted(){this.loadEvents()},methods:{editEventLabel(e){this.editingRow=!0,this.editingLabel=e.label},updateEventLabel(){this.editingRow=!1;var e=this.getCurrAppId();n.Z["new"]().updateEventLabel({app_id:e,label:this.editingLabel,event_name:this.rowDetail.name}).then(function(){this.rowDetail.label=this.editingLabel,this.loadEvents()}.bind(this)).catch(function(e){s.Z.utils.Err(this,e)}.bind(this))},loadEvents(){this.tableData=[];var e=this.getCurrAppId();n.Z["new"]().list({include_any_event:!1,include_normal_fields:!0,include_obj_schema:!1,include_dim_schema:!1,include_obj_dim_schema:!1,app_id:e}).then(function(e){console.log("DataEVentreponse",e);var t=e.data.events;if(t){for(var l=0;l<t.length;l++){var i={event_group:t[l].event_group,name:t[l].name,label:t[l].label,event_hide:t[l].event_hide,fields:t[l].fields,desc:t[l].desc};if(!0===i.event_hide?i.event_hide=this.$t("message.是"):i.event_hide=this.$t("message.否"),i.fields){for(var a=0;a<i.fields.length;a++)i.fields[a].data_type=s.Z.def.DataType.getZhLabel(i.fields[a].data_type),i.fields[a].prop_type=s.Z.def.PropertyType.getZhLabel(i.fields[a].prop_type);i.fields.sort((function(e,t){return e.name>t.name?1:e.name<t.name?-1:0}))}this.tableData.push(i)}this.tableData.sort((function(e,t){return e.name>t.name?1:e.name<t.name?-1:0}))}}.bind(this)).catch((function(e){console.log(e)}))},displayDetail(e){this.drawer=!0,this.rowDetail=e}},computed:{...(0,o.Se)({getCurrAppId:"system/getCurrAppId"})}},d=r,p=l(1001),b=(0,p.Z)(d,i,a,!1,null,"75770a26",null),c=b.exports}}]);