"use strict";(self["webpackChunkwildfire"]=self["webpackChunkwildfire"]||[]).push([[7074],{43782:function(e,t,i){i.d(t,{Z:function(){return h}});var a=function(){var e=this,t=e._self._c;return t("div",{ref:"me",attrs:{id:"crf_groupbycondition"}},[t("div",{staticClass:"flexrowAcenter"},[t("SelectPicker",{attrs:{defaulted:e.defaulted,tabGroups:e.tabGroups},on:{pickviewshow:e.on_picker_show,change:e.on_select_change},model:{value:e.editing_field,callback:function(t){e.editing_field=t},expression:"editing_field"}}),e.showSettingIcon(e.editing_field)?t("div",{on:{click:function(t){e.viewshow=!0}}},[t("b-icon",{staticClass:"setIcon ml5",attrs:{icon:"cog-outline",size:"is-small"}})],1):e._e()],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.viewshow,expression:"viewshow"}],staticClass:"groupbypickview"},[t("div",{staticClass:"groupbypicktitle"},[e._v(e._s(e.$t("message.分组方式-列表")))]),e.isBasicListType(e.editing_field)?t("div",[t("el-radio-group",{on:{input:e.on_breakOption_change},model:{value:e.breakOption,callback:function(t){e.breakOption=t},expression:"breakOption"}},[t("el-radio",{attrs:{size:e.fontSize,label:e.pub.def.BreakOption.BreakOptionListWhole}},[e._v(e._s(e.$t("message.按值")))]),t("el-radio",{attrs:{size:e.fontSize,label:e.pub.def.BreakOption.BreakOptionListElement}},[e._v(e._s(e.$t("message.按元素")))]),t("el-radio",{attrs:{size:e.fontSize,label:e.pub.def.BreakOption.BreakOptionListSet}},[e._v(e._s(e.$t("message.按元素集合")))])],1)],1):e._e(),e.isDateTimeType(e.editing_field)?t("div",{staticClass:"h40 flexrowAcenter"},[t("el-radio-group",{on:{input:e.on_radio_change_time},model:{value:e.timeSummary,callback:function(t){e.timeSummary=t},expression:"timeSummary"}},[t("el-radio",{attrs:{size:e.fontSize,label:e.PERIOD_SUMMARY_NO}},[e._v(e._s(e.$t("message.不汇总")))]),t("el-radio",{attrs:{size:e.fontSize,label:e.PERIOD_SUMMARY_YES}},[e._v(e._s(e.$t("message.按时段汇总")))])],1),e.timeSummary==e.PERIOD_SUMMARY_YES?t("div",{staticClass:"flexrowAcenter ml5"},[t("b-select",{staticClass:"w100",attrs:{size:"is-small"},on:{input:e.on_breakOption_change},model:{value:e.breakOption,callback:function(t){e.breakOption=t},expression:"breakOption"}},e._l(e.timePeriodOp,(function(i){return t("option",{key:i.value,domProps:{value:i.value}},[e._v(" "+e._s(i.label)+" ")])})),0)],1):e._e()],1):e._e(),e.isNumberType(e.editing_field)?t("div",[t("el-radio-group",{on:{input:e.on_breakOption_change},model:{value:e.breakOption,callback:function(t){e.breakOption=t},expression:"breakOption"}},[t("el-radio",{attrs:{size:e.fontSize,label:e.pub.def.BreakOption.BreakOptionNumberDefault}},[e._v(e._s(e.$t("message.默认区间")))]),t("el-radio",{attrs:{size:e.fontSize,label:e.pub.def.BreakOption.BreakOptionNumberValue}},[e._v(e._s(e.$t("message.离散值(无区间)")))]),t("el-radio",{attrs:{size:e.fontSize,label:e.pub.def.BreakOption.BreakOptionNumberCustom}},[e._v(e._s(e.$t("message.自定义区间")))])],1),e.breakOption==e.pub.def.BreakOption.BreakOptionNumberCustom?t("div",{staticClass:"pickViewContent onSliderScroll"},e._l(e.numberList,(function(i,a){return t("div",{key:i.id,staticClass:"flexcolumnAleft"},[1===i.id?t("div",{staticClass:"flexrowJleftAcenter"},[t("div",{staticClass:"w50"},[e._v(e._s(e.$t("message.区间"))+e._s(a+1))]),t("div",{staticClass:"w15 flexcolumnAcenter"},[e._v("(")]),t("span",{staticClass:"w100"},[e._v(e._s(e.pub.def.Infinite.InfiniteMin))]),t("div",{staticClass:"w15 flexcolumnAcenter"},[e._v("-")]),t("el-input-number",{attrs:{size:"mini","controls-position":"right"},on:{change:function(t){return e.on_change_num(i)}},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}}),t("div",{staticClass:"w15 flexcolumnAcenter"},[e._v(")")])],1):e._e(),1!=i.id?t("div",{staticClass:"flexrowJleftAcenter"},[t("div",{staticClass:"w50"},[e._v(e._s(e.$t("message.区间"))+e._s(a+1))]),t("div",{staticClass:"w15 flexcolumnAcenter"},[e._v("(")]),t("el-input",{staticClass:"w100",attrs:{value:e.get_previous_max(i),size:"mini",disabled:!0}}),t("div",{staticClass:"w15 flexcolumnAcenter"},[e._v("-")]),t("el-input-number",{attrs:{size:"mini","controls-position":"right"},on:{change:function(t){return e.on_change_num(i)}},model:{value:i.value,callback:function(t){e.$set(i,"value",t)},expression:"item.value"}}),t("div",{staticClass:"w15 flexcolumnAcenter"},[e._v(")")])],1):e._e(),i.id===e.numberList.length?t("div",{staticClass:"flexrowJleftAcenter"},[t("div",{staticClass:"w50"},[e._v(e._s(e.$t("message.区间"))+e._s(a+2))]),t("div",{staticClass:"w15 flexcolumnAcenter"},[e._v("(")]),t("el-input",{staticClass:"w100",attrs:{value:i.value,size:"mini",disabled:!0}}),t("div",{staticClass:"w15 flexcolumnAcenter"},[e._v("-")]),e._v(" "+e._s(e.pub.def.Infinite.InfiniteMax)+" "),t("div",{staticClass:"w15 flexcolumnAcenter"},[e._v(")")])],1):e._e()])})),0):e._e(),e.breakOption==e.pub.def.BreakOption.BreakOptionNumberCustom?t("div",{staticClass:"span_button",on:{click:e.addToList}},[t("b-icon",{attrs:{"custom-size":"mdi-18px",size:"default",icon:"plus"}}),e._v(e._s(e.$t("message.添加区间")))],1):e._e()],1):e._e()])])},s=[],r=(i(57658),i(794)),n=i(43436);const o="no",l="yes";var u={name:"DateTimePicker",components:{SelectPicker:n.Z},model:{prop:"modelvalue",event:"modelvaluechange"},props:{inputPlaceHolder:{type:String,default:"请选择日期"},modelvalue:{type:Object,default:function(){return{editing_field:{},breakOption:r.Z.def.BreakOption.BreakOptionListWhole,numberList:[{id:1,value:1}]}}},defaulted:{type:Boolean,default:!0},fontSize:{type:String,default:"mini"},setting:{type:Boolean,default:!0},tabGroups:{type:Array,default:()=>[]}},data(){return{PERIOD_SUMMARY_NO:"no",PERIOD_SUMMARY_YES:"yes",timeSummary:"no",eventListLoadOk:!1,timePeriodOp:[],editing_field:{},viewshow:!1,breakOption:r.Z.def.BreakOption.BreakOptionListWhole,numberList:[{id:1,value:1}]}},created(){this.initialize()},mounted(){(this.modelvalue&&this.modelvalue.length>12||this.modelvalue&&10===this.modelvalue.length)&&this.confirm(),document.addEventListener("click",this.dc,!0)},beforeDestroy(){document.removeEventListener("click",this.dc,!0)},methods:{initialize(){this.timePeriodOp=this.getTimePeriodList(),this.modelvalue&&(this.breakOption=this.modelvalue.breakOption,this.numberList=this.modelvalue.numberList,this.editing_field=this.modelvalue.editing_field)},confirm(){var e={};e.breakOption=this.breakOption,e.numberList=this.numberList,e.editing_field=this.editing_field,this.$emit("modelvaluechange",e)},dc(e){var t=this.$el.contains(e.target);t||(this.viewshow=!1)},on_breakOption_change(){console.log("====on_breakOption_change=========",this.breakOption),this.confirm()},getTimePeriodList(){var e=[];return e.push({value:r.Z.def.BreakOption.BreakOptionTimeMinute,label:this.$t("message.分钟")}),e.push({value:r.Z.def.BreakOption.BreakOptionTimeHour,label:this.$t("message.小时")}),e.push({value:r.Z.def.BreakOption.BreakOptionTimeDay,label:this.$t("message.天")}),e.push({value:r.Z.def.BreakOption.BreakOptionTimeWeek,label:this.$t("message.周")}),e.push({value:r.Z.def.BreakOption.BreakOptionTimeMonth,label:this.$t("message.月")}),e.push({value:r.Z.def.BreakOption.BreakOptionTimeYear,label:this.$t("message.年")}),e},addToList(){var e=this.numberList[this.numberList.length-1].value+1;this.numberList[this.numberList.length-1].max=e,this.numberList.push({id:this.numberList.length+1,value:e,min:e-1})},on_picker_show(e){e&&(this.viewshow=!1)},get_previous_max(e){if(e.id>1)return this.numberList[e.id-2].value},on_radio_change_time(e){console.log("====on_radio_change_time 1==========",e,this.breakOption),e==o?this.breakOption=r.Z.def.BreakOption.BreakOptionTimeSecond:e==l&&(this.breakOption=r.Z.def.BreakOption.BreakOptionTimeMinute),console.log("====on_radio_change_time 2==========",e,this.breakOption),this.confirm()},on_change_num(e){1==this.numberList.length||(e.id==this.numberList.length?e.value<=this.numberList[e.id-2].value&&setTimeout((()=>{e.value=this.numberList[e.id-2].value+1}),10):1==e.id?e.value>=this.numberList[e.id].value&&setTimeout((()=>{e.value=this.numberList[e.id].value-1}),10):(e.value>=this.numberList[e.id].value&&setTimeout((()=>{e.value=this.numberList[e.id].value-1}),10),e.value<=this.numberList[e.id-2].value&&setTimeout((()=>{e.value=this.numberList[e.id-2].value+1}),10))),this.confirm()},isDateTimeType(e){return!(!e||e.data_source_type!=r.Z.def.DataSourceType.DataSourceTypeEventProp&&e.data_source_type!=r.Z.def.DataSourceType.DataSourceTypeUserProp&&e.data_source_type!=r.Z.def.DataSourceType.DataSourceTypeUserTag||e.type!=r.Z.def.DataType.DataTypeDatetime)},isNumberType(e){return!(!e||e.data_source_type!=r.Z.def.DataSourceType.DataSourceTypeEventProp&&e.data_source_type!=r.Z.def.DataSourceType.DataSourceTypeUserProp&&e.data_source_type!=r.Z.def.DataSourceType.DataSourceTypeUserTag||e.type!=r.Z.def.DataType.DataTypeNumber)},isBasicListType(e){return!(!e||e.data_source_type!=r.Z.def.DataSourceType.DataSourceTypeEventProp&&e.data_source_type!=r.Z.def.DataSourceType.DataSourceTypeUserProp&&e.data_source_type!=r.Z.def.DataSourceType.DataSourceTypeUserTag||!r.Z.def.DataType.isBasicListType(e.type))},showSettingIcon(e){if(e)if(e.data_source_type==r.Z.def.DataSourceType.DataSourceTypeEventProp||e.data_source_type==r.Z.def.DataSourceType.DataSourceTypeUserProp||e.data_source_type==r.Z.def.DataSourceType.DataSourceTypeUserTag){if(e.type==r.Z.def.DataType.DataTypeNumber||e.type==r.Z.def.DataType.DataTypeDatetime)return!0;if(r.Z.def.DataType.isBasicListType(e.type))return!0}else e.data_source_type,r.Z.def.DataSourceType.DataSourceTypeUserCluster},on_select_change(e){this.breakOption=r.Z.def.BreakOption.BreakOptionNormal,this.isNumberType(e)?this.breakOption=r.Z.def.BreakOption.BreakOptionNumberDefault:this.isDateTimeType(e)?(this.timeSummary=this.PERIOD_SUMMARY_NO,this.breakOption=r.Z.def.BreakOption.BreakOptionTimeSecond):this.isBasicListType(e)&&(this.breakOption=r.Z.def.BreakOption.BreakOptionListWhole),this.editing_field=e,this.confirm()}},watch:{},computed:{}},p=u,d=i(1001),c=(0,d.Z)(p,a,s,!1,null,"202cb59e",null),h=c.exports},34874:function(e,t,i){i.r(t),i.d(t,{default:function(){return h}});var a=function(){var e=this,t=e._self._c;return t("div",[t("GroupbyCondition",{attrs:{fontSize:"medium",tabGroups:e.tabGroups},model:{value:e.timehms,callback:function(t){e.timehms=t},expression:"timehms"}})],1)},s=[],r=(i(57658),i(794)),n=i(62147),o=i(63822),l=i(43782),u={components:{GroupbyCondition:l.Z},data(){return{UserPropList:[],EventPropList:[],EventList:[],UserGroupList:[],UserTagList:[],tabGroups:[],timehms:null}},created(){this.initialize()},methods:{initialize(){var e=this.getCurrAppId(),t=n.Z.api.LoadPlainEventList(e),i=n.Z.api.LoadUserProp(e),a=n.Z.api.LoadUserClusterList(e),s=n.Z.api.LoadUserTagList(e,!0),o=n.Z.api.LoadEventPropParamPromise({app_id:e,include_obj_schema:!0,include_dim_schema:!0,include_obj_dim_schema:!0,limit_event_name:[]}),l=Promise.all([i,t,a,s,o]);l.then((e=>{console.log("res--------:",e),this.UserPropList=e[0],this.EventList=e[1],this.UserGroupList=e[2],this.UserTagList=e[3],this.EventPropList=e[4],this.eventListLoadOk=!0;var t=this.$route.params;this.editing=!r.Z.utils.IsEmptyObj(t.client_data),this.tabGroups=n.Z.filtersub.MakeTabGroup(this.EventPropList,this.UserPropList,this.UserGroupList,this.UserTagList)})).catch((e=>{r.Z.utils.Err(this,e)}))}},computed:{...(0,o.Se)({getCurrAppId:"system/getCurrAppId"}),pickableProps(){for(var e=[],t={group_name:this.$t("message.事件属性"),value:this.$t("message.事件属性"),type:"list",icon:"",children:this.EventPropList},i=0;i<t.children.length;i++)t.children[i].label2=r.Z.def.PropertyType.getZhLabel(t.children[i].label2),t.children[i].label3=r.Z.def.DataType.getZhLabel(t.children[i].type);t.children&&t.children.length>0&&e.push(t);var a={group_name:this.$t("message.用户属性"),value:this.$t("message.用户属性"),type:"list",icon:"",children:this.UserPropList};for(i=0;i<a.children.length;i++)a.children[i].label2=r.Z.def.PropertyType.getZhLabel(a.children[i].label2),a.children[i].label3=r.Z.def.DataType.getZhLabel(a.children[i].type);a.children&&a.children.length>0&&e.push(a);var s={group_name:this.$t("message.用户分群"),value:this.$t("message.用户分群"),type:"list",icon:"",children:this.UserGroupList};for(i=0;i<s.children.length;i++)s.children[i].label2=r.Z.def.PropertyType.getZhLabel(s.children[i].label2),s.children[i].label3=r.Z.def.DataType.getZhLabel(s.children[i].type);s.children&&s.children.length>0&&e.push(s);var n={group_name:this.$t("message.用户标签"),value:this.$t("message.用户标签"),type:"list",icon:"",children:this.UserTagList};for(i=0;i<n.children.length;i++)n.children[i].label2=r.Z.def.PropertyType.getZhLabel(n.children[i].label2),n.children[i].label3=r.Z.def.DataType.getZhLabel(n.children[i].type);return n.children&&n.children.length>0&&e.push(n),e}}},p=u,d=i(1001),c=(0,d.Z)(p,a,s,!1,null,null,null),h=c.exports}}]);