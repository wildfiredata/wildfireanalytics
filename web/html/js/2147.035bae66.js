(self["webpackChunkwildfire"]=self["webpackChunkwildfire"]||[]).push([[2147],{59172:function(e,t,a){a(57658),a(23767),a(8585),a(68696),a(30541),function(t,a){e.exports=a()}(0,(function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof a.g?a.g:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}
/*!
  	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
  	 *
  	 * Permission is hereby granted, free of charge, to any person obtaining a copy
  	 * of this software and associated documentation files (the "Software"), to deal
  	 * in the Software without restriction, including without limitation the rights
  	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  	 * copies of the Software, and to permit persons to whom the Software is
  	 * furnished to do so, subject to the following conditions:
  	 *
  	 * The above copyright notice and this permission notice shall be included in
  	 * all copies or substantial portions of the Software.
  	 *
  	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  	 * SOFTWARE.
  	 */var r,i,s,l,n={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(e){let t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}};
/*!
  	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
  	 *
  	 * Permission is hereby granted, free of charge, to any person obtaining a copy
  	 * of this software and associated documentation files (the "Software"), to deal
  	 * in the Software without restriction, including without limitation the rights
  	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  	 * copies of the Software, and to permit persons to whom the Software is
  	 * furnished to do so, subject to the following conditions:
  	 *
  	 * The above copyright notice and this permission notice shall be included in
  	 * all copies or substantial portions of the Software.
  	 *
  	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  	 * SOFTWARE.
  	 */function o(){if(i)return r;i=1;const e=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function t(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(r,i,s,l,n,o,d){if(!isNaN(+r))return+r;let u="",c=r.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(c!==r)return-1*a(c,i,s,l,n,o);for(let t=0;t<e.length;t++){let d=e[t];if(u=r.replace(RegExp(`([0-9 ])(${d.key})$`),"$1"),u!==r)return a(u,i,s,l,n,o)*d.factor}if(u=r.replace("%",""),u!==r)return a(u,i,s,l,n,o)/100;let p=parseFloat(r);if(isNaN(p))return;let f=l(p);if(f&&"."!==f&&(u=r.replace(new RegExp(`${t(f)}$`),""),u!==r))return a(u,i,s,l,n,o);let m={};Object.keys(o).forEach((e=>{m[o[e]]=e}));let h=Object.keys(m).sort().reverse(),y=h.length;for(let e=0;e<y;e++){let t=h[e],d=m[t];if(u=r.replace(t,""),u!==r){let e;switch(d){case"thousand":e=Math.pow(10,3);break;case"million":e=Math.pow(10,6);break;case"billion":e=Math.pow(10,9);break;case"trillion":e=Math.pow(10,12)}return a(u,i,s,l,n,o)*e}}}function s(e,r,i="",s,l,n,o){if(""===e)return;if(e===l)return 0;let d=function(e,a,r){let i=e.replace(r,"");return i=i.replace(new RegExp(`([0-9])${t(a.thousands)}([0-9])`,"g"),"$1$2"),i=i.replace(a.decimal,"."),i}(e,r,i);return a(d,r,i,s,l,n)}return r={unformat:function(e,t){const a=f();let r,i=a.currentDelimiters(),l=a.currentCurrency().symbol,n=a.currentOrdinal(),o=a.getZeroFormat(),d=a.currentAbbreviations();if("string"==typeof e)r=function(e,t){if(!e.indexOf(":")||":"===t.thousands)return!1;let a=e.split(":");if(3!==a.length)return!1;let r=+a[0],i=+a[1],s=+a[2];return!isNaN(r)&&!isNaN(i)&&!isNaN(s)}(e,i)?function(e){let t=e.split(":"),a=+t[0],r=+t[1];return+t[2]+60*r+3600*a}(e):s(e,i,l,n,o,d);else{if("number"!=typeof e)return;r=e}if(void 0!==r)return r}},r
/*!
  	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
  	 *
  	 * Permission is hereby granted, free of charge, to any person obtaining a copy
  	 * of this software and associated documentation files (the "Software"), to deal
  	 * in the Software without restriction, including without limitation the rights
  	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  	 * copies of the Software, and to permit persons to whom the Software is
  	 * furnished to do so, subject to the following conditions:
  	 *
  	 * The above copyright notice and this permission notice shall be included in
  	 * all copies or substantial portions of the Software.
  	 *
  	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  	 * SOFTWARE.
  	 */}function d(){if(l)return s;l=1;let e=o();const t=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,a={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:(e,t)=>"byte"===t.output,message:"`base` must be provided only when the output is `byte`",mandatory:e=>"byte"===e.output},characteristic:{type:"number",restriction:e=>e>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",lowPrecision:{type:"boolean",restriction:(e,t)=>!0===t.average,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:e=>e>=0,message:"value must be positive"},{restriction:(e,t)=>!t.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:e=>e>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(e,t)=>"percent"===t.output,message:"`prefixSymbol` can be provided only when the output is `percent`"}},r={languageTag:{type:"string",mandatory:!0,restriction:e=>e.match(t),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function i(t){return void 0!==e.unformat(t)}function n(e,t,r,i=!1){let s=Object.keys(e).map((i=>{if(!t[i])return console.error(`${r} Invalid key: ${i}`),!1;let s=e[i],l=t[i];if("string"==typeof l&&(l={type:l}),"format"===l.type){if(!n(s,a,`[Validate ${i}]`,!0))return!1}else if(typeof s!==l.type)return console.error(`${r} ${i} type mismatched: "${l.type}" expected, "${typeof s}" provided`),!1;if(l.restrictions&&l.restrictions.length){let t=l.restrictions.length;for(let a=0;a<t;a++){let{restriction:t,message:n}=l.restrictions[a];if(!t(s,e))return console.error(`${r} ${i} invalid value: ${n}`),!1}}return l.restriction&&!l.restriction(s,e)?(console.error(`${r} ${i} invalid value: ${l.message}`),!1):l.validValues&&-1===l.validValues.indexOf(s)?(console.error(`${r} ${i} invalid value: must be among ${JSON.stringify(l.validValues)}, "${s}" provided`),!1):!(l.children&&!n(s,l.children,`[Validate ${i}]`))}));return i||s.push(...Object.keys(t).map((a=>{let i=t[a];if("string"==typeof i&&(i={type:i}),i.mandatory){let t=i.mandatory;if("function"==typeof t&&(t=t(e)),t&&void 0===e[a])return console.error(`${r} Missing mandatory key "${a}"`),!1}return!0}))),s.reduce(((e,t)=>e&&t),!0)}function d(e){return n(e,a,"[Validate format]")}return s={validate:function(e,t){let a=i(e),r=d(t);return a&&r},validateFormat:d,validateInput:i,validateLanguage:function(e){return n(e,r,"[Validate language]")}},s
/*!
  	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
  	 *
  	 * Permission is hereby granted, free of charge, to any person obtaining a copy
  	 * of this software and associated documentation files (the "Software"), to deal
  	 * in the Software without restriction, including without limitation the rights
  	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  	 * copies of the Software, and to permit persons to whom the Software is
  	 * furnished to do so, subject to the following conditions:
  	 *
  	 * The above copyright notice and this permission notice shall be included in
  	 * all copies or substantial portions of the Software.
  	 *
  	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  	 * SOFTWARE.
  	 */}var u,c,p={parseFormat:function(e,t={}){return"string"!=typeof e?e:(function(e,t){if(-1===e.indexOf("$")){if(-1===e.indexOf("%"))return-1!==e.indexOf("bd")?(t.output="byte",void(t.base="general")):-1!==e.indexOf("b")?(t.output="byte",void(t.base="binary")):-1!==e.indexOf("d")?(t.output="byte",void(t.base="decimal")):void(-1===e.indexOf(":")?-1!==e.indexOf("o")&&(t.output="ordinal"):t.output="time");t.output="percent"}else t.output="currency"}(e=function(e,t){let a=e.match(/{([^}]*)}$/);return a?(t.postfix=a[1],e.slice(0,-a[0].length)):e}(e=function(e,t){let a=e.match(/^{([^}]*)}/);return a?(t.prefix=a[1],e.slice(a[0].length)):e}(e,t),t),t),function(e,t){let a=e.match(/[1-9]+[0-9]*/);a&&(t.totalLength=+a[0])}(e,t),function(e,t){let a=e.split(".")[0].match(/0+/);a&&(t.characteristic=a[0].length)}(e,t),function(e,t){if(-1!==e.indexOf(".")){let a=e.split(".")[0];t.optionalCharacteristic=-1===a.indexOf("0")}}(e,t),function(e,t){-1!==e.indexOf("a")&&(t.average=!0)}(e,t),function(e,t){-1!==e.indexOf("K")?t.forceAverage="thousand":-1!==e.indexOf("M")?t.forceAverage="million":-1!==e.indexOf("B")?t.forceAverage="billion":-1!==e.indexOf("T")&&(t.forceAverage="trillion")}(e,t),function(e,t){let a=e.split(".")[1];if(a){let e=a.match(/0+/);e&&(t.mantissa=e[0].length)}}(e,t),function(e,t){e.match(/\[\.]/)?t.optionalMantissa=!0:e.match(/\./)&&(t.optionalMantissa=!1)}(e,t),function(e,t){const a=e.split(".")[1];a&&(t.trimMantissa=-1!==a.indexOf("["))}(e,t),function(e,t){-1!==e.indexOf(",")&&(t.thousandSeparated=!0)}(e,t),function(e,t){-1!==e.indexOf(" ")&&(t.spaceSeparated=!0,t.spaceSeparatedCurrency=!0,(t.average||t.forceAverage)&&(t.spaceSeparatedAbbreviation=!0))}(e,t),function(e,t){e.match(/^\+?\([^)]*\)$/)&&(t.negative="parenthesis"),e.match(/^\+?-/)&&(t.negative="sign")}(e,t),function(e,t){e.match(/^\+/)&&(t.forceSign=!0)}(e,t),t)}};
/*!
  	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
  	 *
  	 * Permission is hereby granted, free of charge, to any person obtaining a copy
  	 * of this software and associated documentation files (the "Software"), to deal
  	 * in the Software without restriction, including without limitation the rights
  	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  	 * copies of the Software, and to permit persons to whom the Software is
  	 * furnished to do so, subject to the following conditions:
  	 *
  	 * The above copyright notice and this permission notice shall be included in
  	 * all copies or substantial portions of the Software.
  	 *
  	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  	 * SOFTWARE.
  	 */function f(){if(c)return u;c=1;const e=n,t=d(),a=p;let r,i={},s={},l=null,o={};function f(e){r=e}function m(){return s[r]}return i.languages=()=>Object.assign({},s),i.currentLanguage=()=>r,i.currentBytes=()=>m().bytes||{},i.currentCurrency=()=>m().currency,i.currentAbbreviations=()=>m().abbreviations,i.currentDelimiters=()=>m().delimiters,i.currentOrdinal=()=>m().ordinal,i.currentDefaults=()=>Object.assign({},m().defaults,o),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),m().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),m().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),m().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),m().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),m().timeFormat),i.setDefaults=e=>{e=a.parseFormat(e),t.validateFormat(e)&&(o=e)},i.getZeroFormat=()=>l,i.setZeroFormat=e=>l="string"==typeof e?e:null,i.hasZeroFormat=()=>null!==l,i.languageData=e=>{if(e){if(s[e])return s[e];throw new Error(`Unknown tag "${e}"`)}return m()},i.registerLanguage=(e,a=!1)=>{if(!t.validateLanguage(e))throw new Error("Invalid language data");s[e.languageTag]=e,a&&f(e.languageTag)},i.setLanguage=(t,a=e.languageTag)=>{if(!s[t]){let e=t.split("-")[0],r=Object.keys(s).find((t=>t.split("-")[0]===e));return s[r]?void f(r):void f(a)}f(t)},i.registerLanguage(e),r=e.languageTag,u=i
/*!
  	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
  	 *
  	 * Permission is hereby granted, free of charge, to any person obtaining a copy
  	 * of this software and associated documentation files (the "Software"), to deal
  	 * in the Software without restriction, including without limitation the rights
  	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  	 * copies of the Software, and to permit persons to whom the Software is
  	 * furnished to do so, subject to the following conditions:
  	 *
  	 * The above copyright notice and this permission notice shall be included in
  	 * all copies or substantial portions of the Software.
  	 *
  	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  	 * SOFTWARE.
  	 */}function m(e,t){e.forEach((e=>{let a;try{a=function(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}(`../languages/${e}`)}catch(t){console.error(`Unable to load "${e}". No matching language file found.`)}a&&t.registerLanguage(a)}))}var h={exports:{}};!function(t){!function(e){var a,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,l="[BigNumber Error] ",n=l+"Number primitive has more than 15 significant digits: ",o=1e14,d=14,u=9007199254740991,c=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],p=1e7,f=1e9;function m(e){var t=0|e;return e>0||e===t?t:t-1}function h(e){for(var t,a,r=1,i=e.length,s=e[0]+"";r<i;){for(t=e[r++]+"",a=d-t.length;a--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function y(e,t){var a,r,i=e.c,s=t.c,l=e.s,n=t.s,o=e.e,d=t.e;if(!l||!n)return null;if(a=i&&!i[0],r=s&&!s[0],a||r)return a?r?0:-n:l;if(l!=n)return l;if(a=l<0,r=o==d,!i||!s)return r?0:!i^a?1:-1;if(!r)return o>d^a?1:-1;for(n=(o=i.length)<(d=s.length)?o:d,l=0;l<n;l++)if(i[l]!=s[l])return i[l]>s[l]^a?1:-1;return o==d?0:o>d^a?1:-1}function _(e,t,a,r){if(e<t||e>a||e!==s(e))throw Error(l+(r||"Argument")+("number"==typeof e?e<t||e>a?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function g(e){var t=e.c.length-1;return m(e.e/d)==t&&e.c[t]%2!=0}function b(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function T(e,t,a){var r,i;if(t<0){for(i=a+".";++t;i+=a);e=i+e}else if(++t>(r=e.length)){for(i=a,t-=r;--t;i+=a);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}a=function e(t){var a,v,Z,D,S,k,C,B,q,x,w=j.prototype={constructor:j,toString:null,valueOf:null},I=new j(1),M=20,E=4,N=-7,O=21,P=-1e7,L=1e7,A=!1,F=1,$=0,G={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},R="0123456789abcdefghijklmnopqrstuvwxyz",H=!0;function j(e,t){var a,i,l,o,c,p,f,m,h=this;if(!(h instanceof j))return new j(e,t);if(null==t){if(e&&!0===e._isBigNumber)return h.s=e.s,void(!e.c||e.e>L?h.c=h.e=null:e.e<P?h.c=[h.e=0]:(h.e=e.e,h.c=e.c.slice()));if((p="number"==typeof e)&&0*e==0){if(h.s=1/e<0?(e=-e,-1):1,e===~~e){for(o=0,c=e;c>=10;c/=10,o++);return void(o>L?h.c=h.e=null:(h.e=o,h.c=[e]))}m=String(e)}else{if(!r.test(m=String(e)))return Z(h,m,p);h.s=45==m.charCodeAt(0)?(m=m.slice(1),-1):1}(o=m.indexOf("."))>-1&&(m=m.replace(".","")),(c=m.search(/e/i))>0?(o<0&&(o=c),o+=+m.slice(c+1),m=m.substring(0,c)):o<0&&(o=m.length)}else{if(_(t,2,R.length,"Base"),10==t&&H)return z(h=new j(e),M+h.e+1,E);if(m=String(e),p="number"==typeof e){if(0*e!=0)return Z(h,m,p,t);if(h.s=1/e<0?(m=m.slice(1),-1):1,j.DEBUG&&m.replace(/^0\.0*|\./,"").length>15)throw Error(n+e)}else h.s=45===m.charCodeAt(0)?(m=m.slice(1),-1):1;for(a=R.slice(0,t),o=c=0,f=m.length;c<f;c++)if(a.indexOf(i=m.charAt(c))<0){if("."==i){if(c>o){o=f;continue}}else if(!l&&(m==m.toUpperCase()&&(m=m.toLowerCase())||m==m.toLowerCase()&&(m=m.toUpperCase()))){l=!0,c=-1,o=0;continue}return Z(h,String(e),p,t)}p=!1,(o=(m=v(m,t,10,h.s)).indexOf("."))>-1?m=m.replace(".",""):o=m.length}for(c=0;48===m.charCodeAt(c);c++);for(f=m.length;48===m.charCodeAt(--f););if(m=m.slice(c,++f)){if(f-=c,p&&j.DEBUG&&f>15&&(e>u||e!==s(e)))throw Error(n+h.s*e);if((o=o-c-1)>L)h.c=h.e=null;else if(o<P)h.c=[h.e=0];else{if(h.e=o,h.c=[],c=(o+1)%d,o<0&&(c+=d),c<f){for(c&&h.c.push(+m.slice(0,c)),f-=d;c<f;)h.c.push(+m.slice(c,c+=d));c=d-(m=m.slice(c)).length}else c-=f;for(;c--;m+="0");h.c.push(+m)}}else h.c=[h.e=0]}function Y(e,t,a,r){var i,s,l,n,o;if(null==a?a=E:_(a,0,8),!e.c)return e.toString();if(i=e.c[0],l=e.e,null==t)o=h(e.c),o=1==r||2==r&&(l<=N||l>=O)?b(o,l):T(o,l,"0");else if(s=(e=z(new j(e),t,a)).e,n=(o=h(e.c)).length,1==r||2==r&&(t<=s||s<=N)){for(;n<t;o+="0",n++);o=b(o,s)}else if(t-=l,o=T(o,s,"0"),s+1>n){if(--t>0)for(o+=".";t--;o+="0");}else if((t+=s-n)>0)for(s+1==n&&(o+=".");t--;o+="0");return e.s<0&&i?"-"+o:o}function V(e,t){for(var a,r,i=1,s=new j(e[0]);i<e.length;i++)(!(r=new j(e[i])).s||(a=y(s,r))===t||0===a&&s.s===t)&&(s=r);return s}function U(e,t,a){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,r++);return(a=r+a*d-1)>L?e.c=e.e=null:a<P?e.c=[e.e=0]:(e.e=a,e.c=t),e}function z(e,t,a,r){var l,n,u,p,f,m,h,y=e.c,_=c;if(y){e:{for(l=1,p=y[0];p>=10;p/=10,l++);if((n=t-l)<0)n+=d,u=t,f=y[m=0],h=s(f/_[l-u-1]%10);else if((m=i((n+1)/d))>=y.length){if(!r)break e;for(;y.length<=m;y.push(0));f=h=0,l=1,u=(n%=d)-d+1}else{for(f=p=y[m],l=1;p>=10;p/=10,l++);h=(u=(n%=d)-d+l)<0?0:s(f/_[l-u-1]%10)}if(r=r||t<0||null!=y[m+1]||(u<0?f:f%_[l-u-1]),r=a<4?(h||r)&&(0==a||a==(e.s<0?3:2)):h>5||5==h&&(4==a||r||6==a&&(n>0?u>0?f/_[l-u]:0:y[m-1])%10&1||a==(e.s<0?8:7)),t<1||!y[0])return y.length=0,r?(t-=e.e+1,y[0]=_[(d-t%d)%d],e.e=-t||0):y[0]=e.e=0,e;if(0==n?(y.length=m,p=1,m--):(y.length=m+1,p=_[d-n],y[m]=u>0?s(f/_[l-u]%_[u])*p:0),r)for(;;){if(0==m){for(n=1,u=y[0];u>=10;u/=10,n++);for(u=y[0]+=p,p=1;u>=10;u/=10,p++);n!=p&&(e.e++,y[0]==o&&(y[0]=1));break}if(y[m]+=p,y[m]!=o)break;y[m--]=0,p=1}for(n=y.length;0===y[--n];y.pop());}e.e>L?e.c=e.e=null:e.e<P&&(e.c=[e.e=0])}return e}function Q(e){var t,a=e.e;return null===a?e.toString():(t=h(e.c),t=a<=N||a>=O?b(t,a):T(t,a,"0"),e.s<0?"-"+t:t)}return j.clone=e,j.ROUND_UP=0,j.ROUND_DOWN=1,j.ROUND_CEIL=2,j.ROUND_FLOOR=3,j.ROUND_HALF_UP=4,j.ROUND_HALF_DOWN=5,j.ROUND_HALF_EVEN=6,j.ROUND_HALF_CEIL=7,j.ROUND_HALF_FLOOR=8,j.EUCLID=9,j.config=j.set=function(e){var t,a;if(null!=e){if("object"!=typeof e)throw Error(l+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(_(a=e[t],0,f,t),M=a),e.hasOwnProperty(t="ROUNDING_MODE")&&(_(a=e[t],0,8,t),E=a),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((a=e[t])&&a.pop?(_(a[0],-f,0,t),_(a[1],0,f,t),N=a[0],O=a[1]):(_(a,-f,f,t),N=-(O=a<0?-a:a))),e.hasOwnProperty(t="RANGE"))if((a=e[t])&&a.pop)_(a[0],-f,-1,t),_(a[1],1,f,t),P=a[0],L=a[1];else{if(_(a,-f,f,t),!a)throw Error(l+t+" cannot be zero: "+a);P=-(L=a<0?-a:a)}if(e.hasOwnProperty(t="CRYPTO")){if((a=e[t])!==!!a)throw Error(l+t+" not true or false: "+a);if(a){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw A=!a,Error(l+"crypto unavailable");A=a}else A=a}if(e.hasOwnProperty(t="MODULO_MODE")&&(_(a=e[t],0,9,t),F=a),e.hasOwnProperty(t="POW_PRECISION")&&(_(a=e[t],0,f,t),$=a),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(a=e[t]))throw Error(l+t+" not an object: "+a);G=a}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(a=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(a))throw Error(l+t+" invalid: "+a);H="0123456789"==a.slice(0,10),R=a}}return{DECIMAL_PLACES:M,ROUNDING_MODE:E,EXPONENTIAL_AT:[N,O],RANGE:[P,L],CRYPTO:A,MODULO_MODE:F,POW_PRECISION:$,FORMAT:G,ALPHABET:R}},j.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!j.DEBUG)return!0;var t,a,r=e.c,i=e.e,n=e.s;e:if("[object Array]"=={}.toString.call(r)){if((1===n||-1===n)&&i>=-f&&i<=f&&i===s(i)){if(0===r[0]){if(0===i&&1===r.length)return!0;break e}if((t=(i+1)%d)<1&&(t+=d),String(r[0]).length==t){for(t=0;t<r.length;t++)if((a=r[t])<0||a>=o||a!==s(a))break e;if(0!==a)return!0}}}else if(null===r&&null===i&&(null===n||1===n||-1===n))return!0;throw Error(l+"Invalid BigNumber: "+e)},j.maximum=j.max=function(){return V(arguments,-1)},j.minimum=j.min=function(){return V(arguments,1)},j.random=(D=9007199254740992,S=Math.random()*D&2097151?function(){return s(Math.random()*D)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,a,r,n,o,u=0,p=[],m=new j(I);if(null==e?e=M:_(e,0,f),n=i(e/d),A)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(n*=2));u<n;)(o=131072*t[u]+(t[u+1]>>>11))>=9e15?(a=crypto.getRandomValues(new Uint32Array(2)),t[u]=a[0],t[u+1]=a[1]):(p.push(o%1e14),u+=2);u=n/2}else{if(!crypto.randomBytes)throw A=!1,Error(l+"crypto unavailable");for(t=crypto.randomBytes(n*=7);u<n;)(o=281474976710656*(31&t[u])+1099511627776*t[u+1]+4294967296*t[u+2]+16777216*t[u+3]+(t[u+4]<<16)+(t[u+5]<<8)+t[u+6])>=9e15?crypto.randomBytes(7).copy(t,u):(p.push(o%1e14),u+=7);u=n/7}if(!A)for(;u<n;)(o=S())<9e15&&(p[u++]=o%1e14);for(n=p[--u],e%=d,n&&e&&(o=c[d-e],p[u]=s(n/o)*o);0===p[u];p.pop(),u--);if(u<0)p=[r=0];else{for(r=-1;0===p[0];p.splice(0,1),r-=d);for(u=1,o=p[0];o>=10;o/=10,u++);u<d&&(r-=d-u)}return m.e=r,m.c=p,m}),j.sum=function(){for(var e=1,t=arguments,a=new j(t[0]);e<t.length;)a=a.plus(t[e++]);return a},v=function(){var e="0123456789";function t(e,t,a,r){for(var i,s,l=[0],n=0,o=e.length;n<o;){for(s=l.length;s--;l[s]*=t);for(l[0]+=r.indexOf(e.charAt(n++)),i=0;i<l.length;i++)l[i]>a-1&&(null==l[i+1]&&(l[i+1]=0),l[i+1]+=l[i]/a|0,l[i]%=a)}return l.reverse()}return function(r,i,s,l,n){var o,d,u,c,p,f,m,y,_=r.indexOf("."),g=M,b=E;for(_>=0&&(c=$,$=0,r=r.replace(".",""),f=(y=new j(i)).pow(r.length-_),$=c,y.c=t(T(h(f.c),f.e,"0"),10,s,e),y.e=y.c.length),u=c=(m=t(r,i,s,n?(o=R,e):(o=e,R))).length;0==m[--c];m.pop());if(!m[0])return o.charAt(0);if(_<0?--u:(f.c=m,f.e=u,f.s=l,m=(f=a(f,y,g,b,s)).c,p=f.r,u=f.e),_=m[d=u+g+1],c=s/2,p=p||d<0||null!=m[d+1],p=b<4?(null!=_||p)&&(0==b||b==(f.s<0?3:2)):_>c||_==c&&(4==b||p||6==b&&1&m[d-1]||b==(f.s<0?8:7)),d<1||!m[0])r=p?T(o.charAt(1),-g,o.charAt(0)):o.charAt(0);else{if(m.length=d,p)for(--s;++m[--d]>s;)m[d]=0,d||(++u,m=[1].concat(m));for(c=m.length;!m[--c];);for(_=0,r="";_<=c;r+=o.charAt(m[_++]));r=T(r,u,o.charAt(0))}return r}}(),a=function(){function e(e,t,a){var r,i,s,l,n=0,o=e.length,d=t%p,u=t/p|0;for(e=e.slice();o--;)n=((i=d*(s=e[o]%p)+(r=u*s+(l=e[o]/p|0)*d)%p*p+n)/a|0)+(r/p|0)+u*l,e[o]=i%a;return n&&(e=[n].concat(e)),e}function t(e,t,a,r){var i,s;if(a!=r)s=a>r?1:-1;else for(i=s=0;i<a;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function a(e,t,a,r){for(var i=0;a--;)e[a]-=i,i=e[a]<t[a]?1:0,e[a]=i*r+e[a]-t[a];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,i,l,n,u){var c,p,f,h,y,_,g,b,T,v,Z,D,S,k,C,B,q,x=r.s==i.s?1:-1,w=r.c,I=i.c;if(!(w&&w[0]&&I&&I[0]))return new j(r.s&&i.s&&(w?!I||w[0]!=I[0]:I)?w&&0==w[0]||!I?0*x:x/0:NaN);for(T=(b=new j(x)).c=[],x=l+(p=r.e-i.e)+1,u||(u=o,p=m(r.e/d)-m(i.e/d),x=x/d|0),f=0;I[f]==(w[f]||0);f++);if(I[f]>(w[f]||0)&&p--,x<0)T.push(1),h=!0;else{for(k=w.length,B=I.length,f=0,x+=2,(y=s(u/(I[0]+1)))>1&&(I=e(I,y,u),w=e(w,y,u),B=I.length,k=w.length),S=B,Z=(v=w.slice(0,B)).length;Z<B;v[Z++]=0);q=I.slice(),q=[0].concat(q),C=I[0],I[1]>=u/2&&C++;do{if(y=0,(c=t(I,v,B,Z))<0){if(D=v[0],B!=Z&&(D=D*u+(v[1]||0)),(y=s(D/C))>1)for(y>=u&&(y=u-1),g=(_=e(I,y,u)).length,Z=v.length;1==t(_,v,g,Z);)y--,a(_,B<g?q:I,g,u),g=_.length,c=1;else 0==y&&(c=y=1),g=(_=I.slice()).length;if(g<Z&&(_=[0].concat(_)),a(v,_,Z,u),Z=v.length,-1==c)for(;t(I,v,B,Z)<1;)y++,a(v,B<Z?q:I,Z,u),Z=v.length}else 0===c&&(y++,v=[0]);T[f++]=y,v[0]?v[Z++]=w[S]||0:(v=[w[S]],Z=1)}while((S++<k||null!=v[0])&&x--);h=null!=v[0],T[0]||T.splice(0,1)}if(u==o){for(f=1,x=T[0];x>=10;x/=10,f++);z(b,l+(b.e=f+p*d-1)+1,n,h)}else b.e=p,b.r=+h;return b}}(),k=/^(-?)0([xbo])(?=\w[\w.]*$)/i,C=/^([^.]+)\.$/,B=/^\.([^.]+)$/,q=/^-?(Infinity|NaN)$/,x=/^\s*\+(?=[\w.])|^\s+|\s+$/g,Z=function(e,t,a,r){var i,s=a?t:t.replace(x,"");if(q.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!a&&(s=s.replace(k,(function(e,t,a){return i="x"==(a=a.toLowerCase())?16:"b"==a?2:8,r&&r!=i?e:t})),r&&(i=r,s=s.replace(C,"$1").replace(B,"0.$1")),t!=s))return new j(s,i);if(j.DEBUG)throw Error(l+"Not a"+(r?" base "+r:"")+" number: "+t);e.s=null}e.c=e.e=null},w.absoluteValue=w.abs=function(){var e=new j(this);return e.s<0&&(e.s=1),e},w.comparedTo=function(e,t){return y(this,new j(e,t))},w.decimalPlaces=w.dp=function(e,t){var a,r,i,s=this;if(null!=e)return _(e,0,f),null==t?t=E:_(t,0,8),z(new j(s),e+s.e+1,t);if(!(a=s.c))return null;if(r=((i=a.length-1)-m(this.e/d))*d,i=a[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},w.dividedBy=w.div=function(e,t){return a(this,new j(e,t),M,E)},w.dividedToIntegerBy=w.idiv=function(e,t){return a(this,new j(e,t),0,1)},w.exponentiatedBy=w.pow=function(e,t){var a,r,n,o,u,c,p,f,m=this;if((e=new j(e)).c&&!e.isInteger())throw Error(l+"Exponent not an integer: "+Q(e));if(null!=t&&(t=new j(t)),u=e.e>14,!m.c||!m.c[0]||1==m.c[0]&&!m.e&&1==m.c.length||!e.c||!e.c[0])return f=new j(Math.pow(+Q(m),u?e.s*(2-g(e)):+Q(e))),t?f.mod(t):f;if(c=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new j(NaN);(r=!c&&m.isInteger()&&t.isInteger())&&(m=m.mod(t))}else{if(e.e>9&&(m.e>0||m.e<-1||(0==m.e?m.c[0]>1||u&&m.c[1]>=24e7:m.c[0]<8e13||u&&m.c[0]<=9999975e7)))return o=m.s<0&&g(e)?-0:0,m.e>-1&&(o=1/o),new j(c?1/o:o);$&&(o=i($/d+2))}for(u?(a=new j(.5),c&&(e.s=1),p=g(e)):p=(n=Math.abs(+Q(e)))%2,f=new j(I);;){if(p){if(!(f=f.times(m)).c)break;o?f.c.length>o&&(f.c.length=o):r&&(f=f.mod(t))}if(n){if(0===(n=s(n/2)))break;p=n%2}else if(z(e=e.times(a),e.e+1,1),e.e>14)p=g(e);else{if(0===(n=+Q(e)))break;p=n%2}m=m.times(m),o?m.c&&m.c.length>o&&(m.c.length=o):r&&(m=m.mod(t))}return r?f:(c&&(f=I.div(f)),t?f.mod(t):o?z(f,$,E,void 0):f)},w.integerValue=function(e){var t=new j(this);return null==e?e=E:_(e,0,8),z(t,t.e+1,e)},w.isEqualTo=w.eq=function(e,t){return 0===y(this,new j(e,t))},w.isFinite=function(){return!!this.c},w.isGreaterThan=w.gt=function(e,t){return y(this,new j(e,t))>0},w.isGreaterThanOrEqualTo=w.gte=function(e,t){return 1===(t=y(this,new j(e,t)))||0===t},w.isInteger=function(){return!!this.c&&m(this.e/d)>this.c.length-2},w.isLessThan=w.lt=function(e,t){return y(this,new j(e,t))<0},w.isLessThanOrEqualTo=w.lte=function(e,t){return-1===(t=y(this,new j(e,t)))||0===t},w.isNaN=function(){return!this.s},w.isNegative=function(){return this.s<0},w.isPositive=function(){return this.s>0},w.isZero=function(){return!!this.c&&0==this.c[0]},w.minus=function(e,t){var a,r,i,s,l=this,n=l.s;if(t=(e=new j(e,t)).s,!n||!t)return new j(NaN);if(n!=t)return e.s=-t,l.plus(e);var u=l.e/d,c=e.e/d,p=l.c,f=e.c;if(!u||!c){if(!p||!f)return p?(e.s=-t,e):new j(f?l:NaN);if(!p[0]||!f[0])return f[0]?(e.s=-t,e):new j(p[0]?l:3==E?-0:0)}if(u=m(u),c=m(c),p=p.slice(),n=u-c){for((s=n<0)?(n=-n,i=p):(c=u,i=f),i.reverse(),t=n;t--;i.push(0));i.reverse()}else for(r=(s=(n=p.length)<(t=f.length))?n:t,n=t=0;t<r;t++)if(p[t]!=f[t]){s=p[t]<f[t];break}if(s&&(i=p,p=f,f=i,e.s=-e.s),(t=(r=f.length)-(a=p.length))>0)for(;t--;p[a++]=0);for(t=o-1;r>n;){if(p[--r]<f[r]){for(a=r;a&&!p[--a];p[a]=t);--p[a],p[r]+=o}p[r]-=f[r]}for(;0==p[0];p.splice(0,1),--c);return p[0]?U(e,p,c):(e.s=3==E?-1:1,e.c=[e.e=0],e)},w.modulo=w.mod=function(e,t){var r,i,s=this;return e=new j(e,t),!s.c||!e.s||e.c&&!e.c[0]?new j(NaN):!e.c||s.c&&!s.c[0]?new j(s):(9==F?(i=e.s,e.s=1,r=a(s,e,0,3),e.s=i,r.s*=i):r=a(s,e,0,F),(e=s.minus(r.times(e))).c[0]||1!=F||(e.s=s.s),e)},w.multipliedBy=w.times=function(e,t){var a,r,i,s,l,n,u,c,f,h,y,_,g,b,T,v=this,Z=v.c,D=(e=new j(e,t)).c;if(!(Z&&D&&Z[0]&&D[0]))return!v.s||!e.s||Z&&!Z[0]&&!D||D&&!D[0]&&!Z?e.c=e.e=e.s=null:(e.s*=v.s,Z&&D?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=m(v.e/d)+m(e.e/d),e.s*=v.s,(u=Z.length)<(h=D.length)&&(g=Z,Z=D,D=g,i=u,u=h,h=i),i=u+h,g=[];i--;g.push(0));for(b=o,T=p,i=h;--i>=0;){for(a=0,y=D[i]%T,_=D[i]/T|0,s=i+(l=u);s>i;)a=((c=y*(c=Z[--l]%T)+(n=_*c+(f=Z[l]/T|0)*y)%T*T+g[s]+a)/b|0)+(n/T|0)+_*f,g[s--]=c%b;g[s]=a}return a?++r:g.splice(0,1),U(e,g,r)},w.negated=function(){var e=new j(this);return e.s=-e.s||null,e},w.plus=function(e,t){var a,r=this,i=r.s;if(t=(e=new j(e,t)).s,!i||!t)return new j(NaN);if(i!=t)return e.s=-t,r.minus(e);var s=r.e/d,l=e.e/d,n=r.c,u=e.c;if(!s||!l){if(!n||!u)return new j(i/0);if(!n[0]||!u[0])return u[0]?e:new j(n[0]?r:0*i)}if(s=m(s),l=m(l),n=n.slice(),i=s-l){for(i>0?(l=s,a=u):(i=-i,a=n),a.reverse();i--;a.push(0));a.reverse()}for((i=n.length)-(t=u.length)<0&&(a=u,u=n,n=a,t=i),i=0;t;)i=(n[--t]=n[t]+u[t]+i)/o|0,n[t]=o===n[t]?0:n[t]%o;return i&&(n=[i].concat(n),++l),U(e,n,l)},w.precision=w.sd=function(e,t){var a,r,i,s=this;if(null!=e&&e!==!!e)return _(e,1,f),null==t?t=E:_(t,0,8),z(new j(s),e,t);if(!(a=s.c))return null;if(r=(i=a.length-1)*d+1,i=a[i]){for(;i%10==0;i/=10,r--);for(i=a[0];i>=10;i/=10,r++);}return e&&s.e+1>r&&(r=s.e+1),r},w.shiftedBy=function(e){return _(e,-9007199254740991,u),this.times("1e"+e)},w.squareRoot=w.sqrt=function(){var e,t,r,i,s,l=this,n=l.c,o=l.s,d=l.e,u=M+4,c=new j("0.5");if(1!==o||!n||!n[0])return new j(!o||o<0&&(!n||n[0])?NaN:n?l:1/0);if(0==(o=Math.sqrt(+Q(l)))||o==1/0?(((t=h(n)).length+d)%2==0&&(t+="0"),o=Math.sqrt(+t),d=m((d+1)/2)-(d<0||d%2),r=new j(t=o==1/0?"5e"+d:(t=o.toExponential()).slice(0,t.indexOf("e")+1)+d)):r=new j(o+""),r.c[0])for((o=(d=r.e)+u)<3&&(o=0);;)if(s=r,r=c.times(s.plus(a(l,s,u,1))),h(s.c).slice(0,o)===(t=h(r.c)).slice(0,o)){if(r.e<d&&--o,"9999"!=(t=t.slice(o-3,o+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(z(r,r.e+M+2,1),e=!r.times(r).eq(l));break}if(!i&&(z(s,s.e+M+2,0),s.times(s).eq(l))){r=s;break}u+=4,o+=4,i=1}return z(r,r.e+M+1,E,e)},w.toExponential=function(e,t){return null!=e&&(_(e,0,f),e++),Y(this,e,t,1)},w.toFixed=function(e,t){return null!=e&&(_(e,0,f),e=e+this.e+1),Y(this,e,t)},w.toFormat=function(e,t,a){var r,i=this;if(null==a)null!=e&&t&&"object"==typeof t?(a=t,t=null):e&&"object"==typeof e?(a=e,e=t=null):a=G;else if("object"!=typeof a)throw Error(l+"Argument not an object: "+a);if(r=i.toFixed(e,t),i.c){var s,n=r.split("."),o=+a.groupSize,d=+a.secondaryGroupSize,u=a.groupSeparator||"",c=n[0],p=n[1],f=i.s<0,m=f?c.slice(1):c,h=m.length;if(d&&(s=o,o=d,d=s,h-=s),o>0&&h>0){for(s=h%o||o,c=m.substr(0,s);s<h;s+=o)c+=u+m.substr(s,o);d>0&&(c+=u+m.slice(s)),f&&(c="-"+c)}r=p?c+(a.decimalSeparator||"")+((d=+a.fractionGroupSize)?p.replace(new RegExp("\\d{"+d+"}\\B","g"),"$&"+(a.fractionGroupSeparator||"")):p):c}return(a.prefix||"")+r+(a.suffix||"")},w.toFraction=function(e){var t,r,i,s,n,o,u,p,f,m,y,_,g=this,b=g.c;if(null!=e&&(!(u=new j(e)).isInteger()&&(u.c||1!==u.s)||u.lt(I)))throw Error(l+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+Q(u));if(!b)return new j(g);for(t=new j(I),f=r=new j(I),i=p=new j(I),_=h(b),n=t.e=_.length-g.e-1,t.c[0]=c[(o=n%d)<0?d+o:o],e=!e||u.comparedTo(t)>0?n>0?t:f:u,o=L,L=1/0,u=new j(_),p.c[0]=0;m=a(u,t,0,1),1!=(s=r.plus(m.times(i))).comparedTo(e);)r=i,i=s,f=p.plus(m.times(s=f)),p=s,t=u.minus(m.times(s=t)),u=s;return s=a(e.minus(r),i,0,1),p=p.plus(s.times(f)),r=r.plus(s.times(i)),p.s=f.s=g.s,y=a(f,i,n*=2,E).minus(g).abs().comparedTo(a(p,r,n,E).minus(g).abs())<1?[f,i]:[p,r],L=o,y},w.toNumber=function(){return+Q(this)},w.toPrecision=function(e,t){return null!=e&&_(e,1,f),Y(this,e,t,2)},w.toString=function(e){var t,a=this,r=a.s,i=a.e;return null===i?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(null==e?t=i<=N||i>=O?b(h(a.c),i):T(h(a.c),i,"0"):10===e&&H?t=T(h((a=z(new j(a),M+i+1,E)).c),a.e,"0"):(_(e,2,R.length,"Base"),t=v(T(h(a.c),i,"0"),10,e,r,!0)),r<0&&a.c[0]&&(t="-"+t)),t},w.valueOf=w.toJSON=function(){return Q(this)},w._isBigNumber=!0,null!=t&&j.set(t),j}(),a.default=a.BigNumber=a,t.exports?t.exports=a:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=a)}(e)}(h);var y=h.exports;
/*!
  	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
  	 *
  	 * Permission is hereby granted, free of charge, to any person obtaining a copy
  	 * of this software and associated documentation files (the "Software"), to deal
  	 * in the Software without restriction, including without limitation the rights
  	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  	 * copies of the Software, and to permit persons to whom the Software is
  	 * furnished to do so, subject to the following conditions:
  	 *
  	 * The above copyright notice and this permission notice shall be included in
  	 * all copies or substantial portions of the Software.
  	 *
  	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  	 * SOFTWARE.
  	 */const _=f(),g=d(),b=p,T=y,v={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Z={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:D,decimalSuffixes:S}=_.currentBytes(),k={general:{scale:1024,suffixes:S,marker:"bd"},binary:{scale:1024,suffixes:D,marker:"b"},decimal:{scale:1e3,suffixes:S,marker:"d"}};function C(e,t={},a){if("string"==typeof t&&(t=b.parseFormat(t)),!g.validateFormat(t))return"ERROR: invalid format";let r=t.prefix||"",i=t.postfix||"",s=function(e,t,a){switch(t.output){case"currency":return function(e,t,a){const r=a.currentCurrency();let i,s=Object.assign({},t),l=Object.assign({},Z,s),n="",o=!!l.totalLength||!!l.forceAverage||l.average,d=s.currencyPosition||r.position,u=s.currencySymbol||r.symbol;const c=void 0!==l.spaceSeparatedCurrency?l.spaceSeparatedCurrency:l.spaceSeparated;void 0===s.lowPrecision&&(s.lowPrecision=!1),c&&(n=" "),"infix"===d&&(i=n+u+n);let p=w({instance:e,providedFormat:s,state:a,decimalSeparator:i});return"prefix"===d&&(p=e._value<0&&"sign"===l.negative?`-${n}${u}${p.slice(1)}`:e._value>0&&l.forceSign?`+${n}${u}${p.slice(1)}`:u+n+p),d&&"postfix"!==d||(n=!l.spaceSeparatedAbbreviation&&o?"":n,p=p+n+u),p}(e,t=I(t,_.currentCurrencyDefaultFormat()),_);case"percent":return function(e,t,a,r){let i=t.prefixSymbol,s=w({instance:r(100*e._value),providedFormat:t,state:a}),l=Object.assign({},Z,t);return i?`%${l.spaceSeparated?" ":""}${s}`:`${s}${l.spaceSeparated?" ":""}%`}(e,t=I(t,_.currentPercentageDefaultFormat()),_,a);case"byte":return function(e,t,a,r){let i=t.base||"binary",s=Object.assign({},Z,t);const{binarySuffixes:l,decimalSuffixes:n}=a.currentBytes();let o={general:{scale:1024,suffixes:n||S,marker:"bd"},binary:{scale:1024,suffixes:l||D,marker:"b"},decimal:{scale:1e3,suffixes:n||S,marker:"d"}}[i],{value:d,suffix:u}=B(e._value,o.suffixes,o.scale),c=w({instance:r(d),providedFormat:t,state:a,defaults:a.currentByteDefaultFormat()});return`${c}${s.spaceSeparated?" ":""}${u}`}(e,t=I(t,_.currentByteDefaultFormat()),_,a);case"time":return t=I(t,_.currentTimeDefaultFormat()),function(e){let t=Math.floor(e._value/60/60),a=Math.floor((e._value-60*t*60)/60),r=Math.round(e._value-60*t*60-60*a);return`${t}:${a<10?"0":""}${a}:${r<10?"0":""}${r}`}(e);case"ordinal":return function(e,t,a){let r=a.currentOrdinal(),i=Object.assign({},Z,t),s=w({instance:e,providedFormat:t,state:a}),l=r(e._value);return`${s}${i.spaceSeparated?" ":""}${l}`}(e,t=I(t,_.currentOrdinalDefaultFormat()),_);default:return w({instance:e,providedFormat:t,numbro:a})}}(e,t,a);return s=function(e,t){return t+e}(s,r),s=function(e,t){return e+t}(s,i),s}function B(e,t,a){let r=t[0],i=Math.abs(e);if(i>=a){for(let s=1;s<t.length;++s){let l=Math.pow(a,s),n=Math.pow(a,s+1);if(i>=l&&i<n){r=t[s],e/=l;break}}r===t[0]&&(e/=Math.pow(a,t.length-1),r=t[t.length-1])}return{value:e,suffix:r}}function q(e){let t="";for(let a=0;a<e;a++)t+="0";return t}function x(e,t,a=Math.round){return-1!==e.toString().indexOf("e")?function(e,t){let a=e.toString(),[r,i]=a.split("e"),[s,l=""]=r.split(".");if(+i>0)a=s+l+q(i-l.length);else{let e=".";e=+s<0?`-0${e}`:`0${e}`;let r=(q(-i-1)+Math.abs(s)+l).substr(0,t);r.length<t&&(r+=q(t-r.length)),a=e+r}return+i>0&&t>0&&(a+=`.${q(t)}`),a}(e,t):new T(a(+`${e}e+${t}`)/Math.pow(10,t)).toFixed(t)}function w({instance:e,providedFormat:t,state:a=_,decimalSeparator:r,defaults:i=a.currentDefaults()}){let s=e._value;if(0===s&&a.hasZeroFormat())return a.getZeroFormat();if(!isFinite(s))return s.toString();let l=Object.assign({},Z,i,t),n=l.totalLength,o=n?0:l.characteristic,d=l.optionalCharacteristic,u=l.forceAverage,c=l.lowPrecision,p=!!n||!!u||l.average,f=n?-1:p&&void 0===t.mantissa?0:l.mantissa,m=!n&&(void 0===t.optionalMantissa?-1===f:l.optionalMantissa),h=l.trimMantissa,y=l.thousandSeparated,g=l.spaceSeparated,b=l.negative,T=l.forceSign,D=l.exponential,S=l.roundingFunction,k="";if(p){let e=function({value:e,forceAverage:t,lowPrecision:a=!0,abbreviations:r,spaceSeparated:i=!1,totalLength:s=0,roundingFunction:l=Math.round}){let n="",o=Math.abs(e),d=-1;if(t&&r[t]&&v[t]?(n=r[t],e/=v[t]):o>=v.trillion||a&&1===l(o/v.trillion)?(n=r.trillion,e/=v.trillion):o<v.trillion&&o>=v.billion||a&&1===l(o/v.billion)?(n=r.billion,e/=v.billion):o<v.billion&&o>=v.million||a&&1===l(o/v.million)?(n=r.million,e/=v.million):(o<v.million&&o>=v.thousand||a&&1===l(o/v.thousand))&&(n=r.thousand,e/=v.thousand),n&&(n=(i?" ":"")+n),s){let t=e<0,a=e.toString().split(".")[0],r=t?a.length-1:a.length;d=Math.max(s-r,0)}return{value:e,abbreviation:n,mantissaPrecision:d}}({value:s,forceAverage:u,lowPrecision:c,abbreviations:a.currentAbbreviations(),spaceSeparated:g,roundingFunction:S,totalLength:n});s=e.value,k+=e.abbreviation,n&&(f=e.mantissaPrecision)}if(D){let e=function({value:e,characteristicPrecision:t}){let[a,r]=e.toExponential().split("e"),i=+a;return t?(1<t&&(i*=Math.pow(10,t-1),r=+r-(t-1),r=r>=0?`+${r}`:r),{value:i,abbreviation:`e${r}`}):{value:i,abbreviation:`e${r}`}}({value:s,characteristicPrecision:o});s=e.value,k=e.abbreviation+k}let C=function(e,t,a,r,i,s){if(-1===r)return e;let l=x(t,r,s),[n,o=""]=l.toString().split(".");if(o.match(/^0+$/)&&(a||i))return n;let d=o.match(/0+$/);return i&&d?`${n}.${o.toString().slice(0,d.index)}`:l.toString()}(s.toString(),s,m,f,h,S);return C=function(e,t,a,r){let i=e,[s,l]=i.toString().split(".");if(s.match(/^-?0$/)&&a)return l?`${s.replace("0","")}.${l}`:s.replace("0","");const n=t<0&&0===s.indexOf("-");if(n&&(s=s.slice(1),i=i.slice(1)),s.length<r){let e=r-s.length;for(let t=0;t<e;t++)i=`0${i}`}return n&&(i=`-${i}`),i.toString()}(C,s,d,o),C=function(e,t,a,r,i){let s=r.currentDelimiters(),l=s.thousands;i=i||s.decimal;let n=s.thousandsSize||3,o=e.toString(),d=o.split(".")[0],u=o.split(".")[1];const c=t<0&&0===d.indexOf("-");if(a){c&&(d=d.slice(1));let e=function(e,t){let a=[],r=0;for(let i=e;i>0;i--)r===t&&(a.unshift(i),r=0),r++;return a}(d.length,n);e.forEach(((e,t)=>{d=d.slice(0,e+t)+l+d.slice(e+t)})),c&&(d=`-${d}`)}return o=u?d+i+u:d,o}(C,s,y,a,r),(p||D)&&(C=function(e,t){return e+t}(C,k)),(T||s<0)&&(C=function(e,t,a){return 0===t?e:0==+e?e.replace("-",""):t>0?`+${e}`:"sign"===a?e:`(${e.replace("-","")})`}(C,s,b)),C}function I(e,t){if(!e)return t;let a=Object.keys(e);return 1===a.length&&"output"===a[0]?t:e}
/*!
  	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
  	 *
  	 * Permission is hereby granted, free of charge, to any person obtaining a copy
  	 * of this software and associated documentation files (the "Software"), to deal
  	 * in the Software without restriction, including without limitation the rights
  	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  	 * copies of the Software, and to permit persons to whom the Software is
  	 * furnished to do so, subject to the following conditions:
  	 *
  	 * The above copyright notice and this permission notice shall be included in
  	 * all copies or substantial portions of the Software.
  	 *
  	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  	 * SOFTWARE.
  	 */const M=y;function E(e,t,a){let r=new M(e._value),i=t;return a.isNumbro(t)&&(i=t._value),i=new M(i),e._value=r.minus(i).toNumber(),e
/*!
  	 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
  	 *
  	 * Permission is hereby granted, free of charge, to any person obtaining a copy
  	 * of this software and associated documentation files (the "Software"), to deal
  	 * in the Software without restriction, including without limitation the rights
  	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
  	 * copies of the Software, and to permit persons to whom the Software is
  	 * furnished to do so, subject to the following conditions:
  	 *
  	 * The above copyright notice and this permission notice shall be included in
  	 * all copies or substantial portions of the Software.
  	 *
  	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
  	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
  	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  	 * SOFTWARE.
  	 */}const N=f(),O=d(),P=(e=>({loadLanguagesInNode:t=>m(t,e)}))(H),L=o();let A=(e=>({format:(...t)=>C(...t,e),getByteUnit:(...t)=>function(e){let t=k.general;return B(e._value,t.suffixes,t.scale).suffix}(...t,e),getBinaryByteUnit:(...t)=>function(e){let t=k.binary;return B(e._value,t.suffixes,t.scale).suffix}(...t,e),getDecimalByteUnit:(...t)=>function(e){let t=k.decimal;return B(e._value,t.suffixes,t.scale).suffix}(...t,e),formatOrDefault:I}))(H),F=(e=>({add:(t,a)=>function(e,t,a){let r=new M(e._value),i=t;return a.isNumbro(t)&&(i=t._value),i=new M(i),e._value=r.plus(i).toNumber(),e}(t,a,e),subtract:(t,a)=>E(t,a,e),multiply:(t,a)=>function(e,t,a){let r=new M(e._value),i=t;return a.isNumbro(t)&&(i=t._value),i=new M(i),e._value=r.times(i).toNumber(),e}(t,a,e),divide:(t,a)=>function(e,t,a){let r=new M(e._value),i=t;return a.isNumbro(t)&&(i=t._value),i=new M(i),e._value=r.dividedBy(i).toNumber(),e}(t,a,e),set:(t,a)=>function(e,t,a){let r=t;return a.isNumbro(t)&&(r=t._value),e._value=r,e}(t,a,e),difference:(t,a)=>function(e,t,a){let r=a(e._value);return E(r,t,a),Math.abs(r._value)}(t,a,e),BigNumber:M}))(H);const $=p;class G{constructor(e){this._value=e}clone(){return H(this._value)}format(e={}){return A.format(this,e)}formatCurrency(e){return"string"==typeof e&&(e=$.parseFormat(e)),(e=A.formatOrDefault(e,N.currentCurrencyDefaultFormat())).output="currency",A.format(this,e)}formatTime(e={}){return e.output="time",A.format(this,e)}binaryByteUnits(){return A.getBinaryByteUnit(this)}decimalByteUnits(){return A.getDecimalByteUnit(this)}byteUnits(){return A.getByteUnit(this)}difference(e){return F.difference(this,e)}add(e){return F.add(this,e)}subtract(e){return F.subtract(this,e)}multiply(e){return F.multiply(this,e)}divide(e){return F.divide(this,e)}set(e){return F.set(this,R(e))}value(){return this._value}valueOf(){return this._value}}function R(e){let t=e;return H.isNumbro(e)?t=e._value:"string"==typeof e?t=H.unformat(e):isNaN(e)&&(t=NaN),t}function H(e){return new G(R(e))}return H.version="2.4.0",H.isNumbro=function(e){return e instanceof G},H.language=N.currentLanguage,H.registerLanguage=N.registerLanguage,H.setLanguage=N.setLanguage,H.languages=N.languages,H.languageData=N.languageData,H.zeroFormat=N.setZeroFormat,H.defaultFormat=N.currentDefaults,H.setDefaults=N.setDefaults,H.defaultCurrencyFormat=N.currentCurrencyDefaultFormat,H.validate=O.validate,H.loadLanguagesInNode=P.loadLanguagesInNode,H.unformat=L.unformat,H.BigNumber=F.BigNumber,t(H)}))},6309:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(90948),i=a(91803);class s{static new(){return(0,r.y7)(),new s}add(e){return(0,i.Z)({url:"/api/reporter/entity_add",method:"post",data:e})}delete(e){return(0,i.Z)({url:"/api/reporter/entity_delete",method:"post",data:e})}list(e){return(0,i.Z)({url:"/api/reporter/entity_list",method:"post",data:e})}avaliable_prop(e){return(0,i.Z)({url:"/api/reporter/entity_avalivable_prop",method:"post",data:e})}}},16540:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var r=a(90948),i=a(91803);class s{addUsertag(e){return console.log("api usertagMock addUsertag",e),new Promise((function(e,t){var a=!0;a?e({code:0,msg:"登录成功",data:{token:"21232f297a57a5a743894a0e4a801fc3"}}):t({code:-1,msg:"登录失败"})}))}}class l{static new(){return(0,r.y7)()?new s:new l}add(e){return(0,i.Z)({url:"/api/reporter/usertag_add",method:"post",data:e})}delete(e){return(0,i.Z)({url:"/api/reporter/usertag_delete",method:"post",data:e})}listUsertag(e){return(0,i.Z)({url:"/api/reporter/list_user_tag",method:"post",data:e})}CreateUserGroup(e){return(0,i.Z)({url:"/api/reporter/create_user_group",method:"post",data:e})}DeleteUserGroup(e){return(0,i.Z)({url:"/api/reporter/delete_user_group",method:"post",data:e})}ListUserGroup(e){return(0,i.Z)({url:"/api/reporter/list_user_group",method:"post",data:e})}RefreshUserGroup(e){return(0,i.Z)({url:"/api/reporter/refresh_user_group",method:"post",data:e})}ListUserTagMember(e){return(0,i.Z)({url:"/api/reporter/list_user_group_member",method:"post",data:e})}}},62147:function(e,t,a){"use strict";a.d(t,{Z:function(){return j}});a(57658);var r=a(47056),i=a(16540),s=a(6309),l=a(794);const n=a(36797);var o={LoadEventPropParamPromise(e){return r.Z["new"]().propListOfEvent(e).then((function(e){var t=[],a=e.data.Props;if(a)for(var r=0;r<a.length;r++){var i={id:r,value:a[r].type_prop_name,label:a[r].prop_label,label2:l.Z.def.PropertyType.getZhLabel(a[r].prop_type),type:a[r].data_type,name:a[r].name,obj_label:a[r].obj_label,hide:a[r].hide,data_type_label:l.Z.def.DataType.getZhLabel(a[r].data_type),prop_type:a[r].prop_type,dim_label:a[r].dim_label,dim_name:a[r].dim_name,table_type:l.Z.def.TableType.TableTypeEvent,type_prop_name:a[r].type_prop_name,data_source_type:l.Z.def.DataSourceType.DataSourceTypeEventProp};l.Z.utils.IsObjProp(i.value)&&(i.label=i.obj_label),l.Z.utils.IsDimProp(i.value)&&(i.label=i.dim_label),l.Z.utils.IsEmptyStr(i.label)&&(i.label=i.name),i.hide?i.hide="是":t.push(i)}return t})).catch((function(e){return Promise.reject(e)}))},LoadUserProp(e){return r.Z["new"]().propListOfUser({app_id:e,include_obj_schema:!0,include_dim_schema:!0,include_obj_dim_schema:!0}).then((function(e){var t=[],a=e.data.Props;if(a)for(var r=0;r<a.length;r++){var i={id:r,value:a[r].type_prop_name,name:a[r].name,label:a[r].prop_label,label2:l.Z.def.PropertyType.getZhLabel(a[r].prop_type),type:a[r].data_type,type_prop_name:a[r].type_prop_name,obj_label:a[r].obj_label,hide:a[r].hide,data_type_label:l.Z.def.DataType.getZhLabel(a[r].data_type),prop_type:a[r].prop_type,dim_label:a[r].dim_label,dim_name:a[r].dim_name,table_type:l.Z.def.TableType.TableTypeUser,data_source_type:l.Z.def.DataSourceType.DataSourceTypeUserProp};l.Z.utils.IsObjProp(i.value)&&(i.label=i.obj_label),l.Z.utils.IsDimProp(i.value)&&(i.label=i.dim_label),l.Z.utils.IsEmptyStr(i.label)&&(i.label=i.name),i.hide?i.hide="是":t.push(i)}return t})).catch((function(e){return Promise.reject(e)}))},LoadPlainEventList(e,t){return r.Z["new"]().list({app_id:e,include_any_event:t,include_normal_fields:!1,include_obj_schema:!1,include_dim_schema:!1,include_obj_dim_schema:!1}).then((function(e){var t=[],a=e.data.events;if(a)for(var r=0;r<a.length;r++){var i={id:r,value:a[r].name,label:a[r].label,hide:a[r].hide,data_source_type:l.Z.def.DataSourceType.DataSourceTypePlainEvent};l.Z.utils.IsEmptyStr(i.label)&&(i.label=i.value),i.hide?i.hide="是":t.push(i)}return t})).catch((function(e){return Promise.reject(e)}))},LoadUserClusterList(e,t){return i.Z["new"]().ListUserGroup({app:e,ignore_client_data:t}).then((function(e){for(var t=[],a=0;a<e.data.length;a++)t.push({value:e.data[a].name,name:e.data[a].name,label:e.data[a].label,tag_type:l.Z.def.UserTagType.getZhLabel(e.data[a].type),data_type_label:l.Z.def.DataType.getZhLabel(e.data[a].data_type),zone:e.data[a].zone,timezone:e.data[a].zone,zone_label:l.Z.def.TimeZone.getZhLabel(e.data[a].zone),app_id:e.data[a].app,date:n(1e3*e.data[a].created_at).format("YYYY-MM-DD"),client_data:e.data[a].client_data,data_source_type:l.Z.def.DataSourceType.DataSourceTypeUserCluster});return t})).catch((function(e){return Promise.reject(e)}))},LoadUserTagList(e,t){return i.Z["new"]().listUsertag({app:e,ignore_client_data:t}).then((function(e){for(var t=[],a=0;a<e.data.length;a++)t.push({value:e.data[a].name,name:e.data[a].name,label:e.data[a].label,tag_type:l.Z.def.UserTagType.getZhLabel(e.data[a].type),data_type_label:l.Z.def.DataType.getZhLabel(e.data[a].data_type),type:e.data[a].data_type,zone:e.data[a].zone,timezone:e.data[a].zone,zone_label:l.Z.def.TimeZone.getZhLabel(e.data[a].zone),app_id:e.data[a].app,date:n(1e3*e.data[a].created_at).format("YYYY-MM-DD"),client_data:e.data[a].client_data,data_source_type:l.Z.def.DataSourceType.DataSourceTypeUserTag});return t})).catch((function(e){return Promise.reject(e)}))},LoadAnalysisEnityList(e){return s.Z["new"]().list({app_id:e}).then((function(e){return e.data.entities.forEach((e=>{e.value=e.id,e.label=e.name})),e.data.entities})).catch((function(e){return Promise.reject(e)}))},LoadAnalysisEntityPropList(e){return s.Z["new"]().avaliable_prop({app_id:e}).then((function(e){var t=[],a=e.data;if(a)for(var r=0;r<a.length;r++){var i=a[r];i.label3=i.data_type,i.value=i.type_prop_name,l.Z.utils.IsEmptyStr(i.label)&&(i.label=i.name),i.hide?i.hide="是":t.push(i)}return t})).catch((function(e){return Promise.reject(e)}))}},d={ParseMetricOfBehaviorMetricCondition(e){var t=e.split("."),a={};return t.length>0&&(a.category=t[0]),t.length>1&&(a.metric_type=t[t.length-1]),t.length>2&&(a.prop=t.slice(1,-1).join(".")),a},UnparseMetricOfBehaviorMetricCondition(e){var t=[];return t.push(e.category),t.push(e.type_prop_name),t.push(e.metric_type),t.join(".")},VueEventMetrics2ApiEventMetrics(e){for(var t=[],a=0;a<e.length;a++)t.push(this.VueEventMetricRecord2ApiEventRecord(e[a]));return t},VueEventMetricRecord2ApiEventRecord(e){var t=this.ParseMetricOfBehaviorMetricCondition(e.metric),a={id:e.id,label:e.label,event_name:e.event,category:t.category,type_prop_name:t.prop,filter:this.VuePropFilterGroup2ApiGlobalFilter(e.combo),metric_type:t.metric_type,fomular:e.formular,modifier:e.modifier};return l.Z.def.MetricCategory.MetricCategoryEntity==t.category&&(a.entity_id=l.Z.utils.ParseNumberSafe(t.prop)),a},VueEventMetricRecord2PropMetric(e,t){var a={id:String(e.id),label:e.label,type_prop_name:e.type_prop_name,metric_type:t};return a},VueEventFilterGroup2ApiEventFilter(e,t){return{event_name:e,combo:this.VuePropFilterGroup2ApiPropFilterCombo(t)}},VuePropFilterGroup2ApiGlobalFilter(e){return{combo:this.VuePropFilterGroup2ApiPropFilterCombo(e)}},VuePropFilterGroup2ApiPropFilterCombo(e){var t={record:[],combo:[],group:[],tag:[]};if(e&&e.children&&e.children.length>0){t.logic=e.logicop;for(var a=0;a<e.children.length;a++)if(e.children[a].record)if(e.children[a].record&&e.children[a].record.pickersubject&&e.children[a].record.pickersubject.data_source_type==l.Z.def.DataSourceType.DataSourceTypeUserCluster){var r=this.getReqGroupCondition(e.children[a].record);t.group.push(r)}else if(e.children[a].record&&e.children[a].record.pickersubject&&e.children[a].record.pickersubject.data_source_type==l.Z.def.DataSourceType.DataSourceTypeUserTag){var i=this.getReqTagCondition(e.children[a].record);t.tag.push(i)}else{var s=this.getReqPropCondition(e.children[a].record);t.record.push(s)}else if(e.children[a].children){for(var n={record:[],combo:[],group:[],tag:[]},o=0;o<e.children[a].children.length;o++)if(e.children[a].children[o].record&&e.children[a].children[o].record.pickersubject&&e.children[a].children[o].record.pickersubject.data_source_type==l.Z.def.DataSourceType.DataSourceTypeUserCluster){var d=this.getReqGroupCondition(e.children[a].children[o].record);n.group.push(d)}else if(e.children[a].children[o].record&&e.children[a].children[o].record.pickersubject&&e.children[a].children[o].record.pickersubject.data_source_type==l.Z.def.DataSourceType.DataSourceTypeUserTag){var u=this.getReqTagCondition(e.children[a].children[o].record);n.tag.push(u)}else{var c=this.getReqPropCondition(e.children[a].children[o].record);n.record.push(c)}t.combo.push(n)}}return t},getReqGroupCondition(e){return{table_type:e.pickersubject.table_type,name:e.pickersubject.name,op:e.selectedOp}},getReqTagCondition(e){return{table_type:e.pickersubject.table_type,name:e.pickersubject.name,op:e.selectedOp,values:l.Z.utils.ParseStrListSafe(e.params)}},getReqPropCondition(e){return{table_type:e.pickersubject.table_type,type_prop_name:e.pickersubject.type_prop_name,op:e.selectedOp,list_pos:e.elPos,list_ele_op:e.elSelectedOp,values:l.Z.utils.ParseStrListSafe(e.params)}}},u={VueGroupbyfield2ApiBreak(e,t){var a={type_prop_name:t.editing_field.type_prop_name,cluster_name:t.editing_field.value,event_name:e,params:[],label:t.editing_field.label,break_option:t.breakOption,table_type:t.editing_field.table_type};if(t.editing_field.type==l.Z.def.PrimaryDataType.PrimaryDataTypeNumber)for(var r=0;r<t.numberList.length;r++)a.params.push(String(t.numberList[r].value));return t.editing_field.data_source_type==l.Z.def.DataSourceType.DataSourceTypeUserProp?(a.break_type="prop",a.table_type=l.Z.def.TableType.TableTypeUser):t.editing_field.data_source_type==l.Z.def.DataSourceType.DataSourceTypeEventProp?(a.break_type="prop",a.table_type=l.Z.def.TableType.TableTypeEvent):t.editing_field.data_source_type==l.Z.def.DataSourceType.DataSourceTypeUserCluster?a.break_type="cluster":t.editing_field.data_source_type==l.Z.def.DataSourceType.DataSourceTypeUserTag?a.break_type="tag":a.break_type="const",a},VueGroupbys2ApiBreakList(e,t){for(var a=[],r=0;r<t.children.length;r++)t.children[r].groupbyfield&&a.push(this.VueGroupbyfield2ApiBreak(e,t.children[r].groupbyfield));return a}},c=a(58362),p=a(74806),f={MakeTabGroup(e,t,a,r){var i=[];if(e){var s={group_name:c.Z.t("message.事件属性"),value:c.Z.t("message.事件属性"),type:"list",icon:"",children:e};(0,p.isArray)(e)||(s=e);for(var n=0;n<s.children.length;n++)s.children[n].label2=l.Z.def.PropertyType.getZhLabel(s.children[n].label2),s.children[n].label3=l.Z.def.DataType.getZhLabel(s.children[n].type);s.children&&s.children.length>0&&i.push(s)}if(t){var o={group_name:c.Z.t("message.用户属性"),value:c.Z.t("message.用户属性"),type:"list",icon:"",children:t};for(n=0;n<o.children.length;n++)o.children[n].label2=l.Z.def.PropertyType.getZhLabel(o.children[n].label2),o.children[n].label3=l.Z.def.DataType.getZhLabel(o.children[n].type);o.children&&o.children.length>0&&i.push(o)}if(a){var d={group_name:c.Z.t("message.用户分群"),value:c.Z.t("message.用户分群"),type:"list",icon:"",children:a};for(n=0;n<d.children.length;n++)d.children[n].label2=l.Z.def.PropertyType.getZhLabel(d.children[n].label2),d.children[n].label3=l.Z.def.DataType.getZhLabel(d.children[n].type);d.children&&d.children.length>0&&i.push(d)}if(r){var u={group_name:c.Z.t("message.用户标签"),value:c.Z.t("message.用户标签"),type:"list",icon:"",children:r};for(n=0;n<u.children.length;n++)u.children[n].label2=l.Z.def.PropertyType.getZhLabel(u.children[n].label2),u.children[n].label3=l.Z.def.DataType.getZhLabel(u.children[n].type);u.children&&u.children.length>0&&i.push(u)}return i}},m=(a(30541),a(53013)),h={TransposeTableData(e){if(!this.isTrasposable(e))return e;var t={columns:[],data:[],vs:!1,sql_timegrain_dim_field:e.sql_timegrain_dim_field,sql_breaks:e.sql_breaks,sql_HeaderId:e.sql_HeaderId,sql_metric:e.sql_metric,metric_map:new Map,transposed_date_header_list:[]},a="",r={},i=this.getPlainBreakFieldList(e.sql_breaks);if(e.timegrain_at_row){var s,n,o,d="",u=new Map,c=new Map,p=[];for(l.Z.utils.Ignore(d,u),e.sql_metric.forEach((e=>{t.metric_map.set(e.label,e)})),p=e.sql_metric,s=0;s<e.data.length;s++){a="";const t=e.data[s];for(n=0;n<i.length;n++)a+=m.x64.hash128(String(t[i[n]]));for(n=0;n<p.length;n++){if(d=m.x64.hash128(a+String(p[n].HeaderId)),r=u.get(d),void 0===r){for(r={},r[l.Z.def.TransposeMetricFieldName]=p[n].label,o=0;o<i.length;o++)r[i[o]]=t[i[o]];u.set(d,r)}var f=t[e.sql_timegrain_dim_field];r[f]=t[p[n].HeaderId],c.set(f,1)}}for(const e of u.values())t.data.push(e);this.addColumnDescForTransposeMetricField(t.columns),this.addColumnDescForBreaks(t.columns,e.sql_breaks);var h=[];for(c.forEach((function(e,t){l.Z.utils.Ignore(e),h.push({field:t,label:t})})),h.sort((function(e,t){return e.unix-t.unix})),n=0;n<h.length;n++)t.columns.push({sortable:!0,field:h[n].field,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeMetric,type_prop_name:"",label:h[n].label,sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,visible:!0});t.transposed_date_header_list=h,t.timegrain_at_row=!1}else{for(u=new Map,p=[],n=0;n<e.transposed_date_header_list.length;n++)p.push(e.transposed_date_header_list[n].field);for(s=0;s<e.data.length;s++){a="";const t=e.data[s];for(n=0;n<i.length;n++)a+=m.x64.hash128(String(t[i[n]]));for(n=0;n<p.length;n++){d=m.x64.hash128(a+String(p[n]));var y=u.get(d);if(void 0===y)for(y={},y[e.sql_timegrain_dim_field]=p[n],o=0;o<i.length;o++)y[i[o]]=t[i[o]];var _=e.metric_map.get(t[l.Z.def.TransposeMetricFieldName]);y[_.HeaderId]=t[p[n]],u.set(d,y)}}for(const e of u.values())t.data.push(e);this.addColumnDescForTimeGrain(t.columns,e.sql_timegrain_dim_field),this.addColumnDescForBreaks(t.columns,e.sql_breaks),this.addColumnDescForMetrics(t.columns,e.sql_metric),t.timegrain_at_row=!0}return t},calcArrayListSummary(e){var t=[],a=[],r=[],i=[0,0],s=l.Z.def.TensorType.getTensorType(e[0]);e.forEach((e=>{var n=[];n=s==l.Z.def.TensorType.TensorTypeScalar?[e]:e;for(var o=0;o<s||0==o;o++){var d=Number(n[o]);Number.isNaN(d)||(void 0===t[o]?(t[o]=d,a[o]=d,r[o]=d):(t[o]+=d,a[o]=a[o]<d?d:a[o],r[o]=r[o]>d?d:r[o]),i[o]++)}}));var n={};if(s!=l.Z.def.TensorType.TensorTypeScalar){n[l.Z.def.SummaryColType.SummaryColTypeSum]=t;for(var o=l.Z.utils.DeepClone(t),d=0;d<s||0==d;d++)i[d]>0?o[d]=o[d]/i[d]:o[d]="";n[l.Z.def.SummaryColType.SummaryColTypeAvg]=o,n[l.Z.def.SummaryColType.SummaryColTypeMax]=a,n[l.Z.def.SummaryColType.SummaryColTypeMin]=r}else n[l.Z.def.SummaryColType.SummaryColTypeSum]=t[0],n[l.Z.def.SummaryColType.SummaryColTypeAvg]=t[0]/i[0],n[l.Z.def.SummaryColType.SummaryColTypeMax]=a[0],n[l.Z.def.SummaryColType.SummaryColTypeMin]=r[0];return n},AddSummaryTableData(e,t){if(e.sql_timegrain_dim_field){var a=e.columns.filter((e=>e.sql_dim_type==l.Z.def.SqlDimType.SqlDimTypeMetric)),r=0,i={},s={};if(e.timegrain_at_row){var n=new Map;e.data.forEach((t=>{var i=[],s="key";for(r=0;r<e.sql_breaks.length;r++){var o=t[e.sql_breaks[r].HeaderId];i.push(o),s=m.x64.hash128(s+String(o))}var d=n.get(s);for(void 0===d&&(d={metrics:{},breaks:i},n.set(s,d)),u=0;u<a.length;u++)l.Z.utils.IsEmptyObj(d.metrics[a[u].field])&&(d.metrics[a[u].field]=[]),d.metrics[a[u].field].push(t[a[u].field])}));for(let[a,o]of n){for(l.Z.utils.Ignore(a),i={},i[e.sql_timegrain_dim_field]=`${l.Z.def.TableDataSummaryNameLabel}(${l.Z.def.SummaryColType.getZhLabel(t)})`,r=0;r<e.sql_breaks.length;r++)i[e.sql_breaks[r].HeaderId]=o.breaks[r];for(let e in o.metrics)s=this.calcArrayListSummary(o.metrics[e]),i[e]=s[t];e.data.unshift(i)}}else{var o=e.columns.filter((e=>e.sql_dim_type==l.Z.def.SqlDimType.SqlDimTypeSummary))[0];o||(o=this.addColumnDescForSummary(e.columns)),o.label=`${l.Z.def.TableDataSummaryNameLabel}(${l.Z.def.SummaryColType.getZhLabel(t)})`;var d={};d[l.Z.def.SqlDimType.SqlDimTypeTimeGrain]=0,d[l.Z.def.SqlDimType.SqlDimTypeBreak]=1,d[l.Z.def.SqlDimType.SqlDimTypeSummary]=1,d[l.Z.def.SqlDimType.SqlDimTypeMetric]=2,e.columns.sort((function(e,t){return d[e.sql_dim_type]<d[t.sql_dim_type]?-1:d[e.sql_dim_type]>d[t.sql_dim_type]?1:0}));var u=0,c=!1;e.data.forEach((e=>{e[o.field]=0;var r=[];for(u=0;u<a.length;u++)(0,p.isArray)(e[a[u].field])?(r.push(e[a[u].field]),c=!0):r.push([e[a[u].field]]);var i=this.calcArrayListSummary(r,c);e[o.field]=i[t]}))}l.Z.utils.Ignore(e,t)}},RemoveSummaryTableData(e){if(e.sql_timegrain_dim_field){var t=0;for(t=0;t<e.columns.length;t++)if(e.columns[t].sql_dim_type==l.Z.def.SqlDimType.SqlDimTypeSummary){for(e.columns.splice(t,1),t=0;t<e.data.length;t++)delete e.data[t][l.Z.def.TableDataSummaryName];break}e.timegrain_at_row&&(e.data=e.data.filter((t=>-1==t[e.sql_timegrain_dim_field].indexOf(l.Z.def.TableDataSummaryNameLabel))))}},addColumnDescForTransposeMetricField(e){e.push({sortable:!0,field:l.Z.def.TransposeMetricFieldName,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeBreak,type_prop_name:"",label:l.Z.def.TransposeMetricFieldNameLabel,sort_type:l.Z.def.BreakSortType.BreakSortTypeString,visible:!0})},addColumnDescForTimeGrain(e,t){e.push({sortable:!0,field:t,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeTimeGrain,type_prop_name:"",label:l.Z.def.TimeGrainDimFieldNameLabel,sort_type:l.Z.def.BreakSortType.BreakSortTypeDatetime,visible:!0})},addColumnDescForBreaks(e,t){for(var a=0;a<t.length;a++)e.push({sortable:!0,field:t[a].HeaderId,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeBreak,type_prop_name:t[a].type_prop_name,label:t[a].label,sort_type:t[a].client_sort_type,visible:!0})},addColumnDescForMetrics(e,t){for(var a=0;a<t.length;a++)e.push({sortable:!0,field:t[a].HeaderId,modifier:t[a].modifier,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeMetric,type_prop_name:t[a].type_prop_name,label:t[a].label,sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,visible:!0})},addColumnDescForSummary(e){var t={sortable:!0,field:l.Z.def.TableDataSummaryName,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeSummary,type_prop_name:"",label:l.Z.def.TableDataSummaryNameLabel,sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,visible:!0};return e.push(t),t},getPlainBreakFieldList(e){for(var t=[],a=0;a<e.length;a++)t.push(e[a].HeaderId);return t},isTrasposable(e){return!l.Z.utils.IsEmptyStr(e.sql_timegrain_dim_field)},SummaryGridData(e,t,a,r){var i=[],s=[],l=[];e.HeaderId.forEach(((e,r)=>{t.indexOf(e)>=0&&i.push(r),a.indexOf(e)>=0&&s.push(r)}));var n=new Map;return e.Rows.forEach((t=>{var a="";i.forEach((e=>{a+=m.x64.hash128(String(t[e]))}));var r=n.get(a);void 0===r&&(r={},n.set(a,r),i.forEach((a=>{r[e.HeaderId[a]]=t[a]})),l.push(r),s.forEach((t=>{r[e.HeaderId[t]]=[]}))),s.forEach((a=>{r[e.HeaderId[a]].push(t[a])}))})),l.forEach((t=>{s.forEach((a=>{var i=this.calcArrayListSummary(t[e.HeaderId[a]]);t[e.HeaderId[a]]=i[r]}))})),l}},y=a(36797),_=a.n(y),g={ToTabledata(e){return this.datasetToTableData(e[0])},datasetToTableData(e,t){this.addHeaderIdToBreak(e);var a={columns:[],data:[],vs:!1,timegrain_at_row:!0,sql_timegrain_dim_field:"",sql_breaks:e.breaks,sql_HeaderId:e.grid.HeaderId,sql_metric:e.metrics,retent_lost:e.retent_times.retent_lost},r=0;for(e.grain!=l.Z.def.TimeGrain.GrainMill&&(a.sql_timegrain_dim_field=e.grid.HeaderId[0],this.addColumnDescForTimeGrain(a.columns,e.grid.HeaderId[0])),this.addColumnDescForBreaks(a.columns,e.breaks),this.addColumnDescForMetrics(a.columns,e),r=0;r<e.grid.Rows.length;r++){for(var i={},s=0;s<a.columns.length;s++)a.columns[s].sql_dim_type==l.Z.def.SqlDimType.SqlDimTypeMetric?i[a.columns[s].field]=[Number(e.grid.Rows[r][s])]:i[a.columns[s].field]=e.grid.Rows[r][s];for(s=0;s<a.columns.length;s++)if(a.columns[s].sql_dim_type==l.Z.def.SqlDimType.SqlDimTypeMetric&&a.columns[s].field!=l.Z.def.TableDataRetentCol.getMetric("0")){if(_()(i[a.sql_timegrain_dim_field]).add(Number(a.columns[s].offset),l.Z.def.TimeGrain.getMomentDurationUnit(e.retent_times.grain)).unix()>_()().unix()){i[a.columns[s].field]=[];continue}e.retent_times.retent_lost||(i[a.columns[s].field][0]=i[l.Z.def.TableDataRetentCol.getMetric(0)][0]-i[a.columns[s].field][0]),i[a.columns[s].field].push(i[l.Z.def.TableDataRetentCol.getMetric(0)][0])}a.data.push(i)}return a.sql_timegrain_dim_field&&l.Z.utils.SortObjArrayByField(a.data,a.sql_timegrain_dim_field,l.Z.def.BreakSortType.BreakSortTypeDatetime,t),a},addHeaderIdToBreak(e){for(var t=1,a=0;a<e.breaks.length;a++)e.breaks[a].HeaderId=e.grid.HeaderId[a+t]},addColumnDescForTimeGrain(e,t){e.push({sortable:!0,field:t,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeTimeGrain,type_prop_name:"",label:l.Z.def.TimeGrainDimFieldNameLabel,sort_type:l.Z.def.BreakSortType.BreakSortTypeDatetime,visible:!0,display_type:l.Z.def.DisplayType.DisplayTypeDatetime,modifier:"YYYY-MM-DD(do)"})},addColumnDescForBreaks(e,t){for(var a=0;a<t.length;a++)e.push({sortable:!0,field:t[a].HeaderId,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeBreak,type_prop_name:t[a].type_prop_name,label:t[a].label,sort_type:t[a].client_sort_type,visible:!0})},addColumnDescForMetrics(e,t){for(var a=1+t.breaks.length;a<t.grid.HeaderId.length;a++){var r={sortable:!0,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeMetric,type_prop_name:t.grid.HeaderId[a],offset:t.grid.HeaderId[a],sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,HeaderIdIndex:a,visible:!0,showPercent:l.Z.def.ShowPercent.ShowPercentPercent,enable_percent_background:!0,percent_position:l.Z.def.PercentPosition.PercentPositionBottom};r.field=l.Z.def.TableDataRetentCol.getMetric(t.grid.HeaderId[a]),r.id=r.field,r.label=l.Z.def.TableDataRetentCol.getZhLabel(t.grid.HeaderId[a],l.Z.def.TimeGrain.getZhLabel(t.retent_times.grain)),e.push(r)}},datasetToChartDataset(e){var t=e[0],a={data:[],sql_timegrain_dim_field:"",sql_breaks:t.breaks,sql_HeaderId:t.grid.HeaderId,sql_metric:[]},r=0;a.sql_timegrain_dim_field=t.grid.HeaderId[0],this.addColumnDescForMetrics(a.sql_metric,t);var i=t.breaks.map((e=>e.id)),s=new Map;for(a.sql_metric.forEach((e=>{s.set(e.id,{id:e.id,label:e.label})})),r=0;r<t.grid.Rows.length;r++){for(var n={},o=0;o<a.sql_HeaderId.length;o++)(a.sql_HeaderId[o]==a.sql_timegrain_dim_field||i.indexOf(a.sql_HeaderId[o])>=0)&&(n[a.sql_HeaderId[o]]=t.grid.Rows[r][o]),a.sql_metric.forEach((e=>{n[e.id]=t.grid.Rows[r][e.HeaderIdIndex]}));a.data.push(n)}var d={data:[],sql_timegrain_dim_field:"",sql_breaks:[],sql_metric:[]},u=l.Z.utils.TranposeObjArray(a.data);d.sql_breaks.push({sortable:!0,field:"R0",id:"R0",sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeBreak,label:"日期",sort_type:l.Z.def.BreakSortType.BreakSortTypeString,visible:!0});var c=new Map;for(let f in u[0])if("R0"!=f){var p={id:f,field:f,label:u[0][f],sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,visible:!0,ref:[]};d.sql_metric.push(p),c.set(f,p)}return u.forEach((e=>{i.indexOf(e[0])>0&&c.forEach(((t,a)=>{t.ref.push(e[a])}))})),c.forEach((e=>{e.label=e.label+l.Z.utils.ParseStrListSafe(e.ref).join(".")})),u.forEach((e=>{var t=s.get(e["R0"]);void 0!==t&&(e["R0"]=t.label,d.data.push(e))})),d},GetVisualTypeList(){var e=this.GetChartTypeList();return e.push(l.Z.def.ChartType.getLabelValue(l.Z.def.ChartType.Table)),e},GetChartTypeList(){return l.Z.def.ChartType.GetLabelValueListByValue([l.Z.def.ChartType.Bar])}};const b="ltv",T="user_total";var v={ToTabledata(e){return this.datasetToTableData(e[0])},datasetToTableData(e,t){this.addHeaderIdToBreak(e);var a={columns:[],data:[],vs:!1,timegrain_at_row:!0,sql_timegrain_dim_field:"",sql_breaks:e.breaks,sql_HeaderId:e.grid.HeaderId,sql_metric:e.metrics},r=0;for(a.sql_timegrain_dim_field=e.grid.HeaderId[0],this.addColumnDescForTimeGrain(a.columns,e.grid.HeaderId[0]),this.addColumnDescForBreaks(a.columns,e.breaks),this.addColumnDescForMetrics(a.columns,e),r=0;r<e.grid.Rows.length;r++){for(var i={},s=0;s<a.columns.length;s++)if(a.columns[s].sql_dim_type==l.Z.def.SqlDimType.SqlDimTypeMetric){var n=Number(e.grid.Rows[r][s]);i[a.columns[s].field]=[],n>=0&&(i[a.columns[s].field]=[n])}else i[a.columns[s].field]=e.grid.Rows[r][s];for(s=0;s<a.columns.length;s++)a.columns[s].sql_dim_type==l.Z.def.SqlDimType.SqlDimTypeMetric&&a.columns[s].field.startsWith(b)&&(n=Number(e.grid.Rows[r][s])/Number(i[T]),l.Z.utils.IsEmptyStr(e.grid.Rows[r][s])||Number.isNaN(n)?i[a.columns[s].field]="":i[a.columns[s].field]=n);a.data.push(i)}return a.sql_timegrain_dim_field&&l.Z.utils.SortObjArrayByField(a.data,a.sql_timegrain_dim_field,l.Z.def.BreakSortType.BreakSortTypeDatetime,t),a},addHeaderIdToBreak(e){for(var t=1,a=0;a<e.breaks.length;a++)e.breaks[a].HeaderId=e.grid.HeaderId[a+t]},addColumnDescForTimeGrain(e,t){e.push({sortable:!0,field:t,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeTimeGrain,type_prop_name:"",label:l.Z.def.TimeGrainDimFieldNameLabel,sort_type:l.Z.def.BreakSortType.BreakSortTypeDatetime,visible:!0,display_type:l.Z.def.DisplayType.DisplayTypeDatetime,modifier:"YYYY-MM-DD(do)"})},addColumnDescForBreaks(e,t){for(var a=0;a<t.length;a++)e.push({sortable:!0,field:t[a].HeaderId,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeBreak,type_prop_name:t[a].type_prop_name,label:t[a].label,sort_type:t[a].client_sort_type,visible:!0})},addColumnDescForMetrics(e,t){for(var a=1+t.breaks.length;a<t.grid.HeaderId.length;a++){var r={sortable:!0,field:t.grid.HeaderId[a],sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeMetric,type_prop_name:t.grid.HeaderId[a],offset:t.grid.HeaderId[a],sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,HeaderIdIndex:a,visible:!0,modifier:l.Z.def.ModifierType.ModifierTypeRound2};r.id=t.grid.HeaderId[a],r.label=t.grid.HeaderId[a],r.label.startsWith(b)?r.label==b+"0"&&"cn"==c.Z.locale?r.label="当天":r.label.length>b.length?r.label=r.label.replace(b,"LTV "):r.label=r.label.replace(b,"LTV"):r.id==T&&(r.label=c.Z.t("message.起始用户数")),e.push(r)}},GetVisualTypeList(){var e=this.GetChartTypeList();return e.push(l.Z.def.ChartType.getLabelValue(l.Z.def.ChartType.Table)),e},GetChartTypeList(){return l.Z.def.ChartType.GetLabelValueListByValue([])}},Z={ToTabledata(e){return this.datasetToTableData(e[0])},datasetToTableData(e,t){this.addHeaderIdToBreak(e);var a={columns:[],data:[],vs:!1,timegrain_at_row:!0,sql_timegrain_dim_field:"",sql_breaks:e.breaks,sql_HeaderId:e.grid.HeaderId,sql_metric:e.steps,funnel_set:e.funnel_set},r=0;for(e.grain=l.Z.def.TimeGrain.GrainDay,a.sql_timegrain_dim_field=e.grid.HeaderId[0],this.addColumnDescForTimeGrain(a.columns,e.grid.HeaderId[0]),this.addColumnDescForBreaks(a.columns,e.breaks),this.addColumnDescForMetrics(a.columns,e),this.addColumnDescForConvTotal(a.columns),r=0;r<e.grid.Rows.length;r++){for(var i={},s=0;s<a.columns.length-1;s++)a.columns[s].sql_dim_type==l.Z.def.SqlDimType.SqlDimTypeMetric?i[a.columns[s].field]=Number(e.grid.Rows[r][s]):i[a.columns[s].field]=e.grid.Rows[r][s];for(s=1;s<e.steps.length;s++)e.funnel_set.conv_lost?i[e.steps[s].id]=[i[e.steps[s].id]]:i[e.steps[s].id]=[i[e.steps[0].id]-i[e.steps[s].id]],1==s?i[e.steps[s].id].push(i[e.steps[s-1].id]):i[e.steps[s].id].push(i[e.steps[s-1].id][0]);i[l.Z.def.TableDataFunnelTotalName]=[i[e.steps[e.steps.length-1].id][0],i[e.steps[0].id]],a.data.push(i)}return a.sql_timegrain_dim_field&&l.Z.utils.SortObjArrayByField(a.data,a.sql_timegrain_dim_field,l.Z.def.BreakSortType.BreakSortTypeDatetime,t),this.sortColumnsOfTableData(a),a},sortColumnsOfTableData(e){var t={};t[l.Z.def.SqlDimType.SqlDimTypeTimeGrain]=0,t[l.Z.def.SqlDimType.SqlDimTypeBreak]=1,t[l.Z.def.SqlDimType.SqlDimTypeSummary]=1,t[l.Z.def.SqlDimType.SqlDimTypeMetric]=2,e.columns.sort((function(e,a){return t[e.sql_dim_type]<t[a.sql_dim_type]?-1:t[e.sql_dim_type]>t[a.sql_dim_type]?1:0}))},addHeaderIdToBreak(e){for(var t=1,a=0;a<e.breaks.length;a++)e.breaks[a].HeaderId=e.grid.HeaderId[a+t]},addColumnDescForTimeGrain(e,t){e.push({sortable:!0,field:t,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeTimeGrain,type_prop_name:"",label:l.Z.def.TimeGrainDimFieldNameLabel,sort_type:l.Z.def.BreakSortType.BreakSortTypeDatetime,visible:!0})},addColumnDescForBreaks(e,t){for(var a=0;a<t.length;a++)e.push({sortable:!0,field:t[a].HeaderId,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeBreak,type_prop_name:t[a].type_prop_name,label:t[a].label,sort_type:t[a].client_sort_type,visible:!0})},addColumnDescForMetrics(e,t){for(var a=0;a<t.steps.length;a++){var r={sortable:!0,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeMetric,conv_step:a,sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,visible:!0};r.field=t.steps[a].id,r.label=`${t.steps[a].label}(步骤${t.steps[a].id})`,e.push(r)}},addColumnDescForConvTotal(e){var t={sortable:!0,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeSummary,conv_step:0,sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,visible:!0};t.field=l.Z.def.TableDataFunnelTotalName,t.label=l.Z.def.TableDataFunnelTotalNameLabel,e.push(t)},fnKeepRate(e,t,a){return a?l.Z.def.ModifierType.getModifierValue(t/e,l.Z.def.ModifierType.ModifierTypePercent2):l.Z.def.ModifierType.getModifierValue((e-t)/e,l.Z.def.ModifierType.ModifierTypePercent2)},ToMixchartDatasetWithoutDate(e){l.Z.utils.Ignore(e);var t=e[0],a=t.funnel_set.conv_lost,r={dimensions:[l.Z.def.ChartSrcIndexCol],source:[],hasDate:!1,hasBreak:!1,metrics:[],srcCount:1},i=t.breaks.map((e=>e.id)),s=h.SummaryGridData(t.grid,i,t.steps.map((e=>e.id)),l.Z.def.SummaryColType.SummaryColTypeSum),n=l.Z.utils.TranposeObjArray(s);if(0==i.length)n.forEach((e=>{e[l.Z.def.ChartSrcIndexCol]=0,e[l.Z.def.ChartBreaksCol]=e["R0"],e[l.Z.def.TableDataFunnelTotalName]=e["R1"],r.source.push(e)})),r.hasBreak=!0,r.dimensions.push(l.Z.def.ChartBreaksCol),r.dimensions.push(l.Z.def.TableDataFunnelTotalName),r.metrics.push({id:l.Z.def.TableDataFunnelTotalName,label:l.Z.def.TableDataFunnelTotalNameLabel,dim:l.Z.def.TableDataFunnelTotalName,client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber});else{r.hasBreak=!0,r.dimensions.push(l.Z.def.ChartBreaksCol);for(var o=new Map,d=0;d<s.length;d++){var u=`R${d+1}`;o.set(u,{id:u,dim:u,client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,ref:[]})}n.forEach((e=>{if(e[l.Z.def.ChartSrcIndexCol]=0,e[l.Z.def.ChartBreaksCol]=e["R0"],i.indexOf(e["R0"])>=0)for(var t=0;t<s.length;t++){var a=`R${t+1}`,n=o.get(a);n.ref.push(String(e[a]))}else r.source.push(e)})),o.forEach((e=>{r.dimensions.push(e.id),e.label=e.ref.join(","),r.metrics.push(e)}))}return r.source.forEach(((e,t)=>{for(var i=0;i<r.metrics.length;i++){var s=r.metrics[i],l=`${s.id}_max`,n=`${s.id}_actual`;r.dimensions.push(l),r.dimensions.push(n),0==t?(e[n]=e[s.id],e[s.id]=100,e[l]=100):(e[n]=e[s.id],e[s.id]=this.fnKeepRate(r.source[0][n],e[n],a),e[l]=r.source[t-1][s.id])}})),r.dimensions=l.Z.utils.DeduplicatedList(r.dimensions),[r]},ToMixchartDatasetByDate(e){var t,a,r=e[0],i=r.funnel_dura,s=r.funnel_set.conv_lost,n={dimensions:[l.Z.def.ChartDateCol,l.Z.def.ChartSrcIndexCol],source:[],hasDate:!0,hasBreak:!1,metrics:[],srcCount:1};this.addHeaderIdToBreak(r),r.breaks.length>0&&(n.hasBreak=!0,n.dimensions.push(l.Z.def.ChartBreaksCol)),n.metrics.push({id:l.Z.def.TableDataFunnelTotalName,label:l.Z.def.TableDataFunnelTotalNameLabel,dim:l.Z.def.TableDataFunnelTotalName,client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber}),n.dimensions.push(l.Z.def.TableDataFunnelTotalName);var o=r.breaks.length+1;return r.grid.Rows.forEach((e=>{var d={};if(d[l.Z.def.ChartSrcIndexCol]=0,d[l.Z.def.ChartDateCol]=e[0],n.hasBreak){var u=r.breaks.map(((t,a)=>(l.Z.utils.Ignore(t),String(e[a+1]))));d[l.Z.def.ChartBreaksCol]=u.join(",")}if(-1==i[0])var c=e[o],p=e[o+(r.steps.length-1)];else c=e[o+i[0]],p=e[o+i[1]];t=this.fnKeepRate(c,p,!0),a=this.fnKeepRate(c,p,!1),d[l.Z.def.TableDataFunnelTotalName]=s?t:a,n.source.push(d)})),[n]},GetVisualTypeList(){var e=this.GetChartTypeList();return e.push(l.Z.def.ChartType.getLabelValue(l.Z.def.ChartType.Table)),e},GetChartTypeList(){return l.Z.def.ChartType.GetLabelValueListByValue([l.Z.def.ChartType.FunnelBar,l.Z.def.ChartType.Line])}},D={ToTabledata(e){return this.datasetToTableData(e[0])},setMetricInfo(e){e.metrics=[{id:"metriccount",HeaderId:"metriccount",client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,label:"总数"},{id:"metricmin",HeaderId:"metricmin",client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,label:"最小值"},{id:"metric1",HeaderId:"metric1",client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,label:"1%分位数"},{id:"metric3",HeaderId:"metric3",client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,label:"3%分位数"},{id:"metric5",HeaderId:"metric5",client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,label:"5%分位数"},{id:"metric10",HeaderId:"metric10",client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,label:"10%分位数"},{id:"metric25",HeaderId:"metric25",client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,label:"下四分位数"},{id:"metric50",HeaderId:"metric50",client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,label:"中位数"},{id:"metric75",HeaderId:"metric75",client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,label:"上四分位数"},{id:"metric90",HeaderId:"metric90",client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,label:"90%分位数"},{id:"metric95",HeaderId:"metric95",client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,label:"95%分位数"},{id:"metric97",HeaderId:"metric97",client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,label:"97%分位数"},{id:"metric99",HeaderId:"metric99",client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,label:"99%分位数"},{id:"metricmax",HeaderId:"metricmax",client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,label:"最大值"},{id:"metricavg",HeaderId:"metricavg",client_sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,label:"平均数"}]},datasetToTableData(e,t){this.setMetricInfo(e),this.addHeaderIdToBreak(e);var a={columns:[],data:[],vs:!1,timegrain_at_row:!0,sql_timegrain_dim_field:"",sql_breaks:e.breaks,sql_HeaderId:e.grid.HeaderId,sql_steps:e.steps,sql_metric:e.metrics,funnel_set:e.funnel_set},r=0;for(a.sql_timegrain_dim_field=e.grid.HeaderId[0],this.addColumnDescForTimeGrain(a.columns,e.grid.HeaderId[0]),this.addColumnDescForBreaks(a.columns,e.breaks),this.addColumnDescForMetrics(a.columns,e),r=0;r<e.grid.Rows.length;r++){for(var i={},s=0;s<a.columns.length;s++)i[a.columns[s].field]=e.grid.Rows[r][s];a.data.push(i)}return l.Z.utils.SortObjArrayByField(a.data,a.sql_timegrain_dim_field,l.Z.def.BreakSortType.BreakSortTypeDatetime,t),a},sortColumnsOfTableData(e){var t={};t[l.Z.def.SqlDimType.SqlDimTypeTimeGrain]=0,t[l.Z.def.SqlDimType.SqlDimTypeBreak]=1,t[l.Z.def.SqlDimType.SqlDimTypeSummary]=1,t[l.Z.def.SqlDimType.SqlDimTypeMetric]=2,e.columns.sort((function(e,a){return t[e.sql_dim_type]<t[a.sql_dim_type]?-1:t[e.sql_dim_type]>t[a.sql_dim_type]?1:0}))},addHeaderIdToBreak(e){for(var t=1,a=0;a<e.breaks.length;a++)e.breaks[a].HeaderId=e.grid.HeaderId[a+t]},addColumnDescForTimeGrain(e,t){e.push({sortable:!0,field:t,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeTimeGrain,type_prop_name:"",label:l.Z.def.TimeGrainDimFieldNameLabel,sort_type:l.Z.def.BreakSortType.BreakSortTypeDatetime,visible:!0})},addColumnDescForBreaks(e,t){for(var a=0;a<t.length;a++)e.push({sortable:!0,field:t[a].HeaderId,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeBreak,type_prop_name:t[a].type_prop_name,label:t[a].label,sort_type:t[a].client_sort_type,visible:!0})},addColumnDescForMetrics(e,t){for(var a=0;a<t.metrics.length;a++){var r={sortable:!0,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeMetric,field:t.metrics[a].id,label:t.metrics[a].label,sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,visible:!0};e.push(r)}},GetVisualTypeList(){var e=this.GetChartTypeList();return e.push(l.Z.def.ChartType.getLabelValue(l.Z.def.ChartType.Table)),e},GetChartTypeList(){return l.Z.def.ChartType.GetLabelValueListByValue([l.Z.def.ChartType.Boxplot])}},S={ToTabledata(e){return this.datasetToTableData(e[0])},datasetToTableData(e,t){var a={columns:[],data:[],vs:!1,timegrain_at_row:!0,sql_timegrain_dim_field:"",sql_breaks:e.breaks,sql_HeaderId:e.grid.HeaderId,sql_metric:e.steps,funnel_set:e.funnel_set},r=0;e.analysis_time_range&&e.analysis_time_range.grain&&e.analysis_time_range.grain!=l.Z.def.TimeGrain.GrainMill&&(a.sql_timegrain_dim_field=e.grid.HeaderId[0],this.addColumnDescForTimeGrain(a.columns,e.grid.HeaderId[0])),this.addHeaderIdToBreak(e),this.addColumnDescForBreaks(a.columns,e.breaks);var i=a.columns.length;for(this.addColumnDescForMetrics(a.columns,e),r=0;r<e.grid.Rows.length;r++){for(var s={},n=0,o=0;o<a.columns.length;o++)s[a.columns[o].field]=e.grid.Rows[r][o],a.columns[o].sql_dim_type==l.Z.def.SqlDimType.SqlDimTypeMetric&&(n+=l.Z.utils.ParseNumberSafe(e.grid.Rows[r][o]));for(o=0;o<a.columns.length;o++)a.columns[o].sql_dim_type==l.Z.def.SqlDimType.SqlDimTypeMetric&&(s[a.columns[o].field]=[s[a.columns[o].field],n]);s[l.Z.def.TableDataDistriTotalUserName]=n,a.data.push(s)}return this.insertColumnDescForTotalUser(a.columns,i),l.Z.utils.SortObjArrayByField(a.data,a.sql_timegrain_dim_field,l.Z.def.BreakSortType.BreakSortTypeDatetime,t),this.sortColumnsOfTableData(a),a},sortColumnsOfTableData(e){var t={};t[l.Z.def.SqlDimType.SqlDimTypeTimeGrain]=0,t[l.Z.def.SqlDimType.SqlDimTypeBreak]=1,t[l.Z.def.SqlDimType.SqlDimTypeSummary]=1,t[l.Z.def.SqlDimType.SqlDimTypeMetric]=2,e.columns.sort((function(e,a){return t[e.sql_dim_type]<t[a.sql_dim_type]?-1:t[e.sql_dim_type]>t[a.sql_dim_type]?1:0}))},addHeaderIdToBreak(e){var t=0;e.analysis_time_range.grain!=l.Z.def.TimeGrain.GrainMill&&(t=1);for(var a=0;a<e.breaks.length;a++)e.breaks[a].HeaderId=e.grid.HeaderId[a+t]},addColumnDescForTimeGrain(e,t){e.push({sortable:!0,field:t,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeTimeGrain,type_prop_name:"",label:l.Z.def.TimeGrainDimFieldNameLabel,sort_type:l.Z.def.BreakSortType.BreakSortTypeDatetime,visible:!0})},addColumnDescForBreaks(e,t){for(var a=0;a<t.length;a++)e.push({sortable:!0,field:t[a].HeaderId,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeBreak,type_prop_name:t[a].type_prop_name,label:t[a].label,sort_type:t[a].client_sort_type,visible:!0})},insertColumnDescForTotalUser(e,t){var a={sortable:!0,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeMetric,type_prop_name:"",sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,visible:!0};a.field=l.Z.def.TableDataDistriTotalUserName,a.label=l.Z.def.TableDataDistriTotalUserLabel(),e.splice(t,0,a)},addColumnDescForMetrics(e,t){var a=t.breaks.length;t.analysis_time_range.grain!=l.Z.def.TimeGrain.GrainMill&&(a+=1);for(var r=this.getNumSectionLabelList(t.distri_set.distri_param.num_list),i=0,s=0;s<t.grid.HeaderId.length;s++)if(!(s<a)){var n={sortable:!0,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeMetric,field:t.grid.HeaderId[s],id:t.grid.HeaderId[s],sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,visible:!0,showPercent:l.Z.def.ShowPercent.ShowPercentPercent,enable_percent_background:!0,percent_position:l.Z.def.PercentPosition.PercentPositionBottom};n.label=r[i],i++,e.push(n)}},getNumSectionLabelList(e){for(var t=[],a=0;a<e.length;a++)0==a?t.push(`(${l.Z.def.Infinite.InfiniteMin} - ${e[a]})`):a>0&&t.push(`[${e[a-1]} - ${e[a]})`),a==e.length-1&&t.push(`[${e[a]} - ${l.Z.def.Infinite.InfiniteMax})`);return t},datasetToChartDataset(e){var t=e[0],a=!1,r={data:[],sql_timegrain_dim_field:"",sql_breaks:t.breaks,sql_HeaderId:t.grid.HeaderId,sql_metric:[]},i=0;t.analysis_time_range&&t.analysis_time_range.grain&&t.analysis_time_range.grain!=l.Z.def.TimeGrain.GrainMill&&(r.sql_timegrain_dim_field=t.grid.HeaderId[0]),this.addColumnDescForMetrics(r.sql_metric,t);var s=t.breaks.map((e=>e.id)),n=r.sql_metric.map((e=>e.id));for(i=0;i<t.grid.Rows.length;i++){for(var o={},d=0;d<r.sql_HeaderId.length;d++)(r.sql_HeaderId[d]==r.sql_timegrain_dim_field||s.indexOf(r.sql_HeaderId[d])>=0||n.indexOf(r.sql_HeaderId[d])>=0)&&(o[r.sql_HeaderId[d]]=t.grid.Rows[i][d]);r.data.push(o)}return l.Z.utils.SortObjArrayByField(r.data,r.sql_timegrain_dim_field,l.Z.def.BreakSortType.BreakSortTypeDatetime,a),r},GetVisualTypeList(){var e=this.GetChartTypeList();return e.push(l.Z.def.ChartType.getLabelValue(l.Z.def.ChartType.Table)),e},GetChartTypeList(){return l.Z.def.ChartType.GetLabelValueListByValue([l.Z.def.ChartType.Bar,l.Z.def.ChartType.Pie])}},k=a(53013),C={ToTabledata(e){var t=!1,a=this.datasetToTableData(e[0],t),r=l.Z.utils.DeepClone(a);if(e.length>1){var i=this.datasetToTableData(e[1],t),s=l.Z.utils.DeepClone(i),n=this.mergeCompareData(a,i,t);return n.src0=r,n.src1=s,n.vs=!0,n}return a.src0=r,a},mergeCompareData(e,t){var a,r,i=0,s=0,n=new Map,o=l.Z.utils.DeepClone(e);o.data=[];var d=new Map,u=new Map;for(e.data.forEach((t=>{void 0===d.get(t[e.sql_timegrain_dim_field])&&d.set(t[e.sql_timegrain_dim_field],d.size)})),t.data.forEach((e=>{void 0===u.get(e[t.sql_timegrain_dim_field])&&u.set(e[t.sql_timegrain_dim_field],u.size)})),i=0;i<e.data.length;i++){a=e.data[i];var c=d.get(a[e.sql_timegrain_dim_field]),p="";c<u.size&&u.forEach(((e,t)=>{e==c&&(p=t)})),r=String(c);var f={};for(s=0;s<e.columns.length;s++)e.columns[s].field==e.sql_timegrain_dim_field?f[e.columns[s].field]=[a[e.columns[s].field],p]:e.columns[s].sql_dim_type==l.Z.def.SqlDimType.SqlDimTypeMetric?f[e.columns[s].field]=""!=p?[a[e.columns[s].field],0]:[a[e.columns[s].field],""]:(r=k.x64.hash128(String(a[e.columns[s].field])+r),f[e.columns[s].field]=a[e.columns[s].field]);o.data.push(f),n.set(r,f)}for(i=0;i<t.data.length;i++){a=t.data[i],c=u.get(a[t.sql_timegrain_dim_field]);var m="";c<d.size&&d.forEach(((e,t)=>{e==c&&(m=t)})),r=String(c);var h={};for(s=0;s<t.columns.length;s++)t.columns[s].field==t.sql_timegrain_dim_field?h[t.columns[s].field]=[m,a[t.columns[s].field]]:t.columns[s].sql_dim_type==l.Z.def.SqlDimType.SqlDimTypeMetric?h[t.columns[s].field]=""!=m?[0,a[t.columns[s].field]]:["",a[t.columns[s].field]]:(r=k.x64.hash128(String(a[e.columns[s].field])+r),h[t.columns[s].field]=a[t.columns[s].field]);if(f=n.get(r),void 0===f)f=h,o.data.push(f);else for(""!=e.sql_timegrain_dim_field&&(f[t.sql_timegrain_dim_field][1]=a[t.sql_timegrain_dim_field]),s=0;s<t.sql_metric.length;s++)f[t.sql_metric[s].HeaderId][1]=a[t.sql_metric[s].HeaderId]}return o},datasetToTableData(e,t){this.addHeaderIdToBreakMetrics(e);var a={columns:[],data:[],vs:!1,timegrain_at_row:!0,sql_timegrain_dim_field:"",sql_breaks:e.breaks,sql_HeaderId:e.grid.HeaderId,sql_metric:e.metrics},r=0;for(e.grain!=l.Z.def.TimeGrain.GrainMill&&(a.sql_timegrain_dim_field=e.grid.HeaderId[0],this.addColumnDescForTimeGrain(a.columns,e.grid.HeaderId[0])),this.addColumnDescForBreaks(a.columns,e.breaks),this.addColumnDescForMetrics(a.columns,e.metrics),r=0;r<e.grid.Rows.length;r++){for(var i={},s=0;s<a.columns.length;s++)a.columns[s].sql_dim_type==l.Z.def.SqlDimType.SqlDimTypeMetric?i[a.columns[s].field]=Number(e.grid.Rows[r][s]):i[a.columns[s].field]=e.grid.Rows[r][s];a.data.push(i)}return a.sql_timegrain_dim_field&&l.Z.utils.SortObjArrayByField(a.data,a.sql_timegrain_dim_field,l.Z.def.BreakSortType.BreakSortTypeDatetime,t),a},addHeaderIdToBreakMetrics(e){var t=0;e.grain!=l.Z.def.TimeGrain.GrainMill&&(t=1);for(var a=0;a<e.breaks.length;a++)e.breaks[a].HeaderId=e.grid.HeaderId[a+t];for(a=0;a<e.metrics.length;a++)e.metrics[a].HeaderId=e.grid.HeaderId[a+t+e.breaks.length]},addColumnDescForTimeGrain(e,t){e.push({sortable:!0,field:t,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeTimeGrain,type_prop_name:"",label:l.Z.def.TimeGrainDimFieldNameLabel,sort_type:l.Z.def.BreakSortType.BreakSortTypeDatetime,visible:!0})},addColumnDescForBreaks(e,t){for(var a=0;a<t.length;a++)e.push({sortable:!0,field:t[a].HeaderId,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeBreak,type_prop_name:t[a].type_prop_name,label:t[a].label,sort_type:t[a].client_sort_type,visible:!0})},addColumnDescForMetrics(e,t){for(var a=0;a<t.length;a++)e.push({sortable:!0,field:t[a].HeaderId,modifier:t[a].modifier,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeMetric,type_prop_name:t[a].type_prop_name,label:t[a].label,sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,visible:!0})},GetVisualTypeList(e){var t=e[0],a=t.grain!=l.Z.def.TimeGrain.GrainMill,r=t.breaks.length>0,i=e.length>0,s=this.GetChartTypeList(a,r,i);return s.push(l.Z.def.ChartType.getLabelValue(l.Z.def.ChartType.Table)),s},GetChartTypeList(e,t,a){var r=[e,t,a].map((e=>String(e))).join(","),i=new Map;return i.set("true,true,true",["line","cumulative","bar","pie"]),i.set("true,true,false",["line","cumulative","bar","pie"]),i.set("true,false,true",["line","cumulative","bar","pie"]),i.set("true,false,false",["line","cumulative","bar","pie"]),i.set("false,true,true",["bar","pie"]),i.set("false,true,false",["bar","pie"]),i.set("false,false,true",["bar","pie","gauge"]),i.set("false,false,false",["bar","pie","gauge"]),l.Z.def.ChartType.GetLabelValueListByValue(i.get(r))}},B={ToTabledata(e){return this.datasetToTableData(e[0])},datasetToTableData(e){var t={columns:[],data:[],vs:!1,timegrain_at_row:!0,sql_timegrain_dim_field:"",sql_breaks:e.breaks,sql_HeaderId:e.grid.HeaderId},a=0;for(this.addHeaderIdToBreak(e),this.addColumnDescForBreaks(t.columns,e.breaks),this.addColumnDescForMetrics(t.columns,e),a=0;a<e.grid.Rows.length;a++){for(var r={},i=0;i<t.columns.length;i++)t.columns[i].sql_dim_type==l.Z.def.SqlDimType.SqlDimTypeMetric?r[t.columns[i].field]=l.Z.utils.ParseNumberSafe(e.grid.Rows[a][i]):r[t.columns[i].field]=e.grid.Rows[a][i];t.data.push(r)}return this.sortColumnsOfTableData(t),t},sortColumnsOfTableData(e){var t={};t[l.Z.def.SqlDimType.SqlDimTypeTimeGrain]=0,t[l.Z.def.SqlDimType.SqlDimTypeBreak]=1,t[l.Z.def.SqlDimType.SqlDimTypeSummary]=1,t[l.Z.def.SqlDimType.SqlDimTypeMetric]=2,e.columns.sort((function(e,a){return t[e.sql_dim_type]<t[a.sql_dim_type]?-1:t[e.sql_dim_type]>t[a.sql_dim_type]?1:0}))},addHeaderIdToBreak(e){for(var t=0;t<e.breaks.length;t++)e.breaks[t].HeaderId=e.grid.HeaderId[t]},addColumnDescForBreaks(e,t){for(var a=0;a<t.length;a++)e.push({sortable:!0,field:t[a].HeaderId,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeBreak,type_prop_name:t[a].type_prop_name,label:t[a].label,sort_type:t[a].client_sort_type,visible:!0})},addColumnDescForMetrics(e,t){var a={sortable:!0,sql_dim_type:l.Z.def.SqlDimType.SqlDimTypeMetric,field:t.metric.id,id:t.metric.id,label:t.metric.label,sort_type:l.Z.def.BreakSortType.BreakSortTypeNumber,visible:!0};e.push(a)},datasetToChartDataset(e){var t=e[0],a={data:[],sql_timegrain_dim_field:"",sql_breaks:t.breaks,sql_HeaderId:t.grid.HeaderId,sql_metric:[]},r=0;this.addColumnDescForMetrics(a.sql_metric,t);var i=t.breaks.map((e=>e.id)),s=a.sql_metric.map((e=>e.id));for(r=0;r<t.grid.Rows.length;r++){for(var l={},n=0;n<a.sql_HeaderId.length;n++)(i.indexOf(a.sql_HeaderId[n])>=0||s.indexOf(a.sql_HeaderId[n])>=0)&&(l[a.sql_HeaderId[n]]=t.grid.Rows[r][n]);a.data.push(l)}return a},GetVisualTypeList(){var e=this.GetChartTypeList();return e.push(l.Z.def.ChartType.getLabelValue(l.Z.def.ChartType.Table)),e},GetChartTypeList(){return l.Z.def.ChartType.GetLabelValueListByValue([l.Z.def.ChartType.Bar,l.Z.def.ChartType.Pie,l.Z.def.ChartType.Gauge])}},q={ToSankyDataLinks(e){var t,a,r,i,s=e[0],n={data:[],links:[]},o=new Map;return s.forwad_path?(s.grid.Rows.forEach((e=>{r=l.Z.utils.ParseStrSafe(e[0]),i=l.Z.utils.ParseStrSafe(e[1]),a=l.Z.utils.ParseNumberSafe(e[2]),t=o.get(r),void 0===t?this.isEmptyNode(i)?o.set(r,{name:r,depth:this.getDepth(i),value:a,forward:!0,lost:a}):o.set(r,{name:r,depth:this.getDepth(i),value:a,forward:!0,lost:0}):(t.value+=a,this.isEmptyNode(i)&&(t.lost+=a))})),o.forEach((e=>{n.data.push(e)})),s.grid.Rows.forEach((e=>{if(r=l.Z.utils.ParseStrSafe(e[0]),i=l.Z.utils.ParseStrSafe(e[1]),a=l.Z.utils.ParseNumberSafe(e[2]),!this.isEmptyNode(i)){var s={source:r,target:i,value:a,forward:!0};t=o.get(r),void 0!==t&&(s.src=t.value),n.links.push(s)}}))):(s.grid.Rows.forEach((e=>{r=l.Z.utils.ParseStrSafe(e[0]),i=l.Z.utils.ParseStrSafe(e[1]),a=l.Z.utils.ParseNumberSafe(e[2]),t=o.get(i),void 0===t?this.isEmptyNode(r)?o.set(i,{name:i,depth:this.getDepth(r),value:a,forward:!1,input:a}):o.set(i,{name:i,depth:this.getDepth(r),value:a,forward:!1,input:0}):(t.value+=a,this.isEmptyNode(r)&&(t.input+=a))})),o.forEach((e=>{n.data.push(e)})),s.grid.Rows.forEach((e=>{if(r=l.Z.utils.ParseStrSafe(e[0]),i=l.Z.utils.ParseStrSafe(e[1]),a=l.Z.utils.ParseNumberSafe(e[2]),!this.isEmptyNode(r)){var s={source:r,target:i,value:a,forward:!1};t=o.get(r),void 0!==t&&(s.src=t.value),n.links.push(s)}}))),n},isEmptyNode(e){var t=l.Z.utils.IsEmptyStr(e.slice(e.indexOf(",")+1));return t},getDepth(e){return l.Z.utils.ParseNumberSafe(e.split(",")[0])},GetVisualTypeList(){return this.GetChartTypeList()},GetChartTypeList(){return l.Z.def.ChartType.GetLabelValueListByValue([l.Z.def.ChartType.Sanky])}};class x{constructor(e){this.actualZoneDate1=_()().toDate(),this.actualZoneDate2=_()().toDate(),this.dynamicOffset1=0,this.dynamicOffset2=0,e&&(e.quick_range?(this.quickPick=e.quick_range,this.initQuickRange(this.quickPick)):(e.start_dynamic?(this.dynamicTime1=!0,(0,p.isNumber)(e.start_offset)&&(this.dynamicOffset1=-e.start_offset,this.actualZoneDate1=_()().add(-this.dynamicOffset1,"day").toDate())):e.start_time&&(this.actualZoneDate1=_()(e.start_time).toDate()),e.end_dynamic?(this.dynamicTime2=!0,(0,p.isNumber)(e.end_offset)&&(this.dynamicOffset2=-e.end_offset,this.actualZoneDate2=_()().add(-this.dynamicOffset2,"day").toDate())):e.start_time&&(this.actualZoneDate2=_()(e.end_time).toDate())))}initQuickRange(e){e==l.Z.def.QuickTimePick.Yesterday?this.onClick_yesterday():e==l.Z.def.QuickTimePick.Today?this.onClick_today():e==l.Z.def.QuickTimePick.Last7day?this.onClick_last7day():e==l.Z.def.QuickTimePick.Last30day?this.onClick_last30day():e==l.Z.def.QuickTimePick.Last60day?this.onClick_last60day():e==l.Z.def.QuickTimePick.This7day?this.onClick_7day():e==l.Z.def.QuickTimePick.This30day?this.onClick_30day():e==l.Z.def.QuickTimePick.This60day?this.onClick_60day():e==l.Z.def.QuickTimePick.ThisWeek?this.onClick_ThisWeek():e==l.Z.def.QuickTimePick.LastWeek?this.onClick_LastWeek():e==l.Z.def.QuickTimePick.ThisMonth?this.onClick_ThisMonth():e==l.Z.def.QuickTimePick.LastMonth?this.onClick_LastMonth():e==l.Z.def.QuickTimePick.ThisYear?this.onClick_ThisYear():e==l.Z.def.QuickTimePick.LastYear&&this.onClick_LastYear()}onClick_yesterday(){this.quickPick=l.Z.def.QuickTimePick.Today,this.actualZoneDate2=_()().add(-1,"day").toDate(),this.actualZoneDate1=_()().add(-1,"day").toDate(),this.dynamicOffset1=1,this.dynamicOffset2=1}onClick_today(){this.quickPick=l.Z.def.QuickTimePick.Today,this.actualZoneDate2=_()().toDate(),this.actualZoneDate1=_()().toDate(),this.dynamicOffset1=0,this.dynamicOffset2=0}onClick_last7day(){this.quickPick=l.Z.def.QuickTimePick.Last7day,this.actualZoneDate2=_()().add(-1,"day").toDate(),this.actualZoneDate1=_()().add(-7,"day").toDate(),this.dynamicOffset1=7,this.dynamicOffset2=1}onClick_last30day(){this.quickPick=l.Z.def.QuickTimePick.Last30day,this.actualZoneDate2=_()().toDate(),this.actualZoneDate2=_()().add(-1,"day").toDate(),this.actualZoneDate1=_()().add(-30,"day").toDate(),this.dynamicOffset1=30,this.dynamicOffset2=1}onClick_last60day(){this.quickPick=l.Z.def.QuickTimePick.Last60day,this.actualZoneDate2=_()().toDate(),this.actualZoneDate2=_()().add(-1,"day").toDate(),this.actualZoneDate1=_()().add(-60,"day").toDate(),this.dynamicOffset1=60,this.dynamicOffset2=1}onClick_7day(){this.quickPick=l.Z.def.QuickTimePick.This7day,this.actualZoneDate2=_()().toDate(),this.actualZoneDate1=_()().add(-6,"day").toDate(),this.dynamicOffset1=6,this.dynamicOffset2=0}onClick_30day(){this.quickPick=l.Z.def.QuickTimePick.This30day,this.actualZoneDate2=_()().toDate(),this.actualZoneDate1=_()().add(-29,"day").toDate(),this.dynamicOffset1=29,this.dynamicOffset2=0}onClick_60day(){this.quickPick=l.Z.def.QuickTimePick.This60day,this.actualZoneDate2=_()().toDate(),this.actualZoneDate1=_()().add(-59,"day").toDate(),this.dynamicOffset1=59,this.dynamicOffset2=0}onClick_ThisWeek(){this.quickPick=l.Z.def.QuickTimePick.ThisWeek,this.actualZoneDate2=_()().toDate(),0===_()(this.actualZoneDate2).day()?this.actualZoneDate1=_()(this.actualZoneDate2).add(-7,"day").day("Monday").toDate():this.actualZoneDate1=_()(this.actualZoneDate2).day("Monday").toDate(),this.dynamicOffset1=_()().diff(_()(this.actualZoneDate1),"day"),this.dynamicOffset2=0}onClick_LastWeek(){this.quickPick=l.Z.def.QuickTimePick.LastWeek,this.actualZoneDate2=_()().toDate(),0===_()(this.actualZoneDate2).day()?this.actualZoneDate2=_()(this.actualZoneDate2).add(-1,"day").day("Sunday").toDate():this.actualZoneDate2=_()(this.actualZoneDate2).day("Sunday").toDate(),this.actualZoneDate1=_()(this.actualZoneDate2).add(-7,"day").day("Monday").toDate(),this.dynamicOffset1=_()().diff(_()(this.actualZoneDate1),"day"),this.dynamicOffset2=_()().diff(_()(this.actualZoneDate2),"day")}onClick_ThisMonth(){this.quickPick=l.Z.def.QuickTimePick.ThisMonth,this.actualZoneDate2=_()().toDate(),this.actualZoneDate1=_()(this.actualZoneDate2).add(1-this.actualZoneDate2.getDate(),"day").toDate(),this.dynamicOffset1=_()().diff(_()(this.actualZoneDate1),"day"),this.dynamicOffset2=_()().diff(_()(this.actualZoneDate2),"day")}onClick_LastMonth(){this.quickPick=l.Z.def.QuickTimePick.LastMonth,this.actualZoneDate2=_()().toDate();var e=_()(this.actualZoneDate2).add(-1,"month").format("YYYY-MM")+"-01",t=_()(this.actualZoneDate2).format("YYYY-MM")+"-01";this.actualZoneDate1=_()(e,"YYYY-MM-DD").toDate(),this.actualZoneDate2=_()(t,"YYYY-MM-DD").add(-1,"day").toDate(),this.dynamicOffset1=_()().diff(_()(this.actualZoneDate1),"day"),this.dynamicOffset2=_()().diff(_()(this.actualZoneDate2),"day")}onClick_ThisYear(){this.quickPick=l.Z.def.QuickTimePick.ThisYear,this.actualZoneDate2=_()().toDate();var e=_()(this.actualZoneDate2).format("YYYY")+"-01-01";this.actualZoneDate1=_()(e,"YYYY-MM-DD").toDate(),this.dynamicOffset1=_()().diff(_()(this.actualZoneDate1),"day"),this.dynamicOffset2=_()().diff(_()(this.actualZoneDate2),"day")}onClick_LastYear(){this.quickPick=l.Z.def.QuickTimePick.LastYear,this.actualZoneDate2=_()().toDate();var e=_()(this.actualZoneDate2).add(-1,"year").format("YYYY")+"-01-01",t=_()(this.actualZoneDate2).format("YYYY")+"-01-01";this.actualZoneDate1=_()(e,"YYYY-MM-DD").toDate(),this.actualZoneDate2=_()(t,"YYYY-MM-DD").add(-1,"day").toDate(),this.dynamicOffset1=_()().diff(_()(this.actualZoneDate1),"day"),this.dynamicOffset2=_()().diff(_()(this.actualZoneDate2),"day")}}var w={Duration(e,t){var a=new x(e);return _()(a.actualZoneDate2).diff(_()(a.actualZoneDate1),t)}},I=a(59172),M=a.n(I),E={Build(e){var t=e.data,a=e.links,r=function(e){var t=e.data.name.slice(e.data.name.indexOf(",")+1);return t};return l.Z.utils.IsEmptyArray(t)?(t=[],l.Z.utils.OptionGraphEmtpy({})):(t.forEach((e=>{l.Z.utils.IsEmptyObj(e.label)&&(e.label={position:"inside"}),delete e.depth,e.label.formatter=r})),l.Z.utils.IsEmptyArray(a)&&(a=[]),{series:[{top:"2%",right:50,left:"2%",layoutIterations:0,type:"sankey",name:"sankey",nodeGap:5,nodeWidth:100,draggable:!1,focusNodeAdjacency:"allEdges",itemStyle:{color:"#409EFF"},emphasis:{focus:"adjacency"},lineStyle:{color:"gradient"},data:t,links:a}],tooltip:{show:!0,trigger:"item",triggerOn:"mousemove|click",axisPointer:{type:"line"},textStyle:{fontSize:14},borderWidth:0,formatter:function(e){if(e.data.forward){if("node"==e.dataType){var t=e.data.lost,a=e.value-e.data.lost,r=Math.round(100*t/e.value),i=Math.round(100*a/e.value),s=e.name.slice(e.name.indexOf(",")+1),n=M()(l.Z.utils.ParseNumberSafe(t)).format({thousandSeparated:!0}),o=M()(l.Z.utils.ParseNumberSafe(a)).format({thousandSeparated:!0});return`<table>\n                            <tr><td colspan="3">${s}</td></tr>\n                            <tr><td >留存</td><td ><div style="width:90px"></div></td><td >${o}(${i}%)</td></tr>\n                            <tr><td >流失</td><td ></td><td >${n}(${r}%)</td></tr>\n                            </table>`}if("edge"==e.dataType){i=Math.round(100*e.value/e.data.src);var d=e.data.source.slice(e.data.source.indexOf(",")+1),u=e.data.target.slice(e.data.target.indexOf(",")+1);return o=M()(l.Z.utils.ParseNumberSafe(e.value)).format({thousandSeparated:!0}),`<table>\n                            <tr><td colspan="3">${d} 到 ${u}</td></tr>\n                            <tr><td >留存</td><td ><div style="width:90px"></div></td><td >${o}(${i}%)</td></tr>\n                            </table>`}return`${e.name}：${e.value}`}if("node"==e.dataType){var c=e.data.input;a=e.value-e.data.input;var p=Math.round(100*c/e.value);i=Math.round(100*a/e.value),s=e.name.slice(e.name.indexOf(",")+1);var f=M()(l.Z.utils.ParseNumberSafe(e.data.input)).format({thousandSeparated:!0});return o=M()(l.Z.utils.ParseNumberSafe(a)).format({thousandSeparated:!0}),`<table>\n                            <tr><td colspan="3">${s}</td></tr>\n                            <tr><td >留存</td><td ><div style="width:90px"></div></td><td >${o}(${i}%)</td></tr>\n                            <tr><td >流入</td><td ></td><td >${f}(${p}%)</td></tr>\n                            </table>`}if("edge"==e.dataType)return i=Math.round(100*e.value/e.data.src),d=e.data.source.slice(e.data.source.indexOf(",")+1),u=e.data.target.slice(e.data.target.indexOf(",")+1),o=M()(l.Z.utils.ParseNumberSafe(e.value)).format({thousandSeparated:!0}),`<table>\n                            <tr><td colspan="3">${d} 到 ${u}</td></tr>\n                            <tr><td >留存</td><td ><div style="width:90px"></div></td><td >${o}</td></tr>\n                            <tr><td >源占比</td><td ><div style="width:90px"></div></td><td >${i}%</td></tr>\n                            </table>`;var m=M()(l.Z.utils.ParseNumberSafe(e.value)).format({thousandSeparated:!0});return`${e.name}：${m}`}}})},ExampleOption(){var e=[{label:{position:"inside"},name:"app_open",depth:0,value:400,lost:11},{label:{position:"inside"},name:"hello",depth:1,lost:11},{label:{position:"inside"},name:"buy",lost:11},{label:{position:"inside"},name:"build",lost:11}],t=[{source:"app_open",target:"hello",value:20,src:400},{source:"app_open",target:"buy",value:10,src:400},{source:"app_open",target:"build",value:5,src:400},{source:"hello",target:"buy",value:2,src:20},{source:"hello",target:"build",value:1,src:20}];return this.Build(e,t)}},N={max_gauge:4,max_default_value:100,Build(e,t){if(!l.Z.utils.IsEmptyArray(e)){var a={gaugeOption:t,tooltip:{formatter:function(e){var t=Math.round(100*e.data.value/e.data.max);return`${e.data.name}: ${t}%`}},series:[]},r=e[0];if(0==r.source.length)return l.Z.utils.OptionGraphEmtpy(a);l.Z.utils.IsEmptyObj(t)&&(t=this.getDefaultCustomOption(r));for(var i=0;i<t.title.length;i++)a.series.push(this.newSeries(r.source[0],t.valueDim[i],t.title[i],t.max[i],t.modifier));return this.reArragePostion(a,t.size),a}e=[]},getDefaultCustomOption(e){var t={grid:{left:40,right:30,bottom:30},valueDim:[],max:[],enableCompare:!1,title:[],size:"medium",modifier:l.Z.def.ModifierType.ModifierTypeRound};if(e.metrics.forEach((e=>{t.valueDim.push(e.dim)})),t.valueDim=t.valueDim.slice(0,this.max_gauge),t.title=l.Z.utils.DeepClone(t.valueDim),t.max=l.Z.utils.DeepClone(t.valueDim).fill(this.max_default_value),1==e.srcCount)t.enableCompare=!1;else if(e.srcCount>1){t.enableCompare=!0;var a=e.source.filter((e=>1==e[l.Z.def.ChartSrcIndexCol]));a.length>0&&(t.max=[],t.valueDim.forEach((e=>{t.max.push(a[0][e])})))}return t},reArragePostion(e,t){e.series.forEach((a=>{"medium"==t?a.radius="75%":(a.radius="55%",e.series.length>2&&(a.axisLabel={show:!1}),e.series.length>3&&(a.splitLine={show:!1}))})),2==e.series.length?(e.series[0].center=["25%","50%"],e.series[1].center=["75%","50%"]):3==e.series.length?(e.series[0].center=["16.7%","50%"],e.series[1].center=["50%","50%"],e.series[2].center=["83.3%","50%"]):4==e.series.length&&(e.series[0].center=["12.5%","50%"],e.series[1].center=["37.5%","50%"],e.series[2].center=["62.5%","50%"],e.series[3].center=["87.5%","50%"])},newSeries(e,t,a,r,i){return{type:"gauge",center:["50%","50%"],left:10,top:20,right:10,bottom:20,radius:"70%",max:r,title:{offsetCenter:["0%","60%"]},detail:{offsetCenter:["0%","95%"]},progress:{show:!0,width:2},axisLine:{lineStyle:{width:2}},data:[{value:l.Z.def.ModifierType.getModifierValue(e[t],i),max:r,name:a}]}},ExampleData1(){var e={data:[{value:100,max:250,name:"SCORE"},{value:30,max:150,name:"SCORE"},{value:30,max:150,name:"SCORE"}]};return e},ExampleData(){var e={dimensions:["_src","_date","事件总次数"],source:[{_src:0,_date:"2023-08-26","事件总次数":70},{_src:0,_date:"2023-08-27","事件总次数":111},{_src:0,_date:"2023-08-28","事件总次数":60},{_src:0,_date:"2023-08-29","事件总次数":71},{_src:0,_date:"2023-08-30","事件总次数":30},{_src:0,_date:"2023-08-31","事件总次数":20},{_src:0,_date:"2023-09-01","事件总次数":140},{_src:0,_date:"2023-09-02","事件总次数":1},{_src:1,_date:"2023-09-03","事件总次数":0},{_src:1,_date:"2023-09-04","事件总次数":20},{_src:1,_date:"2023-09-05","事件总次数":60},{_src:1,_date:"2023-09-06","事件总次数":100},{_src:1,_date:"2023-09-07","事件总次数":60},{_src:1,_date:"2023-09-08","事件总次数":140},{_src:1,_date:"2023-09-09","事件总次数":110}],hasDate:!0,breaks:[],metrics:[{HeaderId:"A",label:"事件总次数",dim:"事件总次数"}],srcCount:1};return this.Build([e])}},O={Build(e,t){l.Z.utils.IsEmptyObj(t)&&(t={unitY:""});var a={grid:{left:100,right:30,bottom:30},dataset:e,xAxis:{type:"category"},legend:{data:[]},yAxis:{},series:[]};l.Z.utils.IsEmptyStr(t.unitY)||(a.yAxis={type:"value",axisLabel:{formatter:"{value}"+t.unitY}});var r=e[0];if(r.hasDate){if(0==r.source.length)return l.Z.utils.OptionGraphEmtpy(a);this.sortData(r),(0,p.isArray)(r.source[0][l.Z.def.ChartDateCol])&&r.source.forEach((e=>{e[l.Z.def.ChartDateCol]=e[l.Z.def.ChartDateCol][0]+"\n"+e[l.Z.def.ChartDateCol].slice(1).join(",")}));var i=this.getTransforms(r),s={type:"dashed"},n={type:"solid"};return i.forEach((t=>{e.push({transform:t.transform}),r.metrics.forEach((r=>{var i=r.label;l.Z.utils.IsEmptyStr(t.breakValueStr)||(i+="."+t.breakValueStr),a.series.push({type:"line",name:i,encode:{x:l.Z.def.ChartDateCol,y:r.dim},lineStyle:0==t.srcIndex?n:s,datasetIndex:e.length-1}),a.legend.data.push(i)}))})),a.legend.data=l.Z.utils.DeduplicatedList(a.legend.data),this.setTooltip(a,t),a}console.log("error: chart line must have datetime dimension")},sortData(e){e.hasDate?l.Z.utils.SortObjArrayByFieldList(e.source,[l.Z.def.ChartDateCol],[l.Z.def.BreakSortType.BreakSortTypeDatetime],[!1]):console.log("sortData error: chart line must have datetime dimension")},getTransforms(e){var t=[];if(e.hasDate){var a=new Map;return e.source.forEach((e=>{var r=l.Z.utils.ParseStrSafe(e[l.Z.def.ChartBreaksCol]),i=e[l.Z.def.ChartSrcIndexCol],s={src:i,breaks:r},n=JSON.stringify(s),o=a.get(n);if(void 0===o){a.set(n,s);var d={transform:{type:"filter"},datasetIndex:a.size,categoryHeaderId:l.Z.def.ChartDateCol,breakValueStr:r,srcIndex:i};l.Z.utils.IsEmptyStr(r)?d.transform.config={dimension:l.Z.def.ChartSrcIndexCol,"=":i}:d.transform.config={and:[{dimension:l.Z.def.ChartBreaksCol,"=":r},{dimension:l.Z.def.ChartSrcIndexCol,"=":i}]},t.push(d)}})),t}l.Z.utils.Ignore("未实现")},setTooltip(e,t){var a=l.Z.utils.ParseStrSafe(t.unitY);e.tooltip={trigger:"axis",show:!0,transitionDuration:1,enterable:!0,formatter:function(e){var t=new Map;e.forEach((e=>{var a=t.get(e.seriesName);void 0===a&&(a={metricName:e.seriesName,date0:"",color0:"",date1:"",value0:"",color1:"",value1:""}),0==e.data[l.Z.def.ChartSrcIndexCol]?(a.date0=e.data[l.Z.def.ChartDateCol].split("\n")[0],a.color0=e.color,a.value0=e.data[e.dimensionNames[e.encode.y[0]]]):(a.date1=e.data[l.Z.def.ChartDateCol].split("\n")[1],a.color1=e.color,a.value1=e.data[e.dimensionNames[e.encode.y[0]]]),t.set(e.seriesName,a)}));var r='<div style="overflow-x: auto; overflow-y: auto; max-height: 150px;padding:5px"><table>';return t.forEach((e=>{if(r+=`<tr><td colspan="3">${e.metricName}</td></tr>`,!l.Z.utils.IsEmptyStr(e.date0)){var t=M()(l.Z.utils.ParseNumberSafe(e.value0)).format({thousandSeparated:!0});r+=`<tr><td >${e.date0}</td><td style="padding:8px;"><div style="height:1px;width:50px;border-style:solid; color:${e.color0}"></div></td><td >${t}${a}</td></tr>`}if(!l.Z.utils.IsEmptyStr(e.date1)){var i=M()(l.Z.utils.ParseNumberSafe(e.value1)).format({thousandSeparated:!0});r+=`<tr><td >${e.date1}</td><td style="padding:8px;"><div style="height:1px;width:50px;border-style:dashed; color:${e.color1}"></div></td><td >${i}${a}</td></tr>`}})),r+"</table></div>"}}},ExampleData(){var e={dimensions:["_src","_date","事件总次数"],source:[{_src:0,_date:"2023-08-26","事件总次数":70},{_src:0,_date:"2023-08-27","事件总次数":111},{_src:0,_date:"2023-08-28","事件总次数":60},{_src:0,_date:"2023-08-29","事件总次数":71},{_src:0,_date:"2023-08-30","事件总次数":30},{_src:0,_date:"2023-08-31","事件总次数":20},{_src:0,_date:"2023-09-01","事件总次数":140},{_src:0,_date:"2023-09-02","事件总次数":1},{_src:0,_date:"2023-09-03","事件总次数":0},{_src:0,_date:"2023-09-04","事件总次数":20},{_src:0,_date:"2023-09-05","事件总次数":60},{_src:0,_date:"2023-09-06","事件总次数":100},{_src:0,_date:"2023-09-07","事件总次数":60},{_src:0,_date:"2023-09-08","事件总次数":140},{_src:0,_date:"2023-09-09","事件总次数":110}],hasDate:!0,breaks:[],metrics:[{HeaderId:"A",label:"事件总次数",dim:"事件总次数"}],srcCount:1};return this.Build([e])}},P=a(53013),L={Build(e,t){l.Z.utils.IsEmptyObj(t)&&(t={unitY:""});var a={grid:{left:100,right:30,bottom:30},dataset:e,xAxis:{type:"category"},legend:{data:[]},yAxis:{},series:[]};l.Z.utils.IsEmptyStr(t.unitY)||(a.yAxis={type:"value",axisLabel:{formatter:"{value}"+t.unitY}});var r=e[0];if(r.hasDate){if(0==r.source.length)return l.Z.utils.OptionGraphEmtpy(a);this.sortData(r),this.cumulateMetric(r),(0,p.isArray)(r.source[0][l.Z.def.ChartDateCol])&&r.source.forEach((e=>{e[l.Z.def.ChartDateCol]=e[l.Z.def.ChartDateCol][0]+"\n"+e[l.Z.def.ChartDateCol].slice(1).join(",")}));var i=this.getTransforms(r),s={type:"dashed"},n={type:"solid"};return i.forEach((t=>{e.push({transform:t.transform}),r.metrics.forEach((r=>{var i=r.label;l.Z.utils.IsEmptyStr(t.breakValueStr)||(i+="."+t.breakValueStr),a.series.push({type:"line",name:i,encode:{x:l.Z.def.ChartDateCol,y:r.dim},lineStyle:0==t.srcIndex?n:s,datasetIndex:e.length-1}),a.legend.data.push(i)}))})),a.legend.data=l.Z.utils.DeduplicatedList(a.legend.data),this.setTooltip(a,t),a}console.log("error: chart line must have datetime dimension")},sortData(e){e.hasDate?l.Z.utils.SortObjArrayByFieldList(e.source,[l.Z.def.ChartDateCol],[l.Z.def.BreakSortType.BreakSortTypeDatetime],[!1]):console.log("sortData error: chart line must have datetime dimension")},cumulateMetric(e){if(e.source)for(var t=new Map,a=0;a<e.source.length;a++)for(var r=e.source[a],i=P.x64.hash128(String(r[l.Z.def.ChartSrcIndexCol])),s=0;s<e.metrics.length;s++){var n=e.metrics[s],o=P.x64.hash128(String(i+n.dim)),d=t.get(o);r[n.dim]=r[n.dim]+l.Z.utils.ParseNumberSafe(d),t.set(o,r[n.dim])}},getTransforms(e){var t=[];if(e.hasDate){var a=new Map;return e.source.forEach((e=>{var r=l.Z.utils.ParseStrSafe(e[l.Z.def.ChartBreaksCol]),i=e[l.Z.def.ChartSrcIndexCol],s={src:i,breaks:r},n=JSON.stringify(s),o=a.get(n);if(void 0===o){a.set(n,s);var d={transform:{type:"filter"},datasetIndex:a.size,categoryHeaderId:l.Z.def.ChartDateCol,breakValueStr:r,srcIndex:i};l.Z.utils.IsEmptyStr(r)?d.transform.config={dimension:l.Z.def.ChartSrcIndexCol,"=":i}:d.transform.config={and:[{dimension:l.Z.def.ChartBreaksCol,"=":r},{dimension:l.Z.def.ChartSrcIndexCol,"=":i}]},t.push(d)}})),t}l.Z.utils.Ignore("未实现")},setTooltip(e,t){var a=l.Z.utils.ParseStrSafe(t.unitY);e.tooltip={trigger:"axis",show:!0,transitionDuration:1,enterable:!0,formatter:function(e){var t=new Map;e.forEach((e=>{var a=t.get(e.seriesName);void 0===a&&(a={metricName:e.seriesName,date0:"",color0:"",date1:"",value0:"",color1:"",value1:""}),0==e.data[l.Z.def.ChartSrcIndexCol]?(a.date0=e.data[l.Z.def.ChartDateCol].split("\n")[0],a.color0=e.color,a.value0=e.data[e.dimensionNames[e.encode.y[0]]]):(a.date1=e.data[l.Z.def.ChartDateCol].split("\n")[1],a.color1=e.color,a.value1=e.data[e.dimensionNames[e.encode.y[0]]]),t.set(e.seriesName,a)}));var r='<div style="overflow-x: auto; overflow-y: auto; max-height: 150px;padding:5px"><table>';return t.forEach((e=>{if(r+=`<tr><td colspan="3">${e.metricName}</td></tr>`,!l.Z.utils.IsEmptyStr(e.date0)){var t=M()(l.Z.utils.ParseNumberSafe(e.value0)).format({thousandSeparated:!0});r+=`<tr><td >${e.date0}</td><td style="padding:8px;"><div style="height:1px;width:50px;border-style:solid; color:${e.color0}"></div></td><td >${t}${a}</td></tr>`}if(!l.Z.utils.IsEmptyStr(e.date1)){var i=M()(l.Z.utils.ParseNumberSafe(e.value1)).format({thousandSeparated:!0});r+=`<tr><td >${e.date1}</td><td style="padding:8px;"><div style="height:1px;width:50px;border-style:dashed; color:${e.color1}"></div></td><td >${i}${a}</td></tr>`}})),r+"</table></div>"}}},ExampleData(){var e={dimensions:["_src","_date","事件总次数"],source:[{_src:0,_date:"2023-08-26","事件总次数":70},{_src:0,_date:"2023-08-27","事件总次数":111},{_src:0,_date:"2023-08-28","事件总次数":60},{_src:0,_date:"2023-08-29","事件总次数":71},{_src:0,_date:"2023-08-30","事件总次数":30},{_src:0,_date:"2023-08-31","事件总次数":20},{_src:0,_date:"2023-09-01","事件总次数":140},{_src:0,_date:"2023-09-02","事件总次数":1},{_src:0,_date:"2023-09-03","事件总次数":0},{_src:0,_date:"2023-09-04","事件总次数":20},{_src:0,_date:"2023-09-05","事件总次数":60},{_src:0,_date:"2023-09-06","事件总次数":100},{_src:0,_date:"2023-09-07","事件总次数":60},{_src:0,_date:"2023-09-08","事件总次数":140},{_src:0,_date:"2023-09-09","事件总次数":110}],hasDate:!0,breaks:[],metrics:[{HeaderId:"A",label:"事件总次数",dim:"事件总次数"}],srcCount:1};return this.Build([e])}},A={custom_total:"总计",Build(e,t){l.Z.utils.IsEmptyObj(t)&&(t={});var a={grid:{left:100,right:30,bottom:30},dataset:e,xAxis:{type:"category"},legend:{data:[]},yAxis:{},series:[]},r=e[0];return 0==r.source.length?l.Z.utils.OptionGraphEmtpy(a):(this.sortData(r),r.srcCount>1?(r.hasDate&&(0,p.isArray)(r.source[0][l.Z.def.ChartDateCol])&&r.source.forEach((e=>{e[l.Z.def.ChartDateCol]=e[l.Z.def.ChartDateCol][0]+"\n"+e[l.Z.def.ChartDateCol].slice(1).join(",")})),e.push({transform:{type:"filter",config:{dimension:l.Z.def.ChartSrcIndexCol,"=":0}}}),e.push({transform:{type:"filter",config:{dimension:l.Z.def.ChartSrcIndexCol,"=":1}}}),r.hasDate?(r.metrics.forEach((e=>{this.newSeriesBar(a,e.label,l.Z.def.ChartDateCol,e.dim,1,30)})),r.metrics.forEach((e=>{this.newSeriesBar(a,e.label,l.Z.def.ChartDateCol,e.dim,2,10),this.newSeriesPictorialBar(a,e.label,l.Z.def.ChartDateCol,e.dim,2,30)}))):r.hasBreak?(r.metrics.forEach((e=>{this.newSeriesBar(a,e.label,l.Z.def.ChartBreaksCol,e.dim,1,30)})),r.metrics.forEach((e=>{this.newSeriesBar(a,e.label,l.Z.def.ChartBreaksCol,e.dim,2,10),this.newSeriesPictorialBar(a,e.label,l.Z.def.ChartBreaksCol,e.dim,2,30)}))):(r.metrics.forEach((e=>{this.newSeriesBar(a,e.label,"",e.dim,1,30)})),r.metrics.forEach((e=>{this.newSeriesBar(a,e.label,"",e.dim,2,10),this.newSeriesPictorialBar(a,e.label,"",e.dim,2,30)})))):(e.push({transform:{type:"filter",config:{dimension:l.Z.def.ChartSrcIndexCol,"=":0}}}),r.hasDate?r.metrics.forEach((e=>{this.newSeriesBar(a,e.label,l.Z.def.ChartDateCol,e.dim,1,30)})):r.hasBreak?r.metrics.forEach((e=>{this.newSeriesBar(a,e.label,l.Z.def.ChartBreaksCol,e.dim,1,30)})):r.metrics.forEach((e=>{this.newSeriesBar(a,e.label,"",e.dim,1,30)}))),a.series.forEach((e=>{a.legend.data.push(e.name)})),a.legend.data=l.Z.utils.DeduplicatedList(a.legend.data),this.setTooltip(a),a)},newSeriesBar(e,t,a,r,i,s){e.series.push({type:"bar",name:t,barGap:"50%",encode:{x:a,y:r},z:s,datasetIndex:i})},newSeriesPictorialBar(e,t,a,r,i,s){e.series.push({type:"pictorialBar",name:t,symbol:"path://M0,1000L0,950L200,0L200,50z",symbolRepeat:"fixed",symbolClip:!0,symbolSize:["100%",10],symbolOffset:[0,5],barGap:"50%",itemStyle:{color:"rgba(250,250,250,0.6)",opacity:.7},encode:{x:a,y:r},z:s,datasetIndex:i,tooltip:{show:!1}})},sortData(e){e.hasDate?l.Z.utils.SortObjArrayByFieldList(e.source,[l.Z.def.ChartDateCol],[l.Z.def.BreakSortType.BreakSortTypeDatetime],[!1]):e.dimensions.indexOf(l.Z.def.ChartBreaksCol)>=0?l.Z.utils.SortObjArrayByFieldList(e.source,[l.Z.def.ChartBreaksCol],[l.Z.def.BreakSortType.BreakSortTypeString],[!1]):e.dimensions.indexOf(l.Z.def.ChartBreaksCol)<0&&(e.dimensions.push(l.Z.def.ChartBreaksCol),e.source.forEach((e=>{e[l.Z.def.ChartBreaksCol]=this.custom_total})))},setTooltip(e){e.tooltip={trigger:"axis",show:!0,transitionDuration:1,enterable:!0,formatter:function(e){var t=new Map;e.forEach((e=>{var a=t.get(e.seriesName);void 0===a&&(a={metricName:e.seriesName,date0:"",color0:"",date1:"",value0:"",color1:"",value1:""}),0==e.data[l.Z.def.ChartSrcIndexCol]?(e.dimensionNames.indexOf(l.Z.def.ChartDateCol)>=0?a.date0=e.data[l.Z.def.ChartDateCol].split("\n")[0]:e.dimensionNames.indexOf(l.Z.def.ChartBreaksCol)?a.date0=e.data[l.Z.def.ChartBreaksCol]:a.date0="",a.color0=e.color,a.value0=e.data[e.dimensionNames[e.encode.y[0]]]):(e.dimensionNames.indexOf(l.Z.def.ChartDateCol)>=0?a.date1=e.data[l.Z.def.ChartDateCol].split("\n")[1]:e.dimensionNames.indexOf(l.Z.def.ChartBreaksCol)?a.date1=e.data[l.Z.def.ChartBreaksCol]:a.date1="",a.color1=e.color,a.value1=e.data[e.dimensionNames[e.encode.y[0]]]),t.set(e.seriesName,a)}));var a='<div style="overflow-x: auto; overflow-y: auto; max-height: 150px;padding:5px"><table>';return t.forEach((e=>{if(a+=`<tr><td colspan="3">${e.metricName}</td></tr>`,!l.Z.utils.IsEmptyStr(e.date0)){var t=M()(l.Z.utils.ParseNumberSafe(e.value0)).format({thousandSeparated:!0});a+=`<tr><td >${e.date0}</td><td style="padding:8px;"><div style="height:1px;width:50px;border-style:solid; color:${e.color0}"></div></td><td >${t}</td></tr>`}if(!l.Z.utils.IsEmptyStr(e.date1)){var r=M()(l.Z.utils.ParseNumberSafe(e.value1)).format({thousandSeparated:!0});a+=`<tr><td >${e.date1}</td><td style="padding:8px;"><div style="height:1px;width:50px;border-style:dashed; color:${e.color0}"></div></td><td >${r}</td></tr>`}})),a+"</table></div>"}}},ExampleData(){var e={dimensions:["_src","_date","事件总次数"],source:[{_src:0,_date:"2023-08-26","事件总次数":50},{_src:0,_date:"2023-08-27","事件总次数":111},{_src:0,_date:"2023-08-28","事件总次数":60},{_src:0,_date:"2023-08-29","事件总次数":71},{_src:0,_date:"2023-08-30","事件总次数":30},{_src:0,_date:"2023-08-31","事件总次数":20},{_src:0,_date:"2023-09-01","事件总次数":140},{_src:0,_date:"2023-09-02","事件总次数":1},{_src:0,_date:"2023-09-03","事件总次数":0},{_src:0,_date:"2023-09-04","事件总次数":20},{_src:0,_date:"2023-09-05","事件总次数":60},{_src:0,_date:"2023-09-06","事件总次数":100},{_src:0,_date:"2023-09-07","事件总次数":60},{_src:0,_date:"2023-09-08","事件总次数":140},{_src:0,_date:"2023-09-09","事件总次数":110}],hasDate:!0,breaks:[],metrics:[{id:"A",label:"事件总次数",dim:"事件总次数"}],srcCount:1};return this.Build([e])}},F={Build(e,t){if(l.Z.utils.IsEmptyArray(e))return e=[],void console.log("source dataset is an emtpy array");var a=e[0],r={grid:{left:80,right:30,bottom:30},pieOption:t,tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},title:[],series:[]};if(0==a.source.length)return l.Z.utils.OptionGraphEmtpy(r);var i=this.getBreakMetricInfo(a);return i.forEach((e=>{this.newSeries(r,e,a.srcCount>1)})),this.reArragePostion(r,a),this.setTooltip(r),r},setTooltip(e){e.tooltip={trigger:"item",show:!0,transitionDuration:1,enterable:!0,formatter:function(e){var t='<div style="overflow-x: auto; overflow-y: auto; max-height: 150px;padding:5px"><table>';if(t+=`<tr><td colspan="3">${e.data.name}</td></tr>`,!l.Z.utils.IsEmptyStr(e.data.value)){var a=M()(l.Z.utils.ParseNumberSafe(e.data.value)).format({thousandSeparated:!0});t+=`<tr><td ></td><td style="padding:8px;"><div style="height:1px;width:50px;border-style:solid; color:${e.color}"></div></td><td >${a}(${e.percent}%)</td></tr>`}return t+"</table></div>"}}},getBreakMetricInfo(e){var t=[];if(e.hasDate||e.hasBreak){var a=function(t,a){var r;return r=e.hasBreak?t[l.Z.def.ChartBreaksCol]:e.hasDate?t[l.Z.def.ChartDateCol]:"",(0,p.isArray)(r)&&(r=l.Z.utils.ParseStrSafe(r[a])),r};e.metrics.forEach((r=>{for(var i=0;i<e.srcCount&&i<2;i++){var s={index:t.length,label:r.label,piedata:[]},n=new Map;e.source.forEach((e=>{if(e[l.Z.def.ChartSrcIndexCol]==i){var t=a(e,i),s=n.get(t);void 0===s&&(s={value:0,name:t},n.set(t,s)),s.value+=l.Z.utils.ParseNumberSafe(e[r.dim])}})),n.forEach((e=>{s.piedata.push(e)})),t.push(s)}}))}else for(var r=0;r<e.srcCount&&r<2;r++){var i={index:t.length,label:"总体",piedata:[]};e.metrics.forEach((t=>{if(0!=e.source.length){var a=e.source[0];if(a[l.Z.def.ChartSrcIndexCol]==r){var s={value:0,name:t.label};s.value=l.Z.utils.ParseNumberSafe(a[t.dim]),i.piedata.push(s)}}else console.log("data source is empty")})),t.push(i)}return t},addTitleText(e,t,a){return{text:e,x:t,y:a,textAlign:"center"}},newSeries(e,t){var a={metricIndex:t.index,name:t.label,type:"pie",radius:"25%",center:["25%","25%"],roseType:"radius",data:t.piedata};e.series.push(a)},reArragePostion(e,t){var a=e.series.length,r=1,i=1;r=Math.floor(a/2)+Math.round(a%2),a>1&&(i=2),e.series.forEach((a=>{a.center=l.Z.utils.getPiePostion(r,i,a.metricIndex);var s=l.Z.utils.getPiePostion(r,i,a.metricIndex,50,2);a.radius=l.Z.utils.getPieRadius(r,i),1==t.srcCount?e.title.push(this.addTitleText(a.name,s[0],s[1])):a.metricIndex%2==0&&e.title.push(this.addTitleText(a.name,"center",s[1]))}))},ExampleData1(){var e={data:[{value:100,max:250,name:"SCORE"},{value:30,max:150,name:"SCORE"},{value:30,max:150,name:"SCORE"}]};return e},ExampleData(){var e={dimensions:["_src","_date","事件总次数"],source:[{_src:0,_date:"2023-08-26","事件总次数":70},{_src:0,_date:"2023-08-27","事件总次数":111},{_src:0,_date:"2023-08-28","事件总次数":60},{_src:0,_date:"2023-08-29","事件总次数":71},{_src:0,_date:"2023-08-30","事件总次数":30},{_src:0,_date:"2023-08-31","事件总次数":20},{_src:0,_date:"2023-09-01","事件总次数":140},{_src:0,_date:"2023-09-02","事件总次数":1},{_src:1,_date:"2023-09-03","事件总次数":0},{_src:1,_date:"2023-09-04","事件总次数":20},{_src:1,_date:"2023-09-05","事件总次数":60},{_src:1,_date:"2023-09-06","事件总次数":100},{_src:1,_date:"2023-09-07","事件总次数":60},{_src:1,_date:"2023-09-08","事件总次数":140},{_src:1,_date:"2023-09-09","事件总次数":110}],hasDate:!0,breaks:[],metrics:[{HeaderId:"A",label:"事件总次数",dim:"事件总次数"}],srcCount:1};return this.Build([e])}},$={Build(e,t){l.Z.utils.IsEmptyObj(t)&&(t={});var a=e[0],r={grid:{left:80,right:30,bottom:30},legend:{bottom:0},tooltip:{trigger:"item"},xAxis:{type:"category",data:this.getDate(a)},yAxis:{type:"value"},series:[]};if(0==a.source.length)return l.Z.utils.OptionGraphEmtpy(r);if(a.hasDate){var i=this.getBreakData(a);return i.forEach((e=>{var t=[];e.data.forEach(((e,a)=>{t.push([a,e[5]])})),r.series.push({name:e.name,type:"boxplot",data:e.data,tooltip:{formatter:function(e){for(var t={},a=1;a<=6;a++)t[a]=M()(Number(e.data[a])).format({thousandSeparated:!0,mantissa:2});return["最大值: "+t[5],"上四分位: "+t[4],"中位数: "+t[3],"下四分位: "+t[2],"最小值: "+t[1],"平均值: "+t[6]].join("<br/>")}}}),r.series.push({name:e.name,type:"scatter",data:t,symbolSize:5})})),r}console.log("error: chart line must have datetime dimension")},getDate(e){var t=e.source.map((e=>e[l.Z.def.ChartDateCol]));return l.Z.utils.DeduplicatedList(t)},getBreakData(e){var t={id:"metricmin",label:"最小值"},a={id:"metric25",label:"下四分位数"},r={id:"metric50",label:"中位数"},i={id:"metric75",label:"上四分位数"},s={id:"metricmax",label:"最大值"},n={id:"metricavg",label:"平均数"};if(e.hasBreak){var o=new Map;e.source.forEach((e=>{var d=[];d.push(e[t.label]),d.push(e[a.label]),d.push(e[r.label]),d.push(e[i.label]),d.push(e[s.label]),d.push(e[n.label]);var u=e[l.Z.def.ChartBreaksCol],c=o.get(u);void 0===c&&(c={name:u,data:[]},o.set(u,c)),c.data.push(d)}));var d=[];return o.forEach((e=>{d.push(e)})),d}var u={name:"",data:[]};return e.source.forEach((e=>{var l=[];l.push(e[t.label]),l.push(e[a.label]),l.push(e[r.label]),l.push(e[i.label]),l.push(e[s.label]),l.push(e[n.label]),u.data.push(l)})),[u]},ExampleData(){var e={dimensions:["_src","_date","事件总次数"],source:[{_src:0,_date:"2023-08-26","事件总次数":70},{_src:0,_date:"2023-08-27","事件总次数":111},{_src:0,_date:"2023-08-28","事件总次数":60},{_src:0,_date:"2023-08-29","事件总次数":71},{_src:0,_date:"2023-08-30","事件总次数":30},{_src:0,_date:"2023-08-31","事件总次数":20},{_src:0,_date:"2023-09-01","事件总次数":140},{_src:0,_date:"2023-09-02","事件总次数":1},{_src:0,_date:"2023-09-03","事件总次数":0},{_src:0,_date:"2023-09-04","事件总次数":20},{_src:0,_date:"2023-09-05","事件总次数":60},{_src:0,_date:"2023-09-06","事件总次数":100},{_src:0,_date:"2023-09-07","事件总次数":60},{_src:0,_date:"2023-09-08","事件总次数":140},{_src:0,_date:"2023-09-09","事件总次数":110}],hasDate:!0,breaks:[],metrics:[{id:"A",label:"事件总次数",dim:"事件总次数"}],srcCount:1};return this.Build([e])}},G={Build(e,t){if(l.Z.utils.IsEmptyArray(e))return e=[],void console.log("source dataset is an emtpy array");var a=e[0],r={pieOption:t,xAxis:{show:!1},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},series:[]};if(0==a.source.length)return l.Z.utils.OptionGraphEmtpy(r);var i=this.getMetricBreakInfo(a);return i.forEach((e=>{this.newSeries(r,e,a.srcCount>1)})),this.reArragePostion(r,a),r},getMetricBreakInfo(e){var t=[],a=function(t){return e.hasBreak?t[l.Z.def.ChartBreaksCol]:e.hasDate?t[l.Z.def.ChartDateCol]:"总计"};return e.metrics.forEach(((r,i)=>{for(var s={index:i,label:r.label,piedata0:[],piedata1:[]},n=0;n<e.srcCount&&n<2;n++){var o=new Map;e.source.forEach((e=>{var t=a(e),i=o.get(t);void 0===i&&(i={value:0,name:t},o.set(t,i)),i.value+=l.Z.utils.ParseNumberSafe(e[r.dim])})),o.forEach((e=>{0==n?s.piedata0.push(e):s.piedata1.push(e)}))}t.push(s)})),t},addTitleGraphicText(e,t,a){return{type:"text",left:t,top:a,style:{text:e,textAlign:"center",fill:"#333",fontSize:20,fontWeight:700}}},newSeries(e,t,a){for(var r=a?2:1,i=0;i<r;i++){var s={metricIndex:2*t.index+i,metricSrc:i,name:t.label,type:"pie",radius:[20,140],center:["25%","25%"],roseType:"radius",data:0==i?t.piedata0:t.piedata1};e.series.push(s)}},reArragePostion(e,t){var a=t.metrics.length,r=1;e.series.forEach((e=>{1==t.srcCount?(a=Math.floor(t.metrics.length/2)+Math.round(t.metrics.length%2),t.metrics.length>1&&(r=2)):r=2,t.metrics.forEach((i=>{if(i.label==e.name){e.center=l.Z.utils.getPiePostion(a,r,e.metricIndex);var s=l.Z.utils.getPiePostion(a,r,e.metricIndex,50,10);1==t.srcCount?this.addTitleGraphicText(i.label,s[0],s[1]):e.metricIndex%2==0&&this.addTitleGraphicText(i.label,"center",s[1])}}))}))},ExampleData1(){var e={data:[{value:100,max:250,name:"SCORE"},{value:30,max:150,name:"SCORE"},{value:30,max:150,name:"SCORE"}]};return e},ExampleData(){var e={dimensions:["_src","_date","事件总次数"],source:[{_src:0,_date:"2023-08-26","事件总次数":70},{_src:0,_date:"2023-08-27","事件总次数":111},{_src:0,_date:"2023-08-28","事件总次数":60},{_src:0,_date:"2023-08-29","事件总次数":71},{_src:0,_date:"2023-08-30","事件总次数":30},{_src:0,_date:"2023-08-31","事件总次数":20},{_src:0,_date:"2023-09-01","事件总次数":140},{_src:0,_date:"2023-09-02","事件总次数":1},{_src:1,_date:"2023-09-03","事件总次数":0},{_src:1,_date:"2023-09-04","事件总次数":20},{_src:1,_date:"2023-09-05","事件总次数":60},{_src:1,_date:"2023-09-06","事件总次数":100},{_src:1,_date:"2023-09-07","事件总次数":60},{_src:1,_date:"2023-09-08","事件总次数":140},{_src:1,_date:"2023-09-09","事件总次数":110}],hasDate:!0,breaks:[],metrics:[{id:"A",label:"事件总次数",dim:"事件总次数"}],srcCount:1};return this.Build([e])}},R={custom_total:"总计",Build(e,t){l.Z.utils.IsEmptyObj(t)&&(t={unitY:"%"}),t.unitY=l.Z.utils.ParseStrSafe(t.unitY);var a={grid:{left:80,right:30,bottom:30},dataset:e,xAxis:{type:"category"},legend:{data:[]},yAxis:{},series:[]};l.Z.utils.IsEmptyStr(t.unitY)||(a.yAxis={type:"value",axisLabel:{formatter:"{value}"+t.unitY}});var r=e[0];return 0==r.source.length?l.Z.utils.OptionGraphEmtpy(a):(r.metrics.forEach((e=>{var r=e.label;r=l.Z.utils.IsEmptyStr(r)?"空":r,a.series.push({type:"bar",name:r,barGap:"50%",z:10,encode:{x:l.Z.def.ChartBreaksCol,y:e.dim},label:{show:!0,align:"center",verticalAlign:"top",position:"insideTop",formatter:function(e){return e.value[e.dimensionNames[e.encode.y[0]]]+t.unitY+"\n("+e.value[e.dimensionNames[e.encode.y[0]]+"_actual"]+")"}}}),a.series.push({type:"pictorialBar",name:r,barGap:"50%",z:20,symbol:"rect",encode:{x:l.Z.def.ChartBreaksCol,y:e.dim+"_max"},itemStyle:{color:"rgba(11,11,11,0.2)"}}),a.legend.data.push(r)})),a.legend.data=l.Z.utils.DeduplicatedList(a.legend.data),this.setTooltip(a),a)},setTooltip(e){e.tooltip={trigger:"axis",show:!0,transitionDuration:1,enterable:!0,formatter:function(e){var t=new Map;e.forEach((e=>{var a=t.get(e.seriesName);void 0===a&&(a={metricName:e.seriesName,date0:"",color0:"",date1:"",value0:"",color1:"",value1:""}),0==e.data[l.Z.def.ChartSrcIndexCol]&&(e.dimensionNames.indexOf(l.Z.def.ChartBreaksCol)?a.date0=e.data[l.Z.def.ChartBreaksCol]:a.date0="",a.color0=e.color,a.value0=e.data[e.dimensionNames[e.encode.y[0]]]),t.set(e.seriesName,a)}));var a='<div style="overflow-x: auto; overflow-y: auto; max-height: 150px;padding:5px"><table>';return t.forEach((e=>{if(a+=`<tr><td colspan="3">${e.metricName}</td></tr>`,!l.Z.utils.IsEmptyStr(e.date0)){var t=M()(l.Z.utils.ParseNumberSafe(e.value0)).format({thousandSeparated:!0});a+=`<tr><td >${e.date0}</td><td style="padding:8px;"><div style="height:1px;width:50px;border-style:solid; color:${e.color0}"></div></td><td >${t}</td></tr>`}})),a+"</table></div>"}}},ExampleData(){var e={dimensions:["_src","_breaks","R1","R2"],source:[{R0:"A",R1:100,R2:100,_src:0,_breaks:"A",R1_:35,R1_MAX:100,R2_:39,R2_MAX:100},{R0:"B",R1:14.29,R2:20.51,_src:0,_breaks:"B",R1_:5,R1_MAX:100,R2_:8,R2_MAX:100},{R0:"C",R1:0,R2:12.5,_src:0,_breaks:"C",R1_:0,R1_MAX:14.29,R2_:1,R2_MAX:20.51}],hasDate:!1,hasBreak:!0,metrics:[{id:"R1",dim:"R1",ref:["true"],label:"true"},{id:"R2",dim:"R2",ref:["false"],label:"false"}],srcCount:1};return this.Build([e])}},H=a(9989),j={api:o,metric:d,filtersub:f,breaks:u,queryset:h,analysisEvent:C,analysisRetent:g,analysisLtv:v,analysisFunnel:Z,analysisInterval:D,analysisDistribute:S,analysisProp:B,analysisPath:q,quicktimerange:w,chartSanky:E,chartGauge:N,chartLine:O,chartCumulative:L,chartFunnelBar:R,BuidChart(e,t,a){switch(e){case l.Z.def.ChartType.Line:return O.Build(t,a);case l.Z.def.ChartType.Cumulative:return L.Build(t,a);case l.Z.def.ChartType.Bar:return A.Build(t,a);case l.Z.def.ChartType.FunnelBar:return R.Build(t,a);case l.Z.def.ChartType.Pie:return F.Build(t,a);case l.Z.def.ChartType.Boxplot:return $.Build(t,a);case l.Z.def.ChartType.Sanky:return E.Build(t,a);case l.Z.def.ChartType.Funnel:return G.Build(t,a);case l.Z.def.ChartType.Gauge:return N.Build(t,a)}},GetChartTypeListByTypeRes(e,t){switch(e){case l.Z.def.AnalysisType.AnalysisTypeEvent:return C.GetVisualTypeList(t);case l.Z.def.AnalysisType.AnalysisTypeFunnel:return Z.GetVisualTypeList();case l.Z.def.AnalysisType.AnalysisTypeRetention:return g.GetVisualTypeList();case l.Z.def.AnalysisType.AnalysisTypeLtv:return v.GetVisualTypeList();case l.Z.def.AnalysisType.AnalysisTypeDistribution:return S.GetVisualTypeList();case l.Z.def.AnalysisType.AnalysisTypeInterval:return D.GetVisualTypeList();case l.Z.def.AnalysisType.AnalysisTypePath:return q.GetVisualTypeList();case l.Z.def.AnalysisType.AnalysisTypeProperty:return B.GetVisualTypeList()}},QueryTableData(e,t){var a={};switch(e){case l.Z.def.AnalysisType.AnalysisTypeEvent:a=C.ToTabledata(t);break;case l.Z.def.AnalysisType.AnalysisTypeFunnel:a=Z.ToTabledata(t);break;case l.Z.def.AnalysisType.AnalysisTypeRetention:a=g.ToTabledata(t);break;case l.Z.def.AnalysisType.AnalysisTypeLtv:a=v.ToTabledata(t);break;case l.Z.def.AnalysisType.AnalysisTypeDistribution:a=S.ToTabledata(t);break;case l.Z.def.AnalysisType.AnalysisTypeInterval:a=D.ToTabledata(t);break;case l.Z.def.AnalysisType.AnalysisTypeProperty:a=B.ToTabledata(t);break}return a},QueryChartOption(e,t,a,r){l.Z.utils.IsEmptyObj(r)&&(r={});var i={};switch(e){case l.Z.def.AnalysisType.AnalysisTypeEvent:case l.Z.def.AnalysisType.AnalysisTypeInterval:i=this.QueryTableData(e,a);var s=H.Z.TableDataToChartSetList(i);return this.BuidChart(t,s,r)}if(e==l.Z.def.AnalysisType.AnalysisTypeFunnel){if(t==l.Z.def.ChartType.Line){var n=Z.ToMixchartDatasetByDate(a);return r.unitY="%",this.BuidChart(t,n,r)}return n=Z.ToMixchartDatasetWithoutDate(a),this.BuidChart(t,n,r)}if(e==l.Z.def.AnalysisType.AnalysisTypePath){var o=q.ToSankyDataLinks(a);return this.BuidChart(t,o,r)}if(e==l.Z.def.AnalysisType.AnalysisTypeRetention){var d=g.datasetToChartDataset(a);return s=H.Z.TableDataToChartSetList(d),this.BuidChart(t,s,r)}return e==l.Z.def.AnalysisType.AnalysisTypeLtv?(d=v.datasetToChartDataset(a),s=H.Z.TableDataToChartSetList(d),this.BuidChart(t,s,r)):e==l.Z.def.AnalysisType.AnalysisTypeDistribution?(d=S.datasetToChartDataset(a),s=H.Z.TableDataToChartSetList(d),this.BuidChart(t,s,r)):e==l.Z.def.AnalysisType.AnalysisTypeProperty?(d=B.datasetToChartDataset(a),s=H.Z.TableDataToChartSetList(d),this.BuidChart(t,s,r)):void 0}}},9989:function(e,t,a){"use strict";a(57658);var r=a(794),i=a(74806);t["Z"]={TableDataToChartSetList(e){e=r.Z.utils.DeepClone(e);var t="",a={dimensions:[],source:[],hasDate:!1,hasBreak:!1,metrics:[],srcCount:1};if(a.dimensions.push(r.Z.def.ChartSrcIndexCol),r.Z.utils.IsEmptyStr(e.sql_timegrain_dim_field)||(t=e.sql_timegrain_dim_field,a.hasDate=!0,a.dimensions.push(r.Z.def.ChartDateCol)),e.sql_breaks.length>0&&(a.hasBreak=!0,a.dimensions.push(r.Z.def.ChartBreaksCol)),e.sql_metric.forEach((e=>{var t=r.Z.utils.IsEmptyStr(e.label)?e.id:e.label;a.dimensions.push(t),a.metrics.push({id:e.id,label:t,dim:t,client_sort_type:e.client_sort_type})})),e.data&&e.data.length>0){r.Z.def.TensorType.TensorTypeScalar!=r.Z.def.TensorType.getTensorType(e.data[0][e.sql_metric[0].id])&&(a.srcCount=2);for(var s=0;s<e.data.length;s++)for(var l=0;l<a.srcCount;l++){var n={},o=e.data[s];if(n[r.Z.def.ChartSrcIndexCol]=l,""!=t&&(n[r.Z.def.ChartDateCol]=o[t]),a.hasBreak>0){var d=e.sql_breaks.map((e=>String(o[e.id])));n[r.Z.def.ChartBreaksCol]=d.join(",")}a.metrics.forEach((e=>{(0,i.isArray)(o[e.id])?n[e.dim]=o[e.id][l]:n[e.dim]=o[e.id]})),a.source.push(n)}}return[a]}}}}]);