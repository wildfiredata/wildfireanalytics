"use strict";(self["webpackChunkwildfire"]=self["webpackChunkwildfire"]||[]).push([[1786],{78126:function(e,t,a){a.d(t,{Z:function(){return f}});var r=function(){var e=this,t=e._self._c;return t("div",{ref:"me",attrs:{id:"crf_BehaviorMetricCondition"}},[t("div",{ref:"padview"},[e.icon.length>0?t("b-icon",{staticClass:"mr10",attrs:{icon:e.icon,size:"is-small"}}):e._e(),t("QuickDateTimeRangePicker",{staticClass:"mr10",on:{change:e.on_change_time},model:{value:e.selectedTimeRange,callback:function(t){e.selectedTimeRange=t},expression:"selectedTimeRange"}}),t("el-select",{staticClass:"width90 mr10 opClass1",attrs:{size:"mini","default-first-option":""},on:{change:e.on_change_never},model:{value:e.selectedDidever,callback:function(t){e.selectedDidever=t},expression:"selectedDidever"}},e._l(e.neverTypeListOp,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("el-select",{staticClass:"mr10 opClass2",attrs:{filterable:"",size:"mini","default-first-option":!0,placeholder:e.$t("message.请选择")},on:{change:e.on_change_event},model:{value:e.selectedEvent,callback:function(t){e.selectedEvent=t},expression:"selectedEvent"}},e._l(e.eventGroupOp,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),e.selectedDidever==e.pub.def.NeverType.NeverTypeEver?t("div",{staticClass:"extracond"},[e.selectedEventChanging?e._e():t("EventMetric",{staticClass:"mr10",attrs:{eventProps:e.eventProps},on:{change:e.on_change_metric},model:{value:e.selectedMetric,callback:function(t){e.selectedMetric=t},expression:"selectedMetric"}}),t("el-select",{staticClass:"width130 mr10 opClass3",attrs:{size:"mini","default-first-option":!0},on:{change:e.on_change_compare},model:{value:e.selectedCmp,callback:function(t){e.selectedCmp=t},expression:"selectedCmp"}},e._l(e.compareOp,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),e.selectedCmp!==e.pub.def.FilterOp.OpBetween?t("span",{staticClass:"mr10"},[t("el-input-number",{staticClass:"width130",attrs:{size:"mini","controls-position":"right"},on:{change:e.on_params_change},model:{value:e.selectedParamNumber1,callback:function(t){e.selectedParamNumber1=t},expression:"selectedParamNumber1"}})],1):e._e(),e.selectedCmp===e.pub.def.FilterOp.OpBetween?t("span",{},[e._v(" "+e._s(e.$t("message.之间前位"))),t("el-input-number",{attrs:{size:"mini","controls-position":"right"},on:{change:e.on_params_change},model:{value:e.selectedParamNumber1,callback:function(t){e.selectedParamNumber1=t},expression:"selectedParamNumber1"}}),e._v(e._s(e.$t("message.之间中位"))+" "),t("el-input-number",{attrs:{size:"mini","controls-position":"right"},on:{change:e.on_params_change},model:{value:e.selectedParamNumber2,callback:function(t){e.selectedParamNumber2=t},expression:"selectedParamNumber2"}}),e._v(e._s(e.$t("message.之间后位"))+" ")],1):e._e(),t("span",{on:{click:function(t){return e.on_click_add(e.selectedFilterGroup,0,1)}}},[t("b-tooltip",{attrs:{label:e.$t("message.添加筛选")}},[t("b-icon",{staticClass:"iconClass",attrs:{icon:"filter-plus-outline",size:"is-small"}})],1)],1)],1):e._e()],1),t("PropConditionGroup",{attrs:{favorites:"",keepLast:!1,filters:e.selectedFilterGroup,eventProps:e.eventProps,userProps:e.userProps}}),t("div")],1)},l=[],i=a(794),s=a(62147),p=a(63822),n=a(9808),o=a(97634),d=a(90309),c={components:{QuickDateTimeRangePicker:n.Z,PropConditionGroup:d.Z,EventMetric:o.Z},model:{prop:"modelvalue",event:"modelvaluechange"},props:{modelvalue:{type:Object,default:function(){return{timeRange:{},event:"",never:i.Z.def.NeverType.NeverTypeEver,filterGroup:{logicop:i.Z.def.LogicOp.LogicOpAnd,children:[]},metric:"",cmp:i.Z.def.FilterOp.OpEqual,paramNumber1:0,paramNumber2:0,icon:""}}},userProps:{type:Array,default:()=>[{value:"FAIL",label:"累计购买次数",label2:i.Z.def.PropertyType.getZhLabel(i.Z.def.PropertyType.PropertyTypeCustom),type:i.Z.def.DataType.DataTypeNumber},{value:"rank",label:"排名",label2:i.Z.def.PropertyType.getZhLabel(i.Z.def.PropertyType.PropertyTypeCustom),type:i.Z.def.DataType.DataTypeNumber},{value:"guild_name",label:"用户名字",label2:i.Z.def.PropertyType.getZhLabel(i.Z.def.PropertyType.PropertyTypeCustom),type:i.Z.def.DataType.DataTypeString},{value:"guild_member",label:"年龄",label2:i.Z.def.PropertyType.getZhLabel(i.Z.def.PropertyType.PropertyTypeCustom),type:i.Z.def.DataType.DataTypeNumber},{value:"guild_leader",label:"性别",label2:i.Z.def.PropertyType.getZhLabel(i.Z.def.PropertyType.PropertyTypeCustom),type:i.Z.def.DataType.DataTypeString},{value:"win",label:"胜利次数",label2:i.Z.def.PropertyType.getZhLabel(i.Z.def.PropertyType.PropertyTypeCustom),type:i.Z.def.DataType.DataTypeNumber}]},eventGroupOp:{type:Array,default:()=>[]},defaulted:{type:Boolean,default:!0}},data(){return{selectedTimeRange:{},selectedEvent:"",selectedEventChanging:!0,selectedDidever:i.Z.def.NeverType.NeverTypeEver,selectedFilterGroup:{logicop:i.Z.def.LogicOp.LogicOpAnd,children:[]},selectedCmp:i.Z.def.FilterOp.OpEqual,selectedParamNumber1:1,selectedParamNumber2:1,icon:"",selectedMetric:"",eventProps:[],neverTypeListOp:[],compareOp:[{label:i.Z.def.FilterOp.getZhLabel(i.Z.def.FilterOp.OpTopN),value:i.Z.def.FilterOp.OpTopN},{label:i.Z.def.FilterOp.getZhLabel(i.Z.def.FilterOp.OpEqual),value:i.Z.def.FilterOp.OpEqual},{label:i.Z.def.FilterOp.getZhLabel(i.Z.def.FilterOp.OpNotEqual),value:i.Z.def.FilterOp.OpNotEqual},{label:i.Z.def.FilterOp.getZhLabel(i.Z.def.FilterOp.OpLowerThan),value:i.Z.def.FilterOp.OpLowerThan},{label:i.Z.def.FilterOp.getZhLabel(i.Z.def.FilterOp.OpLowerThanEqual),value:i.Z.def.FilterOp.OpLowerThanEqual},{label:i.Z.def.FilterOp.getZhLabel(i.Z.def.FilterOp.OpGreaterThan),value:i.Z.def.FilterOp.OpGreaterThan},{label:i.Z.def.FilterOp.getZhLabel(i.Z.def.FilterOp.OpGreaterThanEqual),value:i.Z.def.FilterOp.OpGreaterThanEqual},{label:i.Z.def.FilterOp.getZhLabel(i.Z.def.FilterOp.OpBetween),value:i.Z.def.FilterOp.OpBetween}]}},created(){this.neverTypeListOp=i.Z.def.NeverType.getLabelValueList(),this.setModel(this.modelvalue),i.Z.utils.IsEmptyStr(this.selectedEvent)&&this.eventGroupOp&&this.eventGroupOp.length>0&&(this.selectedEvent=this.eventGroupOp[0].value),this.loadEventProp("created").then((e=>{console.log("loadEventProp:",this.selectedEvent,e),this.eventProps=e,this.defaulted&&this.initDefault(),this.adjustAllSelectWidth(),this.selectedEventChanging=!1})).catch((e=>{i.Z.utils.Err(this,e),this.selectedEventChanging=!1}))},mounted(){},beforeDestroy(){},watch:{},methods:{initDefault(){i.Z.utils.IsEmptyStr(this.selectedDidever)&&(this.selectedDidever=i.Z.def.NeverType.NeverTypeEver),i.Z.utils.IsEmptyStr(this.selectedCmp)&&(this.selectedCmp=i.Z.utils.ParseStrSafe(i.Z.def.FilterOp.OpEqual))},setModel(e){e&&(this.selectedTimeRange=i.Z.utils.ParseObjSafe(e.timeRange),this.selectedEvent=i.Z.utils.ParseStrSafe(e.event),this.selectedDidever=i.Z.utils.ParseStrSafe(e.did_event),e.filterGroup&&e.filterGroup.children?this.selectedFilterGroup=e.filterGroup:this.selectedFilterGroup={logicop:i.Z.def.LogicOp.LogicOpAnd,children:[]},this.selectedMetric=i.Z.utils.ParseStrSafe(e.metric),this.selectedCmp=i.Z.utils.ParseStrSafe(e.cmp),this.selectedParamNumber1=i.Z.utils.ParseNumberSafe(e.paramNumber1),this.selectedParamNumber1<1&&(this.selectedParamNumber1=1),this.selectedParamNumber2=i.Z.utils.ParseNumberSafe(e.paramNumber2),this.selectedParamNumber2<1&&(this.selectedParamNumber2=1))},on_click_add(e,t,a){this.confirm(),i.Z.condx.GroupAdd(e,t,a,{record:{pickersubject:{}}})},on_change_never(){this.confirm(),this.adjustAllSelectWidth()},findEventByValue(e){for(var t=0;t<this.eventGroupOp.length;t++)if(this.eventGroupOp[t].value==e)return this.eventGroupOp[t];return{}},adjustAllSelectWidth(){if(this.$refs.padview){var e=this.$refs.padview.getElementsByClassName("opClass1")[0];i.Z.utils.AdjustWidthOfSelect(this.fontSize,i.Z.def.NeverType.getZhLabel(this.selectedDidever),e)}if(this.$refs.padview){var t=this.$refs.padview.getElementsByClassName("opClass2")[0],a=this.findEventByValue(this.selectedEvent);i.Z.utils.AdjustWidthOfSelect(this.fontSize,a.label,t)}if(this.$refs.padview){var r=this.$refs.padview.getElementsByClassName("opClass3")[0];i.Z.utils.AdjustWidthOfSelect(this.fontSize,i.Z.def.FilterOp.getZhLabel(this.selectedCmp),r)}},on_change_time(){this.confirm(),this.adjustAllSelectWidth()},on_change_event(e){i.Z.utils.Ignore(e),this.confirm(),this.selectedEventChanging=!0,i.Z.condx.GroupClear(this.selectedFilterGroup),this.$nextTick((()=>{this.loadEventProp("on_change_event").then((e=>{this.eventProps=e,this.selectedEventChanging=!1})).catch((e=>{i.Z.utils.Err(this,e),this.selectedEventChanging=!1})),this.adjustAllSelectWidth()}))},on_change_metric(){this.confirm()},on_change_compare(){this.confirm(),this.adjustAllSelectWidth()},loadCompareOp(){this.adjustAllSelectWidth()},on_params_change(e){this.selectedCmp==i.Z.def.FilterOp.OpEqual&&e<1&&this.$nextTick((()=>this.selectedParamNumber1=1)),this.selectedCmp==i.Z.def.FilterOp.OpLowerThan&&e<2&&this.$nextTick((()=>this.selectedParamNumber1=2)),this.selectedCmp==i.Z.def.FilterOp.OpLowerThanEqual&&e<1&&this.$nextTick((()=>this.selectedParamNumber1=1)),this.selectedCmp==i.Z.def.FilterOp.OpBetween&&(this.selectedParamNumber1<1&&this.$nextTick((()=>this.selectedParamNumber1=1)),this.selectedParamNumber2<this.selectedParamNumber1&&this.$nextTick((()=>this.selectedParamNumber2=this.selectedParamNumber1))),this.confirm(),this.adjustAllSelectWidth()},loadEventProp(e){i.Z.utils.Ignore(e);var t=this.getCurrAppId();return i.Z.utils.IsEmptyStr(this.selectedEvent)?new Promise((e=>{e([])})):s.Z.api.LoadEventPropParamPromise({app_id:t,include_obj_schema:!0,include_dim_schema:!0,include_obj_dim_schema:!0,limit_event_name:[this.selectedEvent]})},confirm(){var e={timeRange:this.selectedTimeRange,event:this.selectedEvent,did_event:this.selectedDidever,filterGroup:this.selectedFilterGroup,metric:this.selectedMetric,cmp:this.selectedCmp,paramNumber1:this.selectedParamNumber1,paramNumber2:this.selectedParamNumber2};this.$emit("modelvaluechange",e),this.$emit("change",e)}},computed:{...(0,p.Se)({getCurrAppId:"system/getCurrAppId"})}},u=c,m=a(1001),h=(0,m.Z)(u,r,l,!1,null,"62529e74",null),f=h.exports},17818:function(e,t,a){a.d(t,{Z:function(){return d}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"meClass"},[e.topgroup.children&&e.topgroup.children.length>0?t("div",{staticClass:"grouproot"},[t("div",{staticClass:"group-header"},[e.topgroup.children.length>1?t("div",{staticClass:"logic-buttons"},[t("div",{class:{spanAnd:!0,logicOn:e.topgroup.logicop===e.pub.def.LogicOp.LogicOpAnd},on:{click:function(t){e.topgroup.logicop=e.pub.def.LogicOp.LogicOpAnd}}},[e._v(e._s(e.$t("message.且"))),t("span")]),t("div",{class:{spanOr:!0,logicOn:e.topgroup.logicop===e.pub.def.LogicOp.LogicOpOr},on:{click:function(t){e.topgroup.logicop=e.pub.def.LogicOp.LogicOpOr}}},[e._v(e._s(e.$t("message.或"))),t("span")])]):e._e()]),t("div",{staticClass:"condContainer"},e._l(e.topgroup.children,(function(a,r){return t("div",{key:a.id},[a.children&&a.children.length>0?t("div",{staticClass:"grouproot"},[t("div",{staticClass:"group-header"},[a.children.length>1?t("div",{staticClass:"logic-buttons"},[t("div",{class:{spanAnd:!0,logicOn:a.logicop===e.pub.def.LogicOp.LogicOpAnd},on:{click:function(t){a.logicop=e.pub.def.LogicOp.LogicOpAnd}}},[e._v(e._s(e.$t("message.且"))),t("span")]),t("div",{class:{spanOr:!0,logicOn:a.logicop===e.pub.def.LogicOp.LogicOpOr},on:{click:function(t){a.logicop=e.pub.def.LogicOp.LogicOpOr}}},[e._v(e._s(e.$t("message.或"))),t("span")])]):e._e()]),t("div",{staticClass:"condContainer"},e._l(e.topgroup.children[r].children,(function(l,i){return t("div",{key:l.id},[e._t("default",(function(){return[e._v(e._s(a)+" "+e._s(i))]}),{item:l,parent:e.topgroup.children[r]})],2)})),0)]):t("div",[e._t("default",(function(){return[e._v(e._s(a))]}),{item:a,parent:e.topgroup})],2)])})),0)]):e._e()])},l=[],i=a(794),s={components:{},props:{keepLast:{type:Boolean,default:!0},group:{type:Object,default:function(){return{logicop:i.Z.def.LogicOp.LogicOpAnd,children:[{id:1,label:"label1",name:"namelabel1"},{id:2,label:"label2",name:"namelabel2"},{id:3,label:"label3",name:"namelabel3",logicop:i.Z.def.LogicOp.LogicOpAnd,children:[{id:3,label:"label1",name:"namelabel1"},{id:2,label:"label2",name:"namelabel2"}]}]}}},subjects:{type:Array,default:()=>[]}},data(){return{topgroup:{}}},created(){this.topgroup=this.group},mounted(){},methods:{},computed:{}},p=s,n=a(1001),o=(0,n.Z)(p,r,l,!1,null,"c6cbd6c8",null),d=o.exports},90309:function(e,t,a){a.d(t,{Z:function(){return u}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"meClass"},[t("div",[t("ConditionGroup",{attrs:{group:e.filterable},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"condItem"},[t("PropCondition",{staticClass:"pading2",attrs:{favorites:e.favorites,eventProps:e.eventProps,userProps:e.userProps,userGroups:e.userGroups,userTags:e.userTags},on:{change:e.on_change_condition},model:{value:a.item.record,callback:function(t){e.$set(a.item,"record",t)},expression:"slotProps.item.record"}}),t("span",{on:{click:function(t){return e.on_click_add(e.filterable,a.item.id,a.item.level)}}},[t("el-tooltip",{attrs:{effect:"light",placement:"top",content:e.$t("message.添加条件")}},[t("b-icon",{staticClass:"condIcon",attrs:{icon:"filter-variant-plus",size:"is-small"}})],1)],1),!e.keepLast||e.groupItemCount(e.filterable)>1?t("span",{on:{click:function(t){return e.on_click_trash(e.filterable,a.item.id)}}},[t("el-tooltip",{attrs:{effect:"light",placement:"top",content:e.$t("message.删除条件")}},[t("b-icon",{staticClass:"condIcon",attrs:{icon:"trash-can-outline",size:"is-small"}})],1)],1):e._e()],1)]}}])})],1)])},l=[],i=a(97461),s=a(17818),p=a(794),n={components:{PropCondition:i.Z,ConditionGroup:s.Z},model:{prop:"filters",event:"filterschange"},props:{keepLast:{type:Boolean,default:!0},favorites:{type:String,default:"aa"},filters:{type:Object,default:function(){return{logicop:p.Z.def.LogicOp.LogicOpAnd,children:[{id:1,label:"label1",record:{pickersubject:{}}}]}}},eventProps:{type:Array,default:()=>[{value:"FAIL",label:"累计购买次数",label2:p.Z.def.PropertyType.getZhLabel(p.Z.def.PropertyType.PropertyTypeCustom),type:p.Z.def.DataType.DataTypeNumber},{value:"rank",label:"排名",label2:p.Z.def.PropertyType.getZhLabel(p.Z.def.PropertyType.PropertyTypeCustom),type:p.Z.def.DataType.DataTypeNumber},{value:"guild_name",label:"用户名字",label2:p.Z.def.PropertyType.getZhLabel(p.Z.def.PropertyType.PropertyTypeCustom),type:p.Z.def.DataType.DataTypeString},{value:"guild_member",label:"年龄",label2:p.Z.def.PropertyType.getZhLabel(p.Z.def.PropertyType.PropertyTypeCustom),type:p.Z.def.DataType.DataTypeNumber},{value:"guild_leader",label:"性别",label2:p.Z.def.PropertyType.getZhLabel(p.Z.def.PropertyType.PropertyTypeCustom),type:p.Z.def.DataType.DataTypeString},{value:"win",label:"胜利次数",label2:p.Z.def.PropertyType.getZhLabel(p.Z.def.PropertyType.PropertyTypeCustom),type:p.Z.def.DataType.DataTypeNumber}]},userProps:{type:Array,default:()=>[{value:"FAIL",label:"累计购买次数",label2:p.Z.def.PropertyType.getZhLabel(p.Z.def.PropertyType.PropertyTypeCustom),type:p.Z.def.DataType.DataTypeNumber},{value:"rank",label:"排名",label2:p.Z.def.PropertyType.getZhLabel(p.Z.def.PropertyType.PropertyTypeCustom),type:p.Z.def.DataType.DataTypeNumber},{value:"guild_name",label:"用户名字",label2:p.Z.def.PropertyType.getZhLabel(p.Z.def.PropertyType.PropertyTypeCustom),type:p.Z.def.DataType.DataTypeString},{value:"guild_member",label:"年龄",label2:p.Z.def.PropertyType.getZhLabel(p.Z.def.PropertyType.PropertyTypeCustom),type:p.Z.def.DataType.DataTypeNumber},{value:"guild_leader",label:"性别",label2:p.Z.def.PropertyType.getZhLabel(p.Z.def.PropertyType.PropertyTypeCustom),type:p.Z.def.DataType.DataTypeString},{value:"win",label:"胜利次数",label2:p.Z.def.PropertyType.getZhLabel(p.Z.def.PropertyType.PropertyTypeCustom),type:p.Z.def.DataType.DataTypeNumber}]},userGroups:{type:Array,default:()=>[]},userTags:{type:Array,default:()=>[]}},data(){return{selectedEvent:"",filterable:{}}},created(){this.filterable=this.filters},mounted(){},watch:{filters(e,t){p.Z.utils.Ignore(t),this.filterable.children=e.children,this.filterable.logicop=e.logicop},eventProps(e,t){p.Z.utils.Ignore(e,t)}},methods:{on_click_add(e,t,a){p.Z.condx.GroupAdd(e,t,a,{record:{pickersubject:{}}})},on_click_trash(e,t){p.Z.condx.GroupRemove(e,t)},onMetricChange(e,t,a,r){p.Z.utils.Ignore(e,t,a,r)},on_event_change(e){this.selectedEvent=e},on_change_condition(e){p.Z.utils.Ignore(e)},groupItemCount(e){return p.Z.condx.GroupItemCount(e)}}},o=n,d=a(1001),c=(0,d.Z)(o,r,l,!1,null,"b60fea14",null),u=c.exports},15156:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var r=function(){var e=this,t=e._self._c;return t("div",[t("span",[e._v("span")]),e.eventListLoadOk?t("BehaviorMetricCondition",{attrs:{eventGroupOp:e.eventList},on:{change:e.on_change}}):e._e(),e.eventListLoadOk?t("BehaviorMetricCondition",{attrs:{eventGroupOp:e.eventList},on:{change:e.on_change},model:{value:e.conid0,callback:function(t){e.conid0=t},expression:"conid0"}}):e._e()],1)},l=[],i=a(62147),s=a(794),p=a(63822),n=a(78126),o={components:{BehaviorMetricCondition:n.Z},props:{},data(){return{condi:{},conid0:{timeRange:{zone:8,expr:"今日",start_unit:"",end_unit:"",start_offset:0,end_offset:0,start_dynamic:!1,end_dynamic:!1,quick_range:"today",time_pick:!1,start_time:"2023-07-01 00:00:00",end_time:"2023-07-01 23:59:59"},event:"test_event2",did_event:"ever",filterGroup:{logicop:"and",children:[{level:1,id:1,logicop:"and",children:[{record:{pickersubject:{id:0,value:"$distinct_id",label:"访客ID",label2:"预定义",type:"string",type_prop_name:"distinct_id",hide:!1,data_type_label:"文本",prop_type:"predefine",label3:"文本",is_favorite:!1},params:["32424"],selectedOp:"="},id:2,level:2},{record:{pickersubject:{id:5,value:"age",label:"age",label2:"自定义",type:"number",type_prop_name:"f_age",hide:!1,data_type_label:"数值",prop_type:"custom",label3:"数值",is_favorite:!1},params:[7],selectedOp:">"},id:4,level:2}]},{record:{pickersubject:{id:4,value:"$event_name",label:"事件名称",label2:"预定义",type:"string",type_prop_name:"event_name",hide:!1,data_type_label:"文本",prop_type:"predefine",label3:"文本",is_favorite:!1},params:["evet name"],selectedOp:"<>"},id:3,level:1}]},metric:"EvtProp.friends.born.count_distinct_prop",cmp:"=",paramNumber1:5,paramNumber2:0},eventList:[],eventListLoadOk:!1}},mounted(){this.loadEventGroup()},beforeDestroy(){},watch:{},methods:{on_change(e){console.log("onchange",e)},loadEventGroup(){var e=this.getCurrAppId();i.Z.api.LoadPlainEventList(e).then((e=>{this.eventList=e,this.eventListLoadOk=!0})).catch((e=>{s.Z.utils.Err(this,e)}))}},computed:{...(0,p.Se)({getCurrAppId:"system/getCurrAppId"})}},d=o,c=a(1001),u=(0,c.Z)(d,r,l,!1,null,"cdc722c4",null),m=u.exports}}]);