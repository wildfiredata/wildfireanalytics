"use strict";(self["webpackChunkwildfire"]=self["webpackChunkwildfire"]||[]).push([[9158],{29158:function(e,t,i){i.d(t,{Z:function(){return f}});var s=function(){var e=this,t=e._self._c;return t("div",{ref:"me",attrs:{id:"crf_droppicker"}},[t("div",{class:{inputDefaultClass:!0},attrs:{size:e.fontSize,placeholder:e.inputPlaceHolder,readonly:""},on:{blur:e.input_onblur,focus:e.input_onfocus,click:function(t){return t.stopPropagation(),e.onClickInput.apply(null,arguments)}}},[t("span",[t("span",{staticStyle:{visibility:"hidden"}},[e._v("a")]),e._v(e._s(e.inputText))]),e._v(" "),t("b-icon",{staticStyle:{padding:"12px"},attrs:{icon:"chevron-down",size:"is-small"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.viewshow,expression:"viewshow"}],staticClass:"pickview1"},[t("el-input",{attrs:{clearable:!0,"prefix-icon":e.inputPlaceHolder},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),t("div",{staticClass:"tabContent"},e._l(e.tabs.groups,(function(i,s){return t("div",{key:i.group_name},[e.hideGroupName?e._e():t("div",{staticClass:"dividerGroupClass"},[t("b-icon",{staticStyle:{"margin-right":"5px"},attrs:{icon:i.icon,size:"is-small"}}),e._v(e._s(i.group_name))],1),s>0?t("el-divider"):e._e(),"tree"===i.type&&e.openTreePanel?t("el-tree",{attrs:{data:i.children},scopedSlots:e._u([{key:"default",fn:function({node:s,data:l}){return t("div",{staticStyle:{display:"block",width:"100%"},on:{mouseenter:function(t){return e.enterli(i.group_name,l,s)},mouseleave:function(t){return e.leaveli()}}},[t("div",{staticClass:"treeNodeClass",on:{click:function(t){return e.handleNodeClick(s,i.group_name,i.value)}}},[1===s.level?t("div",{style:e.treeNodeLevel1Style},[t("span",[e._v(e._s(l.label))])]):2===s.level?t("div",{style:e.treeNodeLevel2Style},[t("span",[e._v(e._s(l.label))])]):t("div",{style:e.treeNodeLevelOtherStyle},[t("span",[e._v(e._s(l.label))])]),t("div",{staticClass:"treerightli"},[t("div",{staticClass:"labelli23"},[e._v(e._s(l.label2)+" ")]),t("div",{staticClass:"labelli23"},[e._v(e._s(l.label3)+" ")]),e.favorites?t("div",{staticClass:"labelstar",on:{click:function(t){return e.clickIcon(l,s)}}},[s.isLeaf?t("b-icon",{class:{iconClass:!0,iconClassFavorite:l.is_favorite,iconClassNonFavorite:!l.is_favorite},attrs:{icon:"star-outline",size:"is-small"}}):e._e()],1):e._e()])])])}}],null,!0)}):t("ul",e._l(i.children,(function(s){return t("li",{key:s.label,on:{mouseleave:function(t){return e.leaveli()},mouseenter:function(t){return e.enterli(i.group_name,s)},click:function(t){return e.handleLiClick(s,i.group_name,i.value)}}},[t("div",{staticClass:"leftli"},[e._v(e._s(s.label)+" ")]),t("div",{staticClass:"rightli"},[t("div",{staticClass:"labelli23"},[e._v(e._s(s.label2)+" ")]),t("div",{staticClass:"labelli23"},[e._v(e._s(s.label3)+" ")]),e.favorites?t("div",{on:{click:function(t){return t.stopPropagation(),e.clickIcon(s)}}},[t("b-icon",{class:{iconClass:!0,iconClassFavorite:s.is_favorite},attrs:{icon:"star-outline",size:"is-small"}})],1):e._e()])])})),0)],1)})),0)],1),t("div",{class:{hintPopClass:!0,hintPopClassShow:e.isPopShow}},[t("div",{staticClass:"hintTitleClass"},[t("div",{staticClass:"hintTitleRowClass"},[t("span",{staticClass:"halfWithEllips"},[e._v(e._s(e.hintDescript.title))]),e.hintDescript.tag?t("b-tag",{attrs:{type:"is-info is-light",rounded:""}},[e._v(e._s(e.hintDescript.tag))]):e._e()],1),t("div",{staticClass:"hintTitlePropClass"},e._l(e.hintDescript.desc,(function(i,s){return t("span",{key:s,staticClass:"hintTitlePropItemClass",attrs:{rounded:""}},[e._v(e._s(i.label))])})),0)]),t("div",{staticClass:"hintMemoClass"},[e.hintDescript.memo?t("div",[e._v(e._s(e.hintDescript.memo))]):e.hintDescript.memoholder?t("div",{staticStyle:{color:"lightgray"}},[e._v(e._s(e.hintDescript.memoholder))]):e._e()]),t("div",{staticClass:"hintTailClass"},e._l(e.hintDescript.tail,(function(i,s){return t("span",{key:s,staticClass:"hintTailItemClass",on:{click:function(t){return e.hintTailItemClick(i)}}},[t("b-icon",{attrs:{icon:i.icon,size:"is-small"}}),e._v(e._s(i.label))],1)})),0)]),t("span",{staticStyle:{position:"fixed",width:"2000px",transform:"translateY(-9999px)"},attrs:{size:e.fontSize,readonly:""}},[t("span",{ref:"autowidthspan",attrs:{slot:"prefix"},slot:"prefix"},[e._v(e._s(e.autowidthspanText))])])])},l=[],a=(i(57658),i(794));const r="收藏夹",n="tree",o="list",h=380,u=320;var c={name:"DropPicker",props:{autoDropWidth:{type:Boolean,default:!0},dropWidth:{type:String,default:"80px"},dropHight:{type:String,default:"100%"},maxLabel23Width:{type:Number,default:40},defaulted:{type:Boolean,default:!0},fixWidth:{type:Boolean,default:!1},hideHint:{type:Boolean,default:!1},fontSize:{type:String,default:""},hideGroupName:{type:Boolean,default:!0},inputPlaceHolder:{type:String,default:"el-icon-search"},favorites:{type:String,default:"aa"},selectobj:{type:Array,default:()=>[]},tabGroups:{type:Array,default:()=>[]},items:[{message:"Foo"},{message:"Bar"}],hintExample:{type:Object,default:function(){return{title:"",tag:"",memo:"",memoholder:"",desc:[{label:""}],tail:[{label:"",icon:"",herf:""}]}}},getItemHint:{type:Function,default(e,t){var i={desc:[],tail:[]};return i.title=t.label,i.tag=e,i.memo=t.memo,i.memoholder=t.memoholder,i.desc.push({label:t.value}),i.desc.push({label:t.label2}),i.desc.push({label:t.label3}),i.tail.push({label:t.label3,icon:t.prefix_icon}),i}},TimePick:Boolean},data(){return{ALL_TAB_NAME:this.$t("message.全部"),valueText:"    ",inputText:"",openTreePanel:!0,viewshow:!1,refreshTab:1,activeName:this.$t("message.全部"),hoveringli:!1,hintDescript:{title:"111",tag:"",memo:"",memoholder:this.$t("message.未填写备注信息"),desc:[],tail:[]},filterText:"",treeNodeLevel1Style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:u/2+"px"},treeNodeLevel2Style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:u/2+"px"},treeNodeLevelOtherStyle:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:u/2+"px"}}},created(){},mounted(){document.addEventListener("click",this.dc,!0);var e=this.$refs.me,t=e.getElementsByClassName("inputDefaultClass")[0];t.style.width=this.dropWidth,t.style.height=this.dropHight;var i=e.getElementsByClassName("pickview1")[0];i.style.width=String(u)+"px",i.style.height=String(h)+"px",this.hintDescript=this.hintExample,setTimeout((()=>{this.getDefaultSelectValue(),this.setTreeNodellabelLeftStyel(),setTimeout((()=>this.autoWidthAdjust()),100)}),100)},beforeDestroy(){document.removeEventListener("click",this.dc,!0)},methods:{dc(e){var t=this.viewshow,i=this.$refs.me;this.viewshow=i.contains(e.target),t&&!this.viewshow&&this.chevronDown(),this.adjustPopPosition()},getDefaultSelectValue(){var e={children:this.tabGroups};if(this.selectobj.length>0)if(1===this.selectobj.length){var t,i=this.selectobj;if(this.traversalTree(e,(function(e){e.value!=i[0]||(t=e.label)})),!a.Z.utils.IsEmptyStr(t))return void(this.valueText=t)}else for(var s=0;s<this.selectobj.length;s++)for(var l=0;l<e.children.length;l++)if(e.children[l].value===this.selectobj[s]){if(s+1===this.selectobj.length)return void(this.valueText=e.children[l].label);e=e.children[l];break}if(this.defaulted)while(e.children&&e.children.length>0)this.valueText=e.children[0].label,e=e.children[0]},input_onfocus(){},input_onblur(){this.adjustPopPosition()},onClickInput(){this.viewshow=!0,this.viewshow&&this.chevronUp(),this.adjustPopPosition()},setTreeNodellabelLeftStyel(){var e=u;this.tabs.hasLevel2&&(e-=this.maxLabel23Width),this.tabs.hasLevel3&&(e-=this.maxLabel23Width),this.treeNodeLevel1Style.width=String(e-80)+"px",this.treeNodeLevel2Style.width=String(e-180)+"px",this.treeNodeLevelOtherStyle.width=String(e-280)+"px"},chevronDown(){var e=this.$refs.me,t=e.getElementsByClassName("inputDefaultClass")[0].lastChild,i=t.className.replace("chevronClassOn","");i=i.replace("chevronClassOff",""),t.className=i+" chevronClassOff"},chevronUp(){var e=this.$refs.me,t=e.getElementsByClassName("inputDefaultClass")[0].lastChild,i=t.className.replace("chevronClassOn","");i=i.replace("chevronClassOff",""),t.className=i+" chevronClassOn"},adjustPopPosition(){var e=this.$refs.me,t=e.getElementsByClassName("inputDefaultClass")[0],i=e.getElementsByClassName("pickview1")[0],s={};this.viewshow?(s.height=h,s.width=u):(s.height=0,s.width=0),window.innerHeight-t.getBoundingClientRect().top<h+32?s.top=-h-5+"px":s.top="calc("+t.style.height+" + 5px)",window.innerWidth-t.getBoundingClientRect().left>u?s.left="0px":s.left="calc("+t.style.width+" - "+String(u-20)+"px)",i.style.height=String(s.height)+"px",i.style.width=String(s.width)+"px",i.style.left=s.left,i.style.top=s.top;var l=e.getElementsByClassName("hintPopClass")[0];l.style.width=String(s.width)+"px",l.style.left=String(s.width)+"px",l.style.top=String(s.top)+"px"},clickIcon(e){if(!a.Z.utils.IsEmptyStr(this.favorites)){var t=this.$store.getters["favorite/GetFavoriteMap"](this.favorites);"undefined"!==typeof t.get(e.value)?this.$store.dispatch("favorite/DeleteFavorite",{group:this.favorites,value:e.value}):this.$store.dispatch("favorite/PushFavorite",{group:this.favorites,item:e}),this.openTreePanel=!1,setTimeout((()=>{this.openTreePanel=!0}),10),this.refreshTab=this.refreshTab+1}},traversalTree(e,t){if(!e||e.children&&0!==e.children.length)for(var i=0;i<e.children.length;i++)this.traversalTree(e.children[i],t);else t(e)},filterGroups(e,t){var i=[];if(a.Z.utils.IsEmptyStr(this.filterText))return e;for(var s=0;s<e.length;s++){var l=[],r={};e[s].type===o?(l=e[s].children.filter((function(e){return e.label.indexOf(t)>-1})),l.length>0&&(r={group_name:e[s].group_name+"["+String(l.length)+"]",value:e[s].value,type:o,icon:e[s].icon},r.children=l,i.push(r))):e[s].type===n&&(this.traversalTree(e[s],(function(e){(a.Z.utils.IsEmptyStr(t)||e.label.indexOf(t)>-1)&&l.push(e)})),console.log("filteredChildren",l),l.length>0&&(r={group_name:e[s].group_name+"["+String(l.length)+"]",value:e[s].value,type:o,icon:e[s].icon},r.children=l,i.push(r)))}return i},updateHintObject(e,t){this.hintDescript=this.getItemHint(e,t)},enterli(e,t){this.hoveringli=!0,this.updateHintObject(e,t)},leaveli(){this.hoveringli=!1},hintTailItemClick(e){console.log("hintTailItemClick",e)},confirm(e,t){this.viewshow=!1,this.valueText=t[t.length-1],this.$emit("change",e,t),setTimeout((()=>this.autoWidthAdjust()),10),setTimeout((()=>this.chevronDown()),20)},handleLiClick(e,t,i){var s=[],l=[];s.push(i,e.value),l.push(t,e.label),this.confirm(s,l)},handleNodeClick(e,t,i){var s=[],l=[];if(e&&e.isLeaf){while(e)0===e.level?(l.push(t),s.push(i)):(l.push(e.data.label),s.push(e.data.value)),e=e.parent;l=l.reverse(),s=s.reverse(),this.confirm(s,l)}},autoWidthAdjust(){var e=this.$refs.me;if(e){var t=e.getElementsByClassName("inputDefaultClass")[0];if(t){var i=e.getElementsByClassName("inputDefaultClass")[0].firstChild;if(i)if(this.autoDropWidth){var s=this.$refs.autowidthspan.getClientRects();t.style.width=s[0].width+12+25+"px",this.inputText=this.valueText}else i.style.overflow="hidden",i.style.textOverflow="ellipsis",i.style.whiteSpace="nowrap"}}}},computed:{autowidthspanText:function(){return this.valueText&&this.valueText.length>0?this.valueText:this.inputPlaceHolder},isPopShow:function(){return!this.hideHint&&this.viewshow&&(!a.Z.utils.IsEmptyStr(this.hintDescript.title)||!a.Z.utils.IsEmptyStr(this.hintDescript.tag))},tabs:function(){var e={tabName:this.ALL_TAB_NAME,groups:[],hasLevel:!0,hasLevel2:!1,hasLevel3:!1},t=new Map;if(!a.Z.utils.IsEmptyStr(this.favorites)){t=this.$store.getters["favorite/GetFavoriteMap"](this.favorites);var i=this.$store.getters["favorite/ListFavorite"](this.favorites);e.groups.push({group_name:r,value:"",type:o,icon:"account-details",children:i})}e.groups.push(...this.tabGroups);for(var s=0;s<e.groups.length;s++)for(var l=0;l<e.groups[s].children.length;l++)e.groups[s].type===o?"undefined"!==typeof t.get(e.groups[s].children[l].value)?e.groups[s].children[l].is_favorite=!0:e.groups[s].children[l].is_favorite=!1:e.groups[s].type===n&&this.traversalTree(e.groups[s],(function(e){e&&"undefined"!==typeof t.get(e.value)?e.is_favorite=!0:e.is_favorite=!1})),a.Z.utils.IsEmptyStr(e.groups[s].children[l].label2)&&(e.hasLevel2=!0),a.Z.utils.IsEmptyStr(e.groups[s].children[l].label3)&&(e.hasLevel3=!0);e.groups=this.filterGroups(e.groups,this.filterText);var h=[];for(s=0;s<e.groups.length;s++)e.groups[s].children.length>0&&h.push(e.groups[s]);return e.groups=h,a.Z.utils.Ignore(this.refreshTab),e},test:function(){return!0}}},p=c,d=i(1001),v=(0,d.Z)(p,s,l,!1,null,"e763ced4",null),f=v.exports}}]);